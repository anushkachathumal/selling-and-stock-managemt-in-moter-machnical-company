
Imports System.Data.SqlClient
Imports Infragistics.Win.UltraWinGrid
Imports DBLotVbnet.DAL_frmWinner
Imports DBLotVbnet.common
Imports DBLotVbnet.MDIMain
Imports System.Net.NetworkInformation
Imports System.Net
Imports DBLotVbnet.DBEngin
Imports DBLotVbnet.Quarrys
Imports System.IO.File
Imports System.IO.StreamWriter
Imports System.Net.Mail
Imports Microsoft.Office.Interop.Excel
Imports System.Drawing
Imports Spire.XlS

'Imports Spire.Xls
Public Class frmOverall
    Dim strLine As String
    Dim strLineflu As String
    Dim strDash As String
    Dim StrDisCode As String
    Dim oFile As System.IO.File
    Dim oWrite As System.IO.StreamWriter
    Dim exc As New Application
    Dim Overall_IAFFAF As Integer
    Dim Overall_IAFFWJ As Integer
    Dim StrWitemal As Integer

    Dim workbooks As Workbooks = exc.Workbooks
    Dim workbook As _Workbook = workbooks.Add(XlWBATemplate.xlWBATWorksheet)
    Dim sheets As Sheets = workbook.Worksheets
    Dim worksheet1 As _Worksheet = CType(sheets.Item(1), _Worksheet)

    Private Sub frmOverall_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        txtFromDate.Text = Today
        txtTodate.Text = Today
    End Sub

    Private Sub cmdExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdExit.Click
        Me.Close()
        'Call Daily_Boliout()
    End Sub


    Function DailyDownTime()
        Try
            Dim SQL As String
            Dim con = New SqlConnection()
            con = DBEngin.GetConnection()
            Dim T01 As DataSet
            Dim T03 As DataSet
            Dim dsUser As DataSet
            Dim n_Date As Date
            Dim N_Date1 As Date
            Dim FileName As String
            exc.Visible = True
            Dim i As Integer
            Dim _GrandTotal As Integer
            Dim _STGrand As String
            Dim range1 As Range
            Dim _NETTOTAL As Integer
            Dim T04 As DataSet

            '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
            'workbooks.Application.Sheets.Add()
            workbooks.Application.Sheets.Add()
            Dim sheets1 As Sheets = workbook.Worksheets
            Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
            worksheet11.Name = "Daily Down Time Analysis"
            worksheet11.Cells(2, 3) = "Textured Jersey PLC"
            worksheet11.Rows(2).Font.Bold = True
            worksheet11.Rows(2).Font.size = 26
            worksheet11.Range("A2:J2").MergeCells = True
            worksheet11.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


            worksheet11.Cells(4, 1) = "Daily Down Time Analysis Report "
            worksheet11.Rows(4).Font.Bold = True
            worksheet11.Rows(4).Font.size = 10

            worksheet11.Rows(6).rowheight = 20.25

            worksheet11.Rows(6).Font.Bold = True
            worksheet11.Rows(6).Font.size = 10
            worksheet11.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Cells(7, 3) = "SUMMERY OF ALL MACHINE "
            worksheet11.Rows(7).Font.Bold = True
            worksheet11.Rows(7).Font.size = 11
            'range1 = worksheet1.Cells("B2:G2")


            worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 7)).Merge()
            worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet11.Cells(7, 3)
            ' range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet1.Cells(7, 3).VerticalAlignment = XlVAlign.xlVAlignCenter
            ' range1.Borders.LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(7, 8) = "WATER JET MACHINE "
            worksheet11.Rows(7).Font.Bold = True
            worksheet11.Rows(7).Font.size = 11
            'range1 = worksheet1.Cells("B2:G2")

            worksheet11.Range("B2:G2").VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 13)).Merge()
            worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(7, 8)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            '   range1.Borders.LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(7, 14) = "AIR FLOW MACHINE "
            worksheet11.Rows(7).Font.Bold = True
            worksheet11.Rows(7).Font.size = 11
            'range1 = worksheet1.Cells("B2:G2")

            worksheet11.Range("B7:G7").VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 19)).Merge()
            worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(7, 14)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            'range1.Borders.LineStyle = XlLineStyle.xlContinuous
            For i = 1 To 19
                range1 = worksheet11.Cells(7, i)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
            Next

            Dim X As Integer
            '' worksheet1.Rows(8).width = 22
            'range1 = worksheet1.Cells(7, 3)
            'range1.VerticalAlignment = XlVAlign.xlVAlignCenter

            'range1 = worksheet1.Cells(7, 8)
            'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            For i = 2 To 19

                ' For X = 3 To 9
                X = i
                worksheet11.Cells(8, X) = "Fabric "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                worksheet11.Columns(X).columnwidth = 8
                ' range1.Interior.Color = RGB(255, 255, 255)

                X = X + 1
                worksheet11.Cells(8, X) = "Dye Technical "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).WrapText = True
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
                X = X + 1

                worksheet11.Cells(8, X) = "Mainten "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
                X = X + 1

                worksheet11.Cells(8, X) = "Plan Mainten "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).WrapText = True
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
                X = X + 1

                If X = 12 Then

                    worksheet11.Cells(8, X) = "Water Jet No work "
                    worksheet11.Rows(8).Font.Bold = True
                    worksheet11.Rows(8).Font.size = 10
                    worksheet11.Cells(8, X).WrapText = True
                    worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ' range1 = worksheet1.Cells(8, X)
                    'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                    range1 = worksheet11.Cells(8, X)
                    range1.Borders.LineStyle = XlLineStyle.xlContinuous

                    'worksheet1.Columns(3).columnwidth = 17
                    range1.Font.Color = RGB(255, 0, 0)
                ElseIf X = 18 Then
                    worksheet11.Cells(8, X) = "Air Flow No work "
                    worksheet11.Rows(8).Font.Bold = True
                    worksheet11.Rows(8).Font.size = 10
                    worksheet11.Cells(8, X).WrapText = True
                    worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ' range1 = worksheet1.Cells(8, X)
                    'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                    range1 = worksheet11.Cells(8, X)
                    range1.Borders.LineStyle = XlLineStyle.xlContinuous

                    'worksheet1.Columns(3).columnwidth = 17
                    range1.Font.Color = RGB(255, 0, 0)
                Else
                    worksheet11.Cells(8, X) = "Total No work "
                    worksheet11.Rows(8).Font.Bold = True
                    worksheet11.Rows(8).Font.size = 10
                    worksheet11.Cells(8, X).WrapText = True
                    worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ' range1 = worksheet1.Cells(8, X)
                    'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                    range1 = worksheet11.Cells(8, X)
                    range1.Borders.LineStyle = XlLineStyle.xlContinuous

                    'worksheet1.Columns(3).columnwidth = 17
                    range1.Font.Color = RGB(255, 0, 0)
                End If
                X = X + 1

                worksheet11.Cells(8, X) = "Total"
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.VerticalAlignment = XlVAlign.xlVAlignCenter

                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
                range1.Font.Color = RGB(0, 0, 255)

                X = X + 1

                i = i + 5
                'Next
            Next
            'worksheet1.Range("B2:G2").AutoOutline()
            ' range1.Borders.LineStyle = XlLineStyle.xlContinuous
            'worksheet1.Columns(3).columnwidth = 17
            ' range1.Interior.Color = RGB(255, 255, 255)

            ' worksheet1.Range("B2").Format.Align = 2
            'worksheet1.Cells("A8", "S8").Borders.LineStyle = XlLineStyle.xlContinuous
            range1 = worksheet11.Cells(8, 1)

            worksheet11.Cells(8, 3).WrapText = True
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            n_Date = CDate(txtFromDate.Text).AddDays(-30)
            n_Date = n_Date & " " & "7:30AM"
            N_Date1 = txtTodate.Text & " " & "7:30AM"

            'CALCULATE ALL MACHINE
            Dim N_TOTALHR As Integer

            N_TOTALHR = 24 * 27 * 60

            Dim xl_Columcn As Integer

            xl_Columcn = 2
            SQL = "SELECT CONVERT(VARCHAR(10) , T01Date, 120)as [Ddate],SUM(T01Taken) AS T01Taken FROM T01Down_Time WHERE T01Machine NOT IN ('18','19','20') AND T01DATE BETWEEN '" & n_Date & "' AND '" & N_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , T01Date, 120)"
            T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            i = 0
            X = 9
            For Each DTRow2 As DataRow In T01.Tables(0).Rows
                xl_Columcn = 2
                N_TOTALHR = 24 * 27 * 60
                worksheet11.Cells(X, 1) = T01.Tables(0).Rows(i)("Ddate")
                ' worksheet1.Rows(8).Font.Bold = True
                worksheet11.Cells(X, 1).EntireColumn.NumberFormat = "dd-MMM"
                worksheet11.Rows(X).Font.size = 10
                'worksheet1.Cells(8, X).WrapText = True
                'worksheet1.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '' range1 = worksheet1.Cells(8, X)
                ''range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                ' range1.Borders.LineStyle = XlLineStyle.xlContinuous
                Dim x_Date As Date
                Dim x_Date1 As Date
                Dim n_per As Double
                Dim y As Integer

                x_Date = T01.Tables(0).Rows(i)("Ddate")
                x_Date1 = CDate(x_Date).AddDays(+1)

                x_Date = x_Date & " " & "7:30AM"
                x_Date1 = x_Date1 & " " & "7:30AM"


                'UPGRADE_WARNING: Couldn't resolve default property of object x_date. Click for more: 'ms-help://MS.VSCC.v90/dv_commoner/local/redirect.htm?keyword="6A50421D-15FE-4896-8A1B-2EC21E9037B2"'
                'If Microsoft.VisualBasic.Day(x_Date) = 21 Then
                '    MsgBox("")
                'End If

                '-----------------------------------------------Fabric All Machine
                y = 0
                n_per = 0
                'If Microsoft.VisualBasic.Day(x_Date) = 24 Then
                '    MsgBox("")
                'End If
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='Fabric' and T03Type in ('01','02') AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                    y = y + 1
                Next
                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                'worksheet1.Range("C1:C10").NumberFormat = "0.00"

                worksheet11.Rows(X).Font.size = 10
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1

                ' worksheet1.Columns("C:C").NumberFormat = "#.00;@"
                y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='TechD' and T03Type in ('01','02') AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                    y = y + 1
                Next

                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                '  worksheet1.Range("C9:C10").NumberFormat = "0.00"
                worksheet11.Rows(X).Font.size = 10
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1

                '================================================
                y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='MainM' and T03Type in ('01','02') AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                    y = y + 1
                Next

                n_per = n_per / N_TOTALHR
                '  n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                'worksheet1.Cells(X, xl_Columcn).EntireColumn.NumberFormat = "0"
                ' worksheet1.Cells(X, xl_Columcn).selection.NumberFormat = "0"
                ' worksheet1.Columns("D:D").NumberFormat = "#;@"
                range1 = worksheet11.Cells(X, xl_Columcn)
                ' range1 = worksheet1.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                ' range1.selection.NumberFormat = "0"
                worksheet11.Rows(X).Font.size = 10
                xl_Columcn = xl_Columcn + 1

                y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='PM' and T03Type in ('01','02') AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                    y = y + 1
                Next

                n_per = n_per / N_TOTALHR
                '  n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                worksheet11.Rows(X).Font.size = 10
                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet1.Cells(X, xl_Columcn)
                'worksheet1.Cells(X, xl_Columcn).NumberFormat = "@"


                y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type in ('01','02') AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                    y = y + 1
                Next

                n_per = n_per / N_TOTALHR
                '  n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10
                'worksheet1.Cells(X, xl_Columcn).NumberFormat = "# ##0"
                range1 = worksheet11.Cells(X, xl_Columcn)
                ' range1 = worksheet1.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(255, 0, 0)
                xl_Columcn = xl_Columcn + 1


                y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20')  and T03Type in ('01','02') AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' and M05Name  in ('No Work','PM','MainM','TechD','Fabric') GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                    y = y + 1
                Next

                n_per = n_per / N_TOTALHR
                '  n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10

                range1 = worksheet11.Cells(X, xl_Columcn)
                'range1 = worksheet1.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(0, 0, 255)
                xl_Columcn = xl_Columcn + 1
                '-----------------------------------------------------OTHER MACHINE
                Dim z As Integer
                z = 0
                SQL = "SELECT * FROM M01Dyeing_MC_Type WHERE m01CODE IN ('01','02')"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow3 As DataRow In T04.Tables(0).Rows

                    If Trim(T04.Tables(0).Rows(z)("m01code")) = "01" Then
                        N_TOTALHR = 18 * 24 * 60
                    Else
                        N_TOTALHR = 9 * 24 * 60
                    End If
                    y = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='Fabric' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                        y = y + 1
                    Next
                    n_per = n_per / N_TOTALHR
                    ' n_per = n_per * 100
                    worksheet11.Cells(X, xl_Columcn) = n_per
                    worksheet11.Rows(X).Font.size = 10
                    range1 = worksheet11.Cells(X, xl_Columcn)
                    range1.NumberFormat = "0%"
                    xl_Columcn = xl_Columcn + 1

                    y = 0
                    n_per = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='TechD' and T03Type='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                        y = y + 1
                    Next

                    n_per = n_per / N_TOTALHR
                    ' n_per = n_per * 100
                    worksheet11.Cells(X, xl_Columcn) = n_per
                    range1 = worksheet11.Cells(X, xl_Columcn)
                    range1.NumberFormat = "0%"
                    worksheet11.Rows(X).Font.size = 10
                    xl_Columcn = xl_Columcn + 1

                    '================================================

                    y = 0
                    n_per = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='MainM' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                        y = y + 1
                    Next

                    n_per = n_per / N_TOTALHR
                    '  n_per = n_per * 100
                    worksheet11.Cells(X, xl_Columcn) = n_per
                    range1 = worksheet11.Cells(X, xl_Columcn)
                    range1.NumberFormat = "0%"
                    worksheet11.Rows(X).Font.size = 10
                    xl_Columcn = xl_Columcn + 1

                    y = 0
                    n_per = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='PM' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                        y = y + 1
                    Next

                    n_per = n_per / N_TOTALHR
                    '  n_per = n_per * 100
                    worksheet11.Cells(X, xl_Columcn) = n_per
                    range1 = worksheet11.Cells(X, xl_Columcn)
                    range1.NumberFormat = "0%"
                    worksheet11.Rows(X).Font.size = 10
                    xl_Columcn = xl_Columcn + 1

                    y = 0
                    n_per = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                        y = y + 1
                    Next

                    n_per = n_per / N_TOTALHR
                    '  n_per = n_per * 100
                    worksheet11.Cells(X, xl_Columcn) = n_per
                    worksheet11.Rows(X).Font.size = 10

                    range1 = worksheet11.Cells(X, xl_Columcn)
                    '' range1 = worksheet1.Cells(X, xl_Columcn)
                    range1.NumberFormat = "0%"
                    range1.Font.Color = RGB(255, 0, 0)
                    xl_Columcn = xl_Columcn + 1


                    y = 0
                    n_per = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20')  and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01DATE BETWEEN '" & x_Date & "' AND '" & x_Date1 & "' and   M05Name  in ('No Work','PM','MainM','TechD','Fabric') GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(y)("T01Taken")
                        y = y + 1
                    Next

                    n_per = n_per / N_TOTALHR
                    '  n_per = n_per * 100
                    worksheet11.Cells(X, xl_Columcn) = n_per
                    range1 = worksheet11.Cells(X, xl_Columcn)
                    range1.NumberFormat = "0%"
                    worksheet11.Rows(X).Font.size = 10

                    'range1 = worksheet1.Cells(X, xl_Columcn)

                    range1.Font.Color = RGB(0, 0, 255)
                    xl_Columcn = xl_Columcn + 1
                    z = z + 1
                Next

               

                i = i + 1
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("B" & X & ":B" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("B" & X & ":B" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("C" & X & ":C" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("C" & X & ":C" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("D" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("D" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("E" & X & ":E" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("E" & X & ":E" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("F" & X & ":F" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("F" & X & ":F" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("G" & X & ":G" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("G" & X & ":G" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("H" & X & ":H" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("H" & X & ":H" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("I" & X & ":I" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("I" & X & ":I" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("J" & X & ":J" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("J" & X & ":J" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("K" & X & ":K" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("K" & X & ":K" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("L" & X & ":L" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("L" & X & ":L" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("M" & X & ":M" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("M" & X & ":M" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("N" & X & ":N" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("N" & X & ":N" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("O" & X & ":O" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("O" & X & ":O" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("P" & X & ":P" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("P" & X & ":P" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("Q" & X & ":Q" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("Q" & X & ":Q" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("R" & X & ":R" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("R" & X & ":R" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("S" & X & ":S" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("S" & X & ":S" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                X = X + 1
            Next
            '---------------------------------------------------------------
            ''Dim cht As ChartObject
            ''Dim chtChart As Chart, srsNew As Series

            ''chtChart = worksheet1.ChartObjects.Add(Left:=125, Width:=600, Top:=405, Height:=300).Chart
            ''With chtChart
            ''    .ChartType = XlChartType.xlColumnStacked

            ''    'Do While .SeriesCollection.Count <> 0
            ''    '    .SeriesCollection(1).Delete()
            ''    'Loop

            ''    srsNew = .SeriesCollection.NewSeries
            ''    With srsNew
            ''        '$A$9:$F$29
            ''        .XValues = "='" & sheets(1).Name & "'!" & _
            ''        sheets(1).Range(sheets(1).Range("A9"), sheets(1).Range("A10").End(XlDirection.xlDown)).Address
            ''        '.Values = "'Daily Down Time Analysis'!$A$9:$F$29"
            ''        '.Values = "='" & sheets(1).Name & "'!" & _
            ''        'sheets(1).Range(sheets(1).Range("29"), sheets(1).Range("29").End(XlDirection.xlDown)).Address()


            ''    End With
            ''End With

            'CREATE CHART
            Dim chartPage As Microsoft.Office.Interop.Excel.Chart
            Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
            Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
            Dim chartRange As Microsoft.Office.Interop.Excel.Range
            Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
            Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


            Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
            Dim t_Series As Microsoft.Office.Interop.Excel.Series
            Dim X_ChartH As Integer

            Dim rh As Double

            rh = (X - 7) * 12.75
            rh = rh + 25.5
            rh = rh + (15 * 5)
            rh = rh + 33.75
            xlCharts = worksheet11.ChartObjects
            X_ChartH = (X + 18) * 10
            myChart = xlCharts.Add(7, rh, 905, 300)
            chartPage = myChart.Chart
            ' chartRange = worksheet1.Range(worksheet1.Cells("A8", "E" & (X - 1)), worksheet1.Cells("A9", "A" & (X - 1)))
            chartRange = worksheet11.Range("A8", "E" & (X - 1))
            chartPage.SetSourceData(Source:=chartRange)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
            chartPage.HasTitle = True

            chartPage.ChartTitle.Text = ("Summery of All Dye Machine Down Time %")




            xlCharts = worksheet11.ChartObjects
            X_ChartH = X_ChartH + 300
            rh = rh + 300
            myChart = xlCharts.Add(7, rh, 905, 300)
            'chartPage = myChart.Chart
            '' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
            'chartRange = worksheet1.Range("A9", "K" & (X - 1))
            ''chartRange = worksheet1.Range("H8", "K" & (X - 1))
            ''chartRange = worksheet1.Range("H8:K39", "A9:A39")
            'chartPage.SetSourceData(Source:=chartRange)
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartPage.SetSourceData(Source:=chartRange)
            'chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("Water Jet Machine Down Time %")
            'chartPage.Refresh()

            chartPage = myChart.Chart
            'With chartPage.SeriesCollection.NewSeries
            '    .Values = worksheet1.Range("K8:" & "K" & (X - 1))
            '    .XValues = worksheet1.Range("A8:" & "A" & (X - 1))
            '    .HasDataLabels = True

            'End With


            ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
            chartRange1 = worksheet11.Range("A9", "A" & (X - 1))
            ' chartRange = worksheet1.Range(worksheet1.Cells("A9", "A" & (X - 1)), worksheet1.Cells("H8", "K" & (X - 1)))
            ''chartRange = worksheet1.Range("H8", "K" & (X - 1))
            ''chartRange = worksheet1.Range("H8:K39", "A9:A39")
            '  chartPage.SetSourceData(Source:=chartRange)
            chartRange = worksheet11.Range("h8", "h" & (X - 1))

            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Fabric"
                t_Series.XValues = chartRange1
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            ' t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
            ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
            ' chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns
            ''chartRange = worksheet1.Range("N8", "Q" & (X - 1))
            'chartRange1 = worksheet1.Range("A9", "A" & (X - 1))
            ''chartRange = worksheet1.Range("H8", "K" & (X - 1))
            ''chartRange = worksheet1.Range("H8:K39", "A9:A39")
            '' chartPage.SetSourceData(Source:=chartRange)
            't_SerCol = chartPage.SeriesCollection
            't_Series = t_SerCol.NewSeries
            'With t_Series
            '    .Name = "Seris 1"
            '    t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            '    t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
            'End With
            'chartPage.Refresh()

            chartRange = worksheet11.Range("I8", "I" & (X - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Dye Technical  "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            ' t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
            '  chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked

            chartRange = worksheet11.Range("j8", "j" & (X - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Mainten"
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            ' t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
            '    chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked


            chartRange = worksheet11.Range("k8", "k" & (X - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Plan Mainten "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            ' t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
            chartPage.HasTitle = True
            chartPage.ChartTitle.Text = ("Water Jet Machine Down Time %")

            xlCharts = worksheet11.ChartObjects
            rh = rh + 300
            myChart = xlCharts.Add(7, rh, 905, 300)
            chartPage = myChart.Chart
            't_SerCol = chartPage.SeriesCollection

            'chartRange1 = worksheet1.Range("A9", "A" & (X - 1))

            'With t_Series
            '    '  .Name = "Total No Work"
            '    '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            '    t_Series.Values = chartRange1 '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            'End With
            ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
            chartRange1 = worksheet11.Range("A9", "A" & (X - 1))
            ''chartRange = worksheet1.Range("H8", "K" & (X - 1))
            ''chartRange = worksheet1.Range("H8:K39", "A9:A39")
            'chartPage.SetSourceData(Source:=chartRange1)
            chartRange = worksheet11.Range("N8", "N" & (X - 1))
            ' chartPage.SetSourceData(Source:=chartRange1)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Fabric"
                t_Series.XValues = chartRange1
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            chartRange = worksheet11.Range("o8", "o" & (X - 1))
            ' chartPage.SetSourceData(Source:=chartRange1)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Dye Technic"
                '   t_Series.XValues = chartRange1
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With

            chartRange = worksheet11.Range("p8", "p" & (X - 1))
            ' chartPage.SetSourceData(Source:=chartRange1)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Mainten"
                '   t_Series.XValues = chartRange1
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With

            chartRange = worksheet11.Range("q8", "q" & (X - 1))
            ' chartPage.SetSourceData(Source:=chartRange1)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Plan Mainten"
                '   t_Series.XValues = chartRange1
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
            chartPage.HasTitle = True
            chartPage.ChartTitle.Text = ("Air Flow Machine Down Time %")
            '===================================================================================
            xlCharts = worksheet11.ChartObjects
            rh = rh + 300
            myChart = xlCharts.Add(7, rh, 905, 300)
            chartPage = myChart.Chart
            chartRange = worksheet11.Range("A9", "A" & (X - 1))
            chartRange1 = worksheet11.Range("F9", "F" & (X - 1))
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Total No Work"
                t_Series.XValues = chartRange '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange1 '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            'chartPage.Refresh()
            chartRange = worksheet11.Range("L9", "L" & (X - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Water Jet No Work"
                '   t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
            End With

            '// Try uncommenting the next line if it still doesn't work.
            't_SerCol.Add(t_Series)
            t_Series.Border.Color = RGB(255, 215, 0)
            't_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
            't_Series.Format.Line.ForeColor.RGB = RGB(255, 127, 0)
            't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
            '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

            'chartPage.Refresh()


            chartRange = worksheet11.Range("R9", "R" & (X - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Air Flow No Work"
                '   t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
            End With

            '// Try uncommenting the next line if it still doesn't work.
            't_SerCol.Add(t_Series)
            t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            'chartRange1 = worksheet1.Range("L8", "L" & (X - 1))
            ''chartPage.SetSourceData(Source:=chartRange1)
            'chartRange2 = worksheet1.Range("R8", "R" & (X - 1))
            'chartPage.SetSourceData(Source:=chartRange)
            ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
            'chartRange = worksheet1.Range("A8", "R" & (X - 1))
            ''chartRange = worksheet1.Range("H8", "K" & (X - 1))
            ''chartRange = worksheet1.Range("H8:K39", "A9:A39")
            'chartPage.SetSourceData(Source:=chartRange)
            'chartRange = worksheet1.Range("F9", "R" & (X - 1))
            'chartPage.SetSourceData(Source:=chartRange)
            'chartRange = worksheet1.Range("L9", "R" & (X - 1))
            'chartPage.SetSourceData(Source:=chartRange)
            'chartRange = worksheet1.Range("R" & (X - 1))
            'chartPage.SetSourceData(Source:=chartRange)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
            chartPage.HasTitle = True
            chartPage.ChartTitle.Text = ("No Work down Time %")


        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try

    End Function

    Function WeeklyDowntime()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Weekly Down Time Analysis"
        worksheet11.Cells(2, 3) = "Textured Jersey PLC"
        worksheet11.Rows(2).Font.Bold = True
        worksheet11.Rows(2).Font.size = 26
        worksheet11.Range("A2:J2").MergeCells = True
        worksheet11.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet11.Cells(4, 1) = "Weekly Down Time Analysis Report "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10


        worksheet11.Rows(6).rowheight = 20.25

        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Cells(7, 3) = "SUMMERY OF ALL MACHINE "
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")


        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 7)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet11.Cells(7, 3)
        ' range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet1.Cells(7, 3).VerticalAlignment = XlVAlign.xlVAlignCenter
        ' range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 8) = "WATER JET MACHINE "
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet11.Range("B2:G2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 13)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(7, 8)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        '   range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 14) = "AIR FLOW MACHINE "
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet11.Range("B7:G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 19)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(7, 14)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous
        For i = 1 To 19
            range1 = worksheet11.Cells(7, i)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
        Next

        Dim X As Integer

        For i = 2 To 19

            ' For X = 3 To 9
            X = i
            worksheet11.Cells(8, X) = "Fabric "
            worksheet11.Rows(8).Font.Bold = True
            worksheet11.Rows(8).Font.size = 10
            worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous

            worksheet11.Columns(X).columnwidth = 8
            ' range1.Interior.Color = RGB(255, 255, 255)

            X = X + 1
            worksheet11.Cells(8, X) = "Dye Technical "
            worksheet11.Rows(8).Font.Bold = True
            worksheet11.Rows(8).Font.size = 10
            worksheet11.Cells(8, X).WrapText = True
            worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            X = X + 1

            worksheet11.Cells(8, X) = "Mainten "
            worksheet11.Rows(8).Font.Bold = True
            worksheet11.Rows(8).Font.size = 10
            worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            X = X + 1

            worksheet11.Cells(8, X) = "Plan Mainten "
            worksheet11.Rows(8).Font.Bold = True
            worksheet11.Rows(8).Font.size = 10
            worksheet11.Cells(8, X).WrapText = True
            worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            X = X + 1

            If X = 12 Then

                worksheet11.Cells(8, X) = "Water Jet No work "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).WrapText = True
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ' range1 = worksheet1.Cells(8, X)
                'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                'worksheet1.Columns(3).columnwidth = 17
                range1.Font.Color = RGB(255, 0, 0)
            ElseIf X = 18 Then
                worksheet11.Cells(8, X) = "Air Flow No work "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).WrapText = True
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ' range1 = worksheet1.Cells(8, X)
                'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                'worksheet1.Columns(3).columnwidth = 17
                range1.Font.Color = RGB(255, 0, 0)
            Else
                worksheet11.Cells(8, X) = "Total No work "
                worksheet11.Rows(8).Font.Bold = True
                worksheet11.Rows(8).Font.size = 10
                worksheet11.Cells(8, X).WrapText = True
                worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ' range1 = worksheet1.Cells(8, X)
                'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet11.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                'worksheet1.Columns(3).columnwidth = 17
                range1.Font.Color = RGB(255, 0, 0)
            End If
            X = X + 1

            worksheet11.Cells(8, X) = "Total"
            worksheet11.Rows(8).Font.Bold = True
            worksheet11.Rows(8).Font.size = 10
            worksheet11.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter

            range1 = worksheet11.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            range1.Font.Color = RGB(0, 0, 255)

            X = X + 1

            i = i + 5
            'Next
        Next

        'worksheet1.Cells("A8", "S8").Borders.LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet11.Cells(8, 1)

        worksheet11.Cells(8, 3).WrapText = True
        range1.Borders.LineStyle = XlLineStyle.xlContinuous
        n_Date = CDate(txtFromDate.Text).AddDays(-365)

        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        'CALCULATE ALL MACHINE
        Dim N_TOTALHR As Integer

        N_TOTALHR = 24 * 27 * 60 * 7

        Dim xl_Columcn As Integer

        xl_Columcn = 2

        SQL = "SELECT max(T01Week) as T01Week,T01WeekNo,SUM(T01Taken) AS T01Taken FROM T01Down_Time WHERE T01Machine NOT IN ('18','19','20') AND T01DATE BETWEEN '" & n_Date & "' AND '" & N_Date1 & "' GROUP BY T01WeekNo,T01Year order by T01Year,T01WeekNo"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        X = 9
        For Each DTRow2 As DataRow In T01.Tables(0).Rows
            xl_Columcn = 2
            N_TOTALHR = 24 * 27 * 60 * 7
            worksheet11.Cells(X, 1) = T01.Tables(0).Rows(i)("T01Week")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet1.Cells(X, 1).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(X).Font.size = 10
            'worksheet1.Cells(8, X).WrapText = True
            'worksheet1.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '' range1 = worksheet1.Cells(8, X)
            ''range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet11.Cells(8, X)
            ' range1.Borders.LineStyle = XlLineStyle.xlContinuous
            Dim x_Date As Integer
            Dim x_Date1 As Date
            '  Dim n_per As Double
            ' Dim y As Integer

            x_Date = T01.Tables(0).Rows(i)("T01WeekNo")
            'x_Date1 = CDate(x_Date).AddDays(+1)

            'x_Date = x_Date & " " & "7:30AM"
            'x_Date1 = x_Date1 & " " & "7:30AM"

            '-----------------------------------------------Fabric All Machine

            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='Fabric' and T03Type in ('01','02') AND T01WeekNo= '" & x_Date & "' AND T01DATE between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next
            n_per = n_per / N_TOTALHR
            'n_per = n_per * 100
            worksheet11.Cells(X, xl_Columcn) = n_per
            'worksheet1.Range("C1:C10").NumberFormat = "0.00"

            worksheet11.Rows(X).Font.size = 10
            range1 = worksheet11.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1


         
            ' worksheet1.Columns("C:C").NumberFormat = "#.00;@"
            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='TechD' and T03Type in ('01','02') AND T01WeekNo= '" & x_Date & "' AND T01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            'n_per = n_per * 100
            ' worksheet11.Cells(X, xl_Columcn) = n_per & "%"
            ' range1 = worksheet11.Cells(X, xl_Columcn)
            'range1.NumberFormat = "0.00%"
            worksheet11.Cells(X, xl_Columcn) = n_per
            ' range1 = worksheet11.Cells(X, xl_Columcn)
            '  worksheet1.Range("C9:C10").NumberFormat = "0.00"
            worksheet11.Rows(X).Font.size = 10
            range1 = worksheet11.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1
          
            '================================================
            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='MainM' and T03Type in ('01','02') AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            '  n_per = n_per * 100
            ' worksheet11.Cells(X, xl_Columcn) = n_per & "%"
            worksheet11.Cells(X, xl_Columcn) = n_per
            'worksheet1.Cells(X, xl_Columcn).EntireColumn.NumberFormat = "0"
            ' worksheet1.Cells(X, xl_Columcn).selection.NumberFormat = "0"
            ' worksheet1.Columns("D:D").NumberFormat = "#;@"
            range1 = worksheet11.Cells(X, xl_Columcn)
            ' range1.selection.NumberFormat = "0"
            worksheet11.Rows(X).Font.size = 10
            range1 = worksheet11.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1
          


            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='PM' and T03Type in ('01','02') AND T01WeekNo='" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet11.Cells(X, xl_Columcn) = n_per
            range1 = worksheet11.Cells(X, xl_Columcn)
            worksheet11.Rows(X).Font.size = 10
            range1 = worksheet11.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1
            ' range1 = worksheet1.Cells(X, xl_Columcn)
            'worksheet1.Cells(X, xl_Columcn).NumberFormat = "@"

        
            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type in ('01','02') AND T01WeekNo='" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet11.Cells(X, xl_Columcn) = n_per
            worksheet11.Rows(X).Font.size = 10
            'worksheet1.Cells(X, xl_Columcn).NumberFormat = "# ##0"
            range1 = worksheet11.Cells(X, xl_Columcn)

            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(255, 0, 0)
            xl_Columcn = xl_Columcn + 1


            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20')  and T03Type in ('01','02') AND M05Name in ('Fabric','No Work','PM','MainM','TechD') AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet11.Cells(X, xl_Columcn) = n_per
            worksheet11.Rows(X).Font.size = 10

            range1 = worksheet11.Cells(X, xl_Columcn)
            ' range1 = worksheet11.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            xl_Columcn = xl_Columcn + 1
            '-----------------------------------------------------OTHER MACHINE
            Dim z As Integer
            z = 0
            SQL = "SELECT * FROM M01Dyeing_MC_Type WHERE m01CODE IN ('01','02')"
            T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T04.Tables(0).Rows

                If Trim(T04.Tables(0).Rows(z)("m01code")) = "01" Then
                    N_TOTALHR = 18 * 24 * 60 * 7
                Else
                    N_TOTALHR = 9 * 24 * 60 * 7
                End If
                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='Fabric' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next
                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet11.Cells(X, xl_Columcn)

                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='TechD' and T03Type='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                ' n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet11.Cells(X, xl_Columcn)

                '================================================

                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='MainM' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                '  n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"

                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet11.Cells(X, xl_Columcn)


                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='PM' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                'worksheet11.Cells(X, xl_Columcn) = Microsoft.VisualBasic.Format(n_per, "#.00") & "%"
                worksheet11.Rows(X).Font.size = 10
                range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1

                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01WeekNo= '" & x_Date & "' AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10

                range1 = worksheet11.Cells(X, xl_Columcn)
                ' range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(255, 0, 0)
                xl_Columcn = xl_Columcn + 1


                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20')  and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01WeekNo= '" & x_Date & "' AND M05Name in ('Fabric','No Work','PM','MainM','TechD') AND t01date between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                ' n_per = n_per * 100
                worksheet11.Cells(X, xl_Columcn) = n_per
                worksheet11.Rows(X).Font.size = 10

                range1 = worksheet11.Cells(X, xl_Columcn)
                ' range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(0, 0, 255)
                xl_Columcn = xl_Columcn + 1
                z = z + 1
            Next
            i = i + 1
            worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("B" & X & ":B" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & X & ":B" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & X & ":C" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & X & ":C" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & X & ":E" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & X & ":E" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & X & ":F" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & X & ":F" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & X & ":G" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & X & ":G" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & X & ":H" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & X & ":H" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & X & ":I" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & X & ":I" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & X & ":J" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & X & ":J" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & X & ":K" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & X & ":K" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & X & ":L" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & X & ":L" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & X & ":M" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & X & ":M" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & X & ":N" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & X & ":N" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & X & ":O" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & X & ":O" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & X & ":P" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & X & ":P" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & X & ":Q" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & X & ":Q" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & X & ":R" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & X & ":R" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & X & ":S" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & X & ":S" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            X = X + 1
        Next
        '---------------------------------------------------------------

        
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim rh As Double

        z1 = X - 14
        z1 = z1 * 25
        z1 = z1 + 165

        z1 = (X + 8) * 10

        rh = (X - 5) * 15
        rh = rh + 33.75 '+ 12.75 + 25.5
        rh = rh + (25.5)
        xlCharts = worksheet11.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        ' myChart = xlCharts.Add(10, X_ChartH, 905, 300)
        'chartPage = myChart.Chart
        ' chartRange = worksheet1.Range(worksheet1.Cells("A8", "E" & (X - 1)), worksheet1.Cells("A9", "A" & (X - 1)))
      
        chartRange1 = worksheet11.Range("A9", "A" & (X - 1))
        chartRange = worksheet11.Range("b9", "b" & (X - 1))

        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Fabric"
            t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With


        chartRange = worksheet11.Range("c9", "c" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dye Technical  "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '  chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked

        chartRange = worksheet11.Range("d9", "d" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Mainten"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '    chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked


        chartRange = worksheet11.Range("e9", "e" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Plan Mainten "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Summery of All Machine Down Time %")



        xlCharts = worksheet11.ChartObjects
        z1 = z1 + 300
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)

        chartPage = myChart.Chart
       
        ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
        chartRange1 = worksheet11.Range("A9", "A" & (X - 1))
        chartRange = worksheet11.Range("h9", "h" & (X - 1))

        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Fabric"
            t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
     

        chartRange = worksheet11.Range("I9", "I" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dye Technical  "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '  chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked

        chartRange = worksheet11.Range("j9", "j" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Mainten"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '    chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked


        chartRange = worksheet11.Range("k9", "k" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Plan Mainten "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Water Jet Machine Down Time %")

        xlCharts = worksheet11.ChartObjects
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        

        
        ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
        chartRange1 = worksheet11.Range("A9", "A" & (X - 1))
        chartRange = worksheet11.Range("N9", "N" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Fabric"
            t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        chartRange = worksheet11.Range("o9", "o" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dye Technic"
            '   t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With

        chartRange = worksheet11.Range("p9", "p" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Mainten"
            '   t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With

        chartRange = worksheet11.Range("q9", "q" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Plan Mainten"
            '   t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Air Flow Machine Down Time %")
        '===================================================================================
        xlCharts = worksheet11.ChartObjects
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet11.Range("A9", "A" & (X - 1))
        chartRange1 = worksheet11.Range("F9", "F" & (X - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Total No Work"
            t_Series.XValues = chartRange '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange1 '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        'chartPage.Refresh()
        chartRange = worksheet11.Range("L9", "L" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Water Jet No Work"
            '   t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(255, 215, 0)

        chartRange = worksheet11.Range("R9", "R" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow No Work"
            '   t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(255, 0, 0)
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("No Work down Time %")


        worksheet11.Rows(9).Select()
        worksheet11.Application.ActiveWindow.FreezePanes = True
    End Function
    Private Sub cmdSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdSave.Click

        Try

            ' Whitemal_Monthly()
            '  Call ShadeDis_Monthly()
            Call Batch_perMonthWJ()
            Call Batch_perWeekWJ()
            Call Batch_perDayWJ()

            Call Batch_perMonthAF()
            Call Batch_perWeekAF()
            Call Batch_perDayAFNw()

            Call Monthly_DownTime()
            Call WeeklyDowntime()
            '  Call DailyDownTime()

            Call Monthly_BoilOut()
            Call Weekly_Boilout()


            Call Monthly_efficinacy()
            Call Weekly_efficincy()

            Call Monthly_InefficincyWJ()
            Call WEEKLYAF_INEFFICINCY()



6:          Call MonthlyInefficiency_AF()
            Call Weekly_AFInefficiency()

0:          Call ShadeDis_Monthly()
            Call ShadeDis_Weekly()

            Call Product_WJ()
            Call Product_Af()

            Call Whitemal_Monthly()
            Call Whitemal_Weekly()


            Call Avg_LaneWJMonthly()
            Call Avg_LaneWtWJ()
            Call Avg_LaneWtAFMonthly()
            Call Avg_LaneWtAF()


            Call ShadeDis_Daaily()
            Call Avarage_SDTimeMonthly_WJ()
            Call Avarage_SDTimeWeekly_WJ()
            Call Avarage_SDTimeDaily_WJ()

            Call Avarage_SDTimeMonthly_AF()
            Call Avarage_SDTimeWeekly_AF()
            Call Avarage_SDTimeDaily_AF()

            Call Daily_Boliout()
            Call DailyDownTime()
            Call Daily_Efficincy()


            Call OvarallInWJGrf()
            Call OvarallInAFGrf1()
            Call WhiteMalGf()
            'Call WeeklyDowntime()
            'Call Monthly_DownTime()
            'Call Daily_Boliout()
            'Call Weekly_Boilout()
            'Call Monthly_BoilOut()

            'Call Daily_Efficincy()
            'Call Weekly_efficincy()
            'Call Monthly_efficinacy()

            'Call ShadeDis_Daaily()
            'Call ShadeDis_Weekly()
            'Call ShadeDis_Monthly()

            'Call Weekly_AFInefficiency()
            'Call WEEKLYAF_INEFFICINCY()

            'Call MonthlyInefficiency_AF()
            'Call Monthly_InefficincyWJ()

            'Call Whitemal_Weekly()
            'Call Whitemal_Monthly()


            'Call Product_Af()
            'Call Product_WJ()

            'Call Avarage_SDTimeDaily_WJ()
            'Call Avarage_SDTimeWeekly_WJ()
            'Call Avarage_SDTimeMonthly_WJ()

            'Call Avarage_SDTimeDaily_AF()
            'Call Avarage_SDTimeWeekly_AF()
            'Call Avarage_SDTimeMonthly_AF()

            'Call Avg_LaneWtAF()
            'Call Avg_LaneWtAFMonthly()

            'Call Avg_LaneWtWJ()
            'Call Avg_LaneWJMonthly()


            'Call Batch_perDayAF()
            'Call Batch_perWeekAF()
            'Call Batch_perMonthAF()
        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try
    End Sub
    Function Monthly_DownTime()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet12 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet12.Name = "Monthly Down Time Analysis"
        worksheet12.Cells(2, 3) = "Textured Jersey PLC"
        worksheet12.Rows(2).Font.Bold = True
        worksheet12.Rows(2).Font.size = 26
        worksheet12.Range("A2:J2").MergeCells = True
        worksheet12.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet12.Cells(4, 1) = "Monthly Down Time Analysis Report "
        worksheet12.Rows(4).Font.Bold = True
        worksheet12.Rows(4).Font.size = 10


        worksheet12.Rows(6).rowheight = 20.25

        worksheet12.Rows(6).Font.Bold = True
        worksheet12.Rows(6).Font.size = 10
        worksheet12.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet12.Cells(7, 3) = "SUMMERY OF ALL MACHINE "
        worksheet12.Rows(7).Font.Bold = True
        worksheet12.Rows(7).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")


        worksheet12.Range(worksheet12.Cells(7, 3), worksheet12.Cells(7, 7)).Merge()
        worksheet12.Range(worksheet12.Cells(7, 3), worksheet12.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet12.Cells(7, 3)
        ' range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet1.Cells(7, 3).VerticalAlignment = XlVAlign.xlVAlignCenter
        ' range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet12.Cells(7, 8) = "WATER JET MACHINE "
        worksheet12.Rows(7).Font.Bold = True
        worksheet12.Rows(7).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet12.Range("B2:G2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet12.Range(worksheet12.Cells(7, 8), worksheet12.Cells(7, 13)).Merge()
        worksheet12.Range(worksheet12.Cells(7, 8), worksheet12.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet12.Cells(7, 8)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        '   range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet12.Cells(7, 14) = "AIR FLOW MACHINE "
        worksheet12.Rows(7).Font.Bold = True
        worksheet12.Rows(7).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet12.Range("B7:G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet12.Range(worksheet12.Cells(7, 14), worksheet12.Cells(7, 19)).Merge()
        worksheet12.Range(worksheet12.Cells(7, 14), worksheet12.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet12.Cells(7, 14)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous
        For i = 1 To 19
            range1 = worksheet12.Cells(7, i)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
        Next

        Dim X As Integer

        For i = 2 To 19

            ' For X = 3 To 9
            X = i
            worksheet12.Cells(8, X) = "Fabric "
            worksheet12.Rows(8).Font.Bold = True
            worksheet12.Rows(8).Font.size = 10
            worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous

            worksheet12.Columns(X).columnwidth = 8
            ' range1.Interior.Color = RGB(255, 255, 255)

            X = X + 1
            worksheet12.Cells(8, X) = "Dye Technical "
            worksheet12.Rows(8).Font.Bold = True
            worksheet12.Rows(8).Font.size = 10
            worksheet12.Cells(8, X).WrapText = True
            worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            X = X + 1

            worksheet12.Cells(8, X) = "Mainten "
            worksheet12.Rows(8).Font.Bold = True
            worksheet12.Rows(8).Font.size = 10
            worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            X = X + 1

            worksheet12.Cells(8, X) = "Plan Mainten "
            worksheet12.Rows(8).Font.Bold = True
            worksheet12.Rows(8).Font.size = 10
            worksheet12.Cells(8, X).WrapText = True
            worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            X = X + 1

            If X = 12 Then

                worksheet12.Cells(8, X) = "Water Jet No work "
                worksheet12.Rows(8).Font.Bold = True
                worksheet12.Rows(8).Font.size = 10
                worksheet12.Cells(8, X).WrapText = True
                worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ' range1 = worksheet1.Cells(8, X)
                'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet12.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                'worksheet1.Columns(3).columnwidth = 17
                range1.Font.Color = RGB(255, 0, 0)
            ElseIf X = 18 Then
                worksheet12.Cells(8, X) = "Air Flow No work "
                worksheet12.Rows(8).Font.Bold = True
                worksheet12.Rows(8).Font.size = 10
                worksheet12.Cells(8, X).WrapText = True
                worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ' range1 = worksheet1.Cells(8, X)
                'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet12.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                'worksheet1.Columns(3).columnwidth = 17
                range1.Font.Color = RGB(255, 0, 0)
            Else
                worksheet12.Cells(8, X) = "Total No work "
                worksheet12.Rows(8).Font.Bold = True
                worksheet12.Rows(8).Font.size = 10
                worksheet12.Cells(8, X).WrapText = True
                worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ' range1 = worksheet1.Cells(8, X)
                'range1.VerticalAlignment = XlVAlign.xlVAlignCenter
                range1 = worksheet12.Cells(8, X)
                range1.Borders.LineStyle = XlLineStyle.xlContinuous

                'worksheet1.Columns(3).columnwidth = 17
                range1.Font.Color = RGB(255, 0, 0)
            End If
            X = X + 1

            worksheet12.Cells(8, X) = "Total"
            worksheet12.Rows(8).Font.Bold = True
            worksheet12.Rows(8).Font.size = 10
            worksheet12.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet12.Cells(8, X)
            range1.VerticalAlignment = XlVAlign.xlVAlignCenter

            range1 = worksheet12.Cells(8, X)
            range1.Borders.LineStyle = XlLineStyle.xlContinuous
            range1.Font.Color = RGB(0, 0, 255)

            X = X + 1

            i = i + 5
            'Next
        Next
        Dim L_DateofMonth As Integer

        'worksheet1.Cells("A8", "S8").Borders.LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet12.Cells(8, 1)

        worksheet12.Cells(8, 3).WrapText = True
        range1.Borders.LineStyle = XlLineStyle.xlContinuous
        n_Date = CDate(txtFromDate.Text).AddDays(-365)

        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        'CALCULATE ALL MACHINE
        Dim N_TOTALHR As Integer

        N_TOTALHR = 24 * 27 * 60 * 7

        Dim xl_Columcn As Integer

        xl_Columcn = 2

        SQL = "SELECT year(T01DATE)as UYear,T01Month,SUM(T01Taken) AS T01Taken FROM T01Down_Time WHERE T01Machine NOT IN ('18','19','20') AND T01DATE BETWEEN '" & n_Date & "' AND '" & N_Date1 & "' GROUP BY  T01Month,year(T01DATE) order by year(T01DATE),T01Month"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        X = 9
        For Each DTRow2 As DataRow In T01.Tables(0).Rows
            xl_Columcn = 2
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("UYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet12.Cells(X, 1) = MonthName(T01.Tables(0).Rows(i)("T01month"), True) & "-" & T01.Tables(0).Rows(i)("UYear")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet1.Cells(X, 1).EntireColumn.NumberFormat = "dd-MMM"
            worksheet12.Rows(X).Font.size = 10
            'worksheet1.Cells(8, X).WrapText = True
            'worksheet1.Cells(8, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '' range1 = worksheet1.Cells(8, X)
            ''range1.VerticalAlignment = XlVAlign.xlVAlignCenter
            range1 = worksheet12.Cells(8, X)
            ' range1.Borders.LineStyle = XlLineStyle.xlContinuous
            Dim x_Date As Integer
            Dim x_Date1 As Date
            '  Dim n_per As Double
            ' Dim y As Integer

            x_Date = T01.Tables(0).Rows(i)("T01Month")
            'x_Date1 = CDate(x_Date).AddDays(+1)

            'x_Date = x_Date & " " & "7:30AM"
            'x_Date1 = x_Date1 & " " & "7:30AM"

            '-----------------------------------------------Fabric All Machine
            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='Fabric' and T03Type in ('01','02') AND T01Month= '" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01Month" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next
            n_per = n_per / N_TOTALHR
            'n_per = n_per * 100
            worksheet12.Cells(X, xl_Columcn) = n_per
            'worksheet1.Range("C1:C10").NumberFormat = "0.00"

            worksheet12.Rows(X).Font.size = 10
            range1 = worksheet12.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1



            ' worksheet1.Columns("C:C").NumberFormat = "#.00;@"
            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='TechD' and T03Type in ('01','02') AND T01month= '" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            'n_per = n_per * 100
            ' worksheet11.Cells(X, xl_Columcn) = n_per & "%"
            ' range1 = worksheet11.Cells(X, xl_Columcn)
            'range1.NumberFormat = "0.00%"
            worksheet12.Cells(X, xl_Columcn) = n_per
            ' range1 = worksheet11.Cells(X, xl_Columcn)
            '  worksheet1.Range("C9:C10").NumberFormat = "0.00"
            worksheet12.Rows(X).Font.size = 10
            range1 = worksheet12.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1

            '================================================
            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='MainM' and T03Type in ('01','02') AND T01month= '" & x_Date & "' AND Year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            '  n_per = n_per * 100
            ' worksheet11.Cells(X, xl_Columcn) = n_per & "%"
            worksheet12.Cells(X, xl_Columcn) = n_per
            'worksheet1.Cells(X, xl_Columcn).EntireColumn.NumberFormat = "0"
            ' worksheet1.Cells(X, xl_Columcn).selection.NumberFormat = "0"
            ' worksheet1.Columns("D:D").NumberFormat = "#;@"
            range1 = worksheet12.Cells(X, xl_Columcn)
            ' range1.selection.NumberFormat = "0"
            worksheet12.Rows(X).Font.size = 10
            range1 = worksheet12.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1



            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='PM' and T03Type in ('01','02') AND T01Month='" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01Month" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet12.Cells(X, xl_Columcn) = n_per
            range1 = worksheet12.Cells(X, xl_Columcn)
            worksheet12.Rows(X).Font.size = 10
            range1 = worksheet12.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            xl_Columcn = xl_Columcn + 1
            ' range1 = worksheet1.Cells(X, xl_Columcn)
            'worksheet1.Cells(X, xl_Columcn).NumberFormat = "@"


            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type in ('01','02') AND T01month='" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet12.Cells(X, xl_Columcn) = n_per
            worksheet12.Rows(X).Font.size = 10
            'worksheet1.Cells(X, xl_Columcn).NumberFormat = "# ##0"
            range1 = worksheet12.Cells(X, xl_Columcn)

            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(255, 0, 0)
            xl_Columcn = xl_Columcn + 1


            Y = 0
            n_per = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20')  and T03Type in ('01','02') AND M05Name in ('Fabric','No Work','PM','MainM','TechD') AND T01month= '" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("UYear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                Y = Y + 1
            Next

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet12.Cells(X, xl_Columcn) = n_per
            worksheet12.Rows(X).Font.size = 10

            range1 = worksheet12.Cells(X, xl_Columcn)
            ' range1 = worksheet11.Cells(X, xl_Columcn)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            xl_Columcn = xl_Columcn + 1
            '-----------------------------------------------------OTHER MACHINE
            Dim z As Integer
            z = 0
            SQL = "SELECT * FROM M01Dyeing_MC_Type WHERE m01CODE IN ('01','02')"
            T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow3 As DataRow In T04.Tables(0).Rows

                If Trim(T04.Tables(0).Rows(z)("m01code")) = "01" Then
                    N_TOTALHR = 18 * 24 * 60 * L_DateofMonth
                Else
                    N_TOTALHR = 9 * 24 * 60 * L_DateofMonth
                End If
                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='Fabric' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01month= '" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next
                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet12.Cells(X, xl_Columcn) = n_per
                worksheet12.Rows(X).Font.size = 10
                range1 = worksheet12.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet11.Cells(X, xl_Columcn)

                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='TechD' and T03Type='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01month= '" & x_Date & "' AND Year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                ' n_per = n_per * 100
                worksheet12.Cells(X, xl_Columcn) = n_per
                worksheet12.Rows(X).Font.size = 10
                range1 = worksheet12.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet11.Cells(X, xl_Columcn)

                '================================================

                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='MainM' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01month= '" & x_Date & "' AND year(T01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                '  n_per = n_per * 100
                worksheet12.Cells(X, xl_Columcn) = n_per
                worksheet12.Rows(X).Font.size = 10
                range1 = worksheet12.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"

                xl_Columcn = xl_Columcn + 1
                ' range1 = worksheet11.Cells(X, xl_Columcn)


                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='PM' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01month= '" & x_Date & "' AND year(t01date)= '" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet12.Cells(X, xl_Columcn) = n_per
                'worksheet11.Cells(X, xl_Columcn) = Microsoft.VisualBasic.Format(n_per, "#.00") & "%"
                worksheet12.Rows(X).Font.size = 10
                range1 = worksheet12.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                xl_Columcn = xl_Columcn + 1

                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01month= '" & x_Date & "' AND year(t01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                'n_per = n_per * 100
                worksheet12.Cells(X, xl_Columcn) = n_per
                worksheet12.Rows(X).Font.size = 10

                range1 = worksheet12.Cells(X, xl_Columcn)
                ' range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(255, 0, 0)
                xl_Columcn = xl_Columcn + 1


                Y = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') AND M05Name in ('Fabric','No Work','PM','MainM','TechD') and T03Type ='" & T04.Tables(0).Rows(z)("m01CODE") & "' AND T01month= '" & x_Date & "' AND year(t01date)='" & T01.Tables(0).Rows(i)("Uyear") & "' GROUP BY T03Type,T01month" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next

                n_per = n_per / N_TOTALHR
                ' n_per = n_per * 100
                worksheet12.Cells(X, xl_Columcn) = n_per
                worksheet12.Rows(X).Font.size = 10

                range1 = worksheet12.Cells(X, xl_Columcn)
                ' range1 = worksheet11.Cells(X, xl_Columcn)
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(0, 0, 255)
                xl_Columcn = xl_Columcn + 1
                z = z + 1
            Next
            i = i + 1

            worksheet12.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet12.Range("B" & X & ":B" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("B" & X & ":B" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("C" & X & ":C" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("C" & X & ":C" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("D" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("D" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("E" & X & ":E" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("E" & X & ":E" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("F" & X & ":F" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("F" & X & ":F" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("G" & X & ":G" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("G" & X & ":G" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("H" & X & ":H" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("H" & X & ":H" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("I" & X & ":I" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("I" & X & ":I" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("J" & X & ":J" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("J" & X & ":J" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("K" & X & ":K" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("K" & X & ":K" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("L" & X & ":L" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("L" & X & ":L" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("M" & X & ":M" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("M" & X & ":M" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("N" & X & ":N" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("N" & X & ":N" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("O" & X & ":O" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("O" & X & ":O" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("P" & X & ":P" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("P" & X & ":P" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("Q" & X & ":Q" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("Q" & X & ":Q" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("R" & X & ":R" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("R" & X & ":R" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("S" & X & ":S" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet12.Range("S" & X & ":S" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            X = X + 1
        Next
        '---------------------------------------------------------------


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet

        z1 = X - 14
        z1 = z1 * 25
        z1 = z1 + 120


        z1 = (X + 7) * 10
        Dim rh As Double
        rh = 0
        rh = (X - 3) * 15
        rh = rh + 33.75 + 25.5
        xlCharts = worksheet12.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        ' myChart = xlCharts.Add(10, X_ChartH, 905, 300)
        'chartPage = myChart.Chart
        ' chartRange = worksheet1.Range(worksheet1.Cells("A8", "E" & (X - 1)), worksheet1.Cells("A9", "A" & (X - 1)))

        chartRange1 = worksheet12.Range("A9", "A" & (X - 1))
        chartRange = worksheet12.Range("b9", "b" & (X - 1))

        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Fabric"
            t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With


        chartRange = worksheet12.Range("c9", "c" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dye Technical  "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '  chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked

        chartRange = worksheet12.Range("d9", "d" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Mainten"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '    chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked


        chartRange = worksheet12.Range("e9", "e" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Plan Mainten "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Summery of All Machine Down Time %")



        xlCharts = worksheet12.ChartObjects
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)

        chartPage = myChart.Chart

        ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
        chartRange1 = worksheet12.Range("A9", "A" & (X - 1))
        chartRange = worksheet12.Range("h9", "h" & (X - 1))

        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Fabric"
            t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With


        chartRange = worksheet12.Range("I9", "I" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dye Technical  "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '  chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked

        chartRange = worksheet12.Range("j9", "j" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Mainten"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        '    chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked


        chartRange = worksheet12.Range("k9", "k" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Plan Mainten "
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(255, 0, 0)
        ' chartPage.Refresh()
        ' chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Water Jet Machine Down Time %")

        xlCharts = worksheet12.ChartObjects
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart



        ' chartRange = worksheet1.Range("'Daily Down Time Analysis'!$A$9:$A$39,'Daily Down Time Analysis'!$H$8:$K$39")
        chartRange1 = worksheet12.Range("A9", "A" & (X - 1))
        chartRange = worksheet12.Range("N9", "N" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Fabric"
            t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        chartRange = worksheet12.Range("o9", "o" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dye Technic"
            '   t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With

        chartRange = worksheet12.Range("p9", "p" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Mainten"
            '   t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With

        chartRange = worksheet12.Range("q9", "q" & (X - 1))
        ' chartPage.SetSourceData(Source:=chartRange1)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Plan Mainten"
            '   t_Series.XValues = chartRange1
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Air Flow Machine Down Time %")
        '===================================================================================
        xlCharts = worksheet12.ChartObjects
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet12.Range("A9", "A" & (X - 1))
        chartRange1 = worksheet12.Range("F9", "F" & (X - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Total No Work"
            t_Series.XValues = chartRange '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange1 '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        'chartPage.Refresh()
        chartRange = worksheet12.Range("L9", "L" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Water Jet No Work"
            '   t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(255, 215, 0)

        chartRange = worksheet12.Range("R9", "R" & (X - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow No Work"
            '   t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(255, 0, 0)
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("No Work down Time %")

        worksheet12.Rows(9).Select()
        worksheet12.Application.ActiveWindow.FreezePanes = True
    End Function
    Private Sub cmdAdd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdAdd.Click
        OPR0.Enabled = True
        OPR1.Enabled = True
        ' Call Clear_Text()
        cmdAdd.Enabled = False

        txtFromDate.Text = Today
        txtTodate.Text = Today

        cmdSave.Enabled = True

    End Sub
    Function Daily_Boliout()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet13 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet13.Name = "Daily Boil Out"
        worksheet13.Cells(2, 3) = "Textured Jersey PLC"
        worksheet13.Rows(2).Font.Bold = True
        worksheet13.Rows(2).Font.size = 26
        worksheet13.Range("A2:J2").MergeCells = True
        worksheet13.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet13.Cells(6, 1) = "Boil Outs Performance Data"
        worksheet13.Rows(6).Font.Bold = True
        worksheet13.Rows(6).Font.size = 12
        worksheet13.Rows(6).Font.Name = "Times New Roman"


        worksheet13.Rows(6).rowheight = 20.25
        '---------------------------------------------------------------------
        'page Header
        worksheet13.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet13.Cells(7, 1) = "ALL Dye machine  "
        worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet13.Columns("A").ColumnWidth = 8
        worksheet13.Columns("B").ColumnWidth = 5
        worksheet13.Columns("C").ColumnWidth = 8
        worksheet13.Columns("D").ColumnWidth = 8
        worksheet13.Columns("E").ColumnWidth = 5
        worksheet13.Columns("F").ColumnWidth = 8
        worksheet13.Columns("G").ColumnWidth = 8

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet13.Columns("H").ColumnWidth = 5
        worksheet13.Columns("J").ColumnWidth = 8
        worksheet13.Columns("K").ColumnWidth = 5
        worksheet13.Columns("L").ColumnWidth = 8
        worksheet13.Columns("M").ColumnWidth = 8
        worksheet13.Columns("N").ColumnWidth = 5




        'worksheet13.Columns("H").ColumnWidth = 8
        worksheet13.Columns("O").ColumnWidth = 8
        worksheet13.Columns("P").ColumnWidth = 8
        worksheet13.Columns("Q").ColumnWidth = 5
        worksheet13.Columns("R").ColumnWidth = 8
        worksheet13.Columns("S").ColumnWidth = 8
        worksheet13.Columns("T").ColumnWidth = 8

        worksheet13.Columns("U").ColumnWidth = 10
        worksheet13.Columns("V").ColumnWidth = 10
        worksheet13.Columns("W").ColumnWidth = 10


        worksheet13.Range(worksheet13.Cells(7, 1), worksheet13.Cells(7, 7)).Merge()
        worksheet13.Range(worksheet13.Cells(7, 1), worksheet13.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet13.Cells(7, 1)

        ' range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet1.Cells(7, 3).VerticalAlignment = XlVAlign.xlVAlignCenter
        ' range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(7, 8) = "Water jet machine "
        worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet13.Range("B2:G2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet13.Range(worksheet13.Cells(7, 8), worksheet13.Cells(7, 13)).Merge()
        worksheet13.Range(worksheet13.Cells(7, 8), worksheet13.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet13.Cells(7, 8)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        '   range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(7, 14) = "Air flow machine "
        worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet13.Range("B7:G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet13.Range(worksheet13.Cells(7, 14), worksheet13.Cells(7, 19)).Merge()
        worksheet13.Range(worksheet13.Cells(7, 14), worksheet13.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet13.Cells(7, 14)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous
        For i = 1 To 22
            range1 = worksheet13.Cells(7, i)
            If i > 19 Then
                'Dim borders As Microsoft.Office.Interop.Excel.i
                'borders = worksheet13.Range("A2:J2").Borders
                'borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'borders(XlBordersIndex.xlEdgeBottom).Weight = XlBorderWeight.xlThin
                'Borders(XlBordersIndex.xlEdgeBottom).ColorIndex = 3

                worksheet13.Range("T7", "V7").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("T7", "V7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlLineStyleNone
                worksheet13.Range("V7", "V7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("U7", "U7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Else
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
            End If

        Next

        ' worksheet13.Cells(8, 1) = "Date"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(8).Font.size = 10

        worksheet13.Cells(8, 2) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(8).Font.size = 10
        worksheet13.Range(worksheet13.Cells(8, 2), worksheet13.Cells(8, 7)).Merge()
        worksheet13.Range(worksheet13.Cells(8, 2), worksheet13.Cells(8, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("B8", "G8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("G8", "G8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(8, 8) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(8).Font.size = 10
        worksheet13.Range(worksheet13.Cells(8, 8), worksheet13.Cells(8, 13)).Merge()
        worksheet13.Range(worksheet13.Cells(8, 8), worksheet13.Cells(8, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("H8", "M8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("M8", "M8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(8, 14) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet13.Rows(8).Font.size = 10
        worksheet13.Range(worksheet13.Cells(8, 14), worksheet13.Cells(8, 19)).Merge()
        worksheet13.Range(worksheet13.Cells(8, 14), worksheet13.Cells(8, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("N8", "S8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("S8", "S8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(8, 20) = "Usage %"
        worksheet13.Cells(8, 20).Font.Bold = True
        worksheet13.Cells(8, 20).Font.size = 11
        worksheet13.Range(worksheet13.Cells(8, 20), worksheet13.Cells(8, 21)).Merge()
        worksheet13.Range(worksheet13.Cells(8, 20), worksheet13.Cells(8, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("T8", "U8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("U8", "U8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("V8", "V8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Range("A9", "A9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("B9", "B9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("D9", "D9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("C9", "D9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("E9", "E9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("F9", "F9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("G9", "G9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("H9", "H9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("J9", "J9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("K9", "K9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("L9", "L9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("M9", "M9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("N9", "N9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("P9", "P9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("Q9", "Q9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("R9", "R9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("S9", "S9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("T9", "T9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("U9", "U9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("V9", "V9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("I9", "J9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("O9", "P9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Range(worksheet13.Cells(9, 3), worksheet13.Cells(9, 4)).Merge()
        worksheet13.Range(worksheet13.Cells(9, 9), worksheet13.Cells(9, 10)).Merge()
        worksheet13.Range(worksheet13.Cells(9, 15), worksheet13.Cells(9, 16)).Merge()
        worksheet13.Range(worksheet13.Cells(9, 15), worksheet13.Cells(9, 16)).Merge()
        worksheet13.Range(worksheet13.Cells(8, 20), worksheet13.Cells(8, 21)).Merge()
        worksheet13.Range(worksheet13.Cells(7, 20), worksheet13.Cells(7, 21)).Merge()
        worksheet13.Range(worksheet13.Cells(8, 22), worksheet13.Cells(8, 22)).Merge()
        worksheet13.Range("V7", "V8").Merge()
        worksheet13.Range("T7", "T8").Merge()

        worksheet13.Range("A10", "A10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("B10", "B10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("A9", "A11").Merge()
        ' worksheet13.Range("B9", "B11").Merge()
        worksheet13.Range("B10", "B10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("B11", "B11").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("A11", "A11").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Rows("10:10").rowheight = 25

        '---------------------------------------------------------------------------ALL DYE M/C
        worksheet13.Cells(10, 2) = "plan"
        worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 2).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 2).Font.size = 10

        worksheet13.Cells(10, 3) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 3).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 3).Font.size = 10

        worksheet13.Cells(10, 3).WrapText = True
        worksheet13.Cells(10, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("C10", "C10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Cells(10, 4) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 4).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 4).Font.size = 10

        worksheet13.Cells(10, 4).WrapText = True
        worksheet13.Cells(10, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("D10", "D10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(10, 5) = "Total"
        worksheet13.Cells(10, 5).Font.Bold = True
        worksheet13.Cells(10, 5).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 5).Font.size = 10

        worksheet13.Cells(10, 5).WrapText = True
        worksheet13.Cells(10, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("E10", "E10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        range1 = worksheet13.Cells(10, 5)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet13.Cells(10, 6) = "total hours"
        worksheet13.Cells(10, 6).Font.Bold = True
        worksheet13.Cells(10, 6).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 6).Font.size = 10

        worksheet13.Cells(10, 6).WrapText = True
        worksheet13.Cells(10, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 6)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet13.Range("F10", "F10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet13.Cells(10, 7) = "hours per boil out"
        worksheet13.Cells(10, 7).Font.Bold = True
        worksheet13.Cells(10, 7).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 7).Font.size = 10

        worksheet13.Cells(10, 7).WrapText = True
        worksheet13.Cells(10, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 7)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet13.Range("G10", "G10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '-----------------------------------------------------------------------------------------------------------WATER JET M/C
        worksheet13.Cells(10, 8) = "plan"
        worksheet13.Cells(10, 8).Font.Bold = True
        worksheet13.Cells(10, 8).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 8).Font.size = 10
        worksheet13.Range("h10", "H10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 9) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 9).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 9).Font.size = 10

        worksheet13.Cells(10, 9).WrapText = True
        worksheet13.Cells(10, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("I10", "I10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(10, 10) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 10).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 10).Font.size = 10

        worksheet13.Cells(10, 10).WrapText = True
        worksheet13.Cells(10, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("J10", "J10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 11) = "Total"
        worksheet13.Cells(10, 11).Font.Bold = True
        worksheet13.Cells(10, 11).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 11).Font.size = 10

        worksheet13.Cells(10, 11).WrapText = True
        worksheet13.Cells(10, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 11)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet13.Range("K10", "K10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 12) = "total hours"
        worksheet13.Cells(10, 12).Font.Bold = True
        worksheet13.Cells(10, 12).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 12).Font.size = 10

        worksheet13.Cells(10, 12).WrapText = True
        worksheet13.Cells(10, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 12)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet13.Range("L10", "L10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 13) = "hours per boil out"
        worksheet13.Cells(10, 13).Font.Bold = True
        worksheet13.Cells(10, 13).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 13).Font.size = 10

        worksheet13.Cells(10, 13).WrapText = True
        worksheet13.Cells(10, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 13)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet13.Range("M10", "M10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '---------------------------------------------------------------------------------------------------------- AIR FLOW M/C
        worksheet13.Cells(10, 14) = "plan"
        worksheet13.Cells(10, 14).Font.Bold = True
        worksheet13.Cells(10, 14).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 14).Font.size = 10
        worksheet13.Range("N10", "N10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 15) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 15).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 15).Font.size = 10

        worksheet13.Cells(10, 15).WrapText = True
        worksheet13.Cells(10, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("O10", "O10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet13.Cells(10, 16) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet13.Cells(10, 16).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 16).Font.size = 10

        worksheet13.Cells(10, 16).WrapText = True
        worksheet13.Cells(10, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet13.Range("P10", "P10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 17) = "Total"
        worksheet13.Cells(10, 17).Font.Bold = True
        worksheet13.Cells(10, 17).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 17).Font.size = 10

        worksheet13.Cells(10, 17).WrapText = True
        worksheet13.Cells(10, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 17)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet13.Range("Q10", "Q10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 18) = "total hours"
        worksheet13.Cells(10, 18).Font.Bold = True
        worksheet13.Cells(10, 18).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 18).Font.size = 10

        worksheet13.Cells(10, 18).WrapText = True
        worksheet13.Cells(10, 18).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 18)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet13.Range("R10", "R10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 19) = "hours per boil out"
        worksheet13.Cells(10, 19).Font.Bold = True
        worksheet13.Cells(10, 19).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 19).Font.size = 10

        worksheet13.Cells(10, 19).WrapText = True
        worksheet13.Cells(10, 19).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 19)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet13.Range("S10", "S10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 20) = "Water jet machine"
        worksheet13.Cells(10, 20).Font.Bold = True
        worksheet13.Cells(10, 20).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 20).Font.size = 10

        worksheet13.Cells(10, 20).WrapText = True
        worksheet13.Cells(10, 20).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 20)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet13.Range("T10", "T10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet13.Cells(10, 21) = "Air flow machine"
        worksheet13.Cells(10, 21).Font.Bold = True
        worksheet13.Cells(10, 21).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 21).Font.size = 10

        worksheet13.Cells(10, 21).WrapText = True
        worksheet13.Cells(10, 21).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 21)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet13.Range("U10", "U10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet13.Cells(10, 22) = "all dye machine"
        worksheet13.Cells(10, 22).Font.Bold = True
        worksheet13.Cells(10, 22).Font.Name = "Times New Roman"
        worksheet13.Cells(10, 22).Font.size = 10

        worksheet13.Cells(10, 22).WrapText = True
        worksheet13.Cells(10, 22).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet13.Cells(10, 22)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet13.Range("V10", "V10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet13.Range("A10", "V10").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        ' worksheet13.Range("B9:B10").Style.Color = Color.Yellow
        ' worksheet13.Range("B9:B10").Style.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
        worksheet13.Range("B9:B10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("E9:E10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("F9:F10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("G9:G10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("H9:H10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("K9:K10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("L9:L10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("M9:M10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("N9:N10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("A9:A10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("Q9:Q10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("R9:R10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("S9:S10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("T9:T10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("U9:U10").Interior.Color = RGB(255, 255, 255)
        worksheet13.Range("V8:V10").Interior.Color = RGB(255, 255, 255)
        '---------------------------------------------------------------------------------------------------
        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-daysInFeb)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"

        'n_Date = CDate(txtFromDate.Text).AddDays(-30)
        'n_Date = n_Date & " " & "7:30AM"
        'N_Date1 = txtTodate.Text & " " & "7:30AM"


        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x=11
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            If CDate(T01.Tables(0).Rows(i)("Ddate")) <= CDate(txtTodate.Value) Then
                worksheet13.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate")
                ' worksheet1.Rows(8).Font.Bold = True
                worksheet13.Cells(x, 1).EntireColumn.NumberFormat = "dd-MMM"
                worksheet13.Rows(x).Font.size = 10

                Y = Y + 1
                Dim x_date As Date
                Dim x_date1 As Date
                Dim z As Integer
                Dim M1 As Integer


                x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
                x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"


                Dim n_Count As Integer
                Dim n_Taken As Integer

                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
               "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and M04ETime between '" & x_date & "' and '" & x_date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                n_Count = 0
                n_Taken = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next


                Y = 2
                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = "0"
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(0, 0, 255)


                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Taken / 1440
                range1 = worksheet13.Cells(x, Y)
                worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(255, 0, 0)
                Y = Y + 1


                worksheet13.Cells(x, Y) = (n_Taken / 1440) / n_Count
                range1 = worksheet13.Cells(x, Y)
                worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(148, 0, 211)
                Y = Y + 1

                Dim x1 As Integer
                Dim x2 As Integer
                '  x1 = (24 * 27) & ":00:00"
                ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
                z = Y + 14
                x1 = (24 * 27) * 60
                x2 = n_Taken
                worksheet13.Cells(x, z) = x2 / x1
                range1 = worksheet13.Cells(x, z)
                ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(148, 0, 211)



                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                 "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01') and M04ETime between '" & x_date & "' and '" & x_date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                n_Count = 0
                n_Taken = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))


                    M1 = M1 + 1
                Next


                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = "0"
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(0, 0, 255)


                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Taken / 1440
                range1 = worksheet13.Cells(x, Y)
                worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(255, 0, 0)
                Y = Y + 1


                worksheet13.Cells(x, Y) = (n_Taken / 1440) / n_Count
                range1 = worksheet13.Cells(x, Y)
                worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(148, 0, 211)
                Y = Y + 1

                ' Dim Z As Integer
                z = Y + 6

                ' Dim x1 As Integer
                ' Dim x2 As Integer
                '  x1 = (24 * 27) & ":00:00"
                ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
                'z = Y + 14
                x1 = (24 * 18) * 60
                x2 = n_Taken
                worksheet13.Cells(x, z) = x2 / x1
                ' worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 18)
                range1 = worksheet13.Cells(x, z)
                ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(0, 0, 255)
                ' Y = Y + 1
                '-------------------------------------------------------------------------- AIR FLOW
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
               "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_date & "' and '" & x_date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                n_Count = 0
                n_Taken = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next


                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = "0"
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Count
                range1 = worksheet13.Cells(x, Y)
                range1.NumberFormat = "0"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(0, 0, 255)


                Y = Y + 1

                worksheet13.Cells(x, Y) = n_Taken / 1440
                range1 = worksheet13.Cells(x, Y)
                worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(255, 0, 0)
                Y = Y + 1


                worksheet13.Cells(x, Y) = (n_Taken / 1440) / n_Count
                range1 = worksheet13.Cells(x, Y)
                worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.Font.Color = RGB(148, 0, 211)
                Y = Y + 1



                'Dim Z As Integer
                z = Y + 1

                ' Dim x1 As Integer
                'Dim x2 As Integer
                '  x1 = (24 * 27) & ":00:00"
                ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
                ' z = Y + 14
                x1 = (24 * 9) * 60
                x2 = n_Taken
                worksheet13.Cells(x, z) = x2 / x1
                '  worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 9)
                range1 = worksheet13.Cells(x, z)
                ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
                worksheet13.Rows(x).Font.size = 10
                range1.NumberFormat = "0%"
                range1.Font.Color = RGB(255, 0, 0)


                worksheet13.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet13.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("V" & x & ":V" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet13.Range("V" & x & ":V" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            End If
            x = x + 1
            Y = 1
            i = i + 1
        Next


        '------------------------------------------------------------------------------


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim RH As Double

        RH = (x - 11) * 12.75
        RH = RH + (15 * 8)
        RH = RH + 33.75 + 25
        xlCharts = worksheet13.ChartObjects
        myChart = xlCharts.Add(7, RH, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet13.Range("K11", "K" & (x - 1))
        chartRange1 = worksheet13.Range("A11", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet13.Range("Q11", "Q" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        '  t_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
        '  t_Series.Format.Line.ForeColor.RGB = RGB(255, 0, 0)
        't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
        '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution(no.of boil out)")

        '-----------------------------------------------------------------------------
        'BOIL OUT DISTRIBUTION HOUR
        xlCharts = worksheet13.ChartObjects
        RH = RH + 300
        myChart = xlCharts.Add(7, RH, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet13.Range("L11", "L" & (x - 1))
        chartRange1 = worksheet13.Range("A11", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet13.Range("R11", "R" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution(hours)")
        '-----------------------------------------------------------------------
        'BOIL OUT DISTRIBUTION USAGE%
        xlCharts = worksheet13.ChartObjects
        RH = RH + 300
        myChart = xlCharts.Add(7, RH, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet13.Range("T11", "T" & (x - 1))
        chartRange1 = worksheet13.Range("A11", "A" & (x - 1))
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet13.Range("U11", "U" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)


        chartRange = worksheet13.Range("V11", "V" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "All Dye Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution of (Usage %)")
        '---------------------------------------------------------------------------
        'BOIL OUT HOUR PER BOIL OUT
        xlCharts = worksheet13.ChartObjects
        RH = RH + 300
        myChart = xlCharts.Add(7, RH, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet13.Range("M11", "M" & (x - 1))
        chartRange1 = worksheet13.Range("A11", "A" & (x - 1))
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet13.Range("S11", "S" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)


        chartRange = worksheet13.Range("G11", "G" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "All Dye Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Hours per  Boil out")
    End Function

    Function Weekly_Boilout()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
     

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet14 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet14.Name = "Weekly Boil Out"
        worksheet14.Cells(2, 3) = "Textured Jersey PLC"
        worksheet14.Rows(2).Font.Bold = True
        worksheet14.Rows(2).Font.size = 26
        worksheet14.Range("A2:J2").MergeCells = True
        worksheet14.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet14.Cells(6, 1) = "Boil Outs Performance Data"
        worksheet14.Rows(6).Font.Bold = True
        worksheet14.Rows(6).Font.size = 12
        worksheet14.Rows(6).Font.Name = "Times New Roman"


        worksheet14.Rows(6).rowheight = 20.25
        '---------------------------------------------------------------------
        'page Header
        worksheet14.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet14.Cells(7, 1) = "ALL Dye machine  "
        worksheet14.Rows(7).Font.Bold = True
        worksheet14.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet14.Columns("A").ColumnWidth = 8
        worksheet14.Columns("B").ColumnWidth = 5
        worksheet14.Columns("C").ColumnWidth = 8
        worksheet14.Columns("D").ColumnWidth = 8
        worksheet14.Columns("E").ColumnWidth = 5
        worksheet14.Columns("F").ColumnWidth = 8
        worksheet14.Columns("G").ColumnWidth = 8

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet14.Columns("H").ColumnWidth = 5
        worksheet14.Columns("J").ColumnWidth = 8
        worksheet14.Columns("K").ColumnWidth = 5
        worksheet14.Columns("L").ColumnWidth = 8
        worksheet14.Columns("M").ColumnWidth = 8
        worksheet14.Columns("N").ColumnWidth = 5




        'worksheet13.Columns("H").ColumnWidth = 8
        worksheet14.Columns("O").ColumnWidth = 8
        worksheet14.Columns("P").ColumnWidth = 8
        worksheet14.Columns("Q").ColumnWidth = 5
        worksheet14.Columns("R").ColumnWidth = 8
        worksheet14.Columns("S").ColumnWidth = 8
        worksheet14.Columns("T").ColumnWidth = 8

        worksheet14.Columns("U").ColumnWidth = 10
        worksheet14.Columns("V").ColumnWidth = 10
        worksheet14.Columns("W").ColumnWidth = 10


        worksheet14.Range(worksheet14.Cells(7, 1), worksheet14.Cells(7, 7)).Merge()
        worksheet14.Range(worksheet14.Cells(7, 1), worksheet14.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet14.Cells(7, 1)

        ' range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet1.Cells(7, 3).VerticalAlignment = XlVAlign.xlVAlignCenter
        ' range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(7, 8) = "Water jet machine "
        worksheet14.Rows(7).Font.Bold = True
        worksheet14.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet14.Range("B2:G2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet14.Range(worksheet14.Cells(7, 8), worksheet14.Cells(7, 13)).Merge()
        worksheet14.Range(worksheet14.Cells(7, 8), worksheet14.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet14.Cells(7, 8)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        '   range1.Borders.LineStyle = XlLineStyle.xlContinuous
        worksheet14.Cells(7, 14) = "Air flow machine "
        worksheet14.Rows(7).Font.Bold = True
        worksheet14.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet14.Range("B7:G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet14.Range(worksheet14.Cells(7, 14), worksheet14.Cells(7, 19)).Merge()
        worksheet14.Range(worksheet14.Cells(7, 14), worksheet14.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet14.Cells(7, 14)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous
        For i = 1 To 22
            range1 = worksheet14.Cells(7, i)
            If i > 19 Then
                'Dim borders As Microsoft.Office.Interop.Excel.i
                'borders = worksheet13.Range("A2:J2").Borders
                'borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'borders(XlBordersIndex.xlEdgeBottom).Weight = XlBorderWeight.xlThin
                'Borders(XlBordersIndex.xlEdgeBottom).ColorIndex = 3

                worksheet14.Range("T7", "V7").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet14.Range("T7", "V7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlLineStyleNone
                worksheet14.Range("V7", "V7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet14.Range("U7", "U7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Else
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
            End If

        Next

        ' worksheet13.Cells(8, 1) = "Date"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet14.Rows(8).Font.size = 10

        worksheet14.Cells(8, 2) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet14.Rows(8).Font.size = 10
        worksheet14.Range(worksheet14.Cells(8, 2), worksheet14.Cells(8, 7)).Merge()
        worksheet14.Range(worksheet14.Cells(8, 2), worksheet14.Cells(8, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("B8", "G8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("G8", "G8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(8, 8) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet14.Rows(8).Font.size = 10
        worksheet14.Range(worksheet14.Cells(8, 8), worksheet14.Cells(8, 13)).Merge()
        worksheet14.Range(worksheet14.Cells(8, 8), worksheet14.Cells(8, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("H8", "M8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("M8", "M8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(8, 14) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet14.Rows(8).Font.size = 10
        worksheet14.Range(worksheet14.Cells(8, 14), worksheet14.Cells(8, 19)).Merge()
        worksheet14.Range(worksheet14.Cells(8, 14), worksheet14.Cells(8, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("N8", "S8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("S8", "S8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(8, 20) = "Usage %"
        worksheet14.Cells(8, 20).Font.Bold = True
        worksheet14.Cells(8, 20).Font.size = 11
        worksheet14.Range(worksheet14.Cells(8, 20), worksheet14.Cells(8, 21)).Merge()
        worksheet14.Range("T8", "U8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("U8", "U8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("V8", "V8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Range("A9", "A9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("B9", "B9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("D9", "D9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("C9", "D9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("E9", "E9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("F9", "F9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("G9", "G9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("H9", "H9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("J9", "J9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("K9", "K9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("L9", "L9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("M9", "M9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("N9", "N9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("P9", "P9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("Q9", "Q9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("R9", "R9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("S9", "S9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("T9", "T9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("U9", "U9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("V9", "V9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("I9", "J9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("O9", "P9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Range(worksheet14.Cells(9, 3), worksheet14.Cells(9, 4)).Merge()
        worksheet14.Range(worksheet14.Cells(9, 9), worksheet14.Cells(9, 10)).Merge()
        worksheet14.Range(worksheet14.Cells(9, 15), worksheet14.Cells(9, 16)).Merge()
        worksheet14.Range(worksheet14.Cells(9, 15), worksheet14.Cells(9, 16)).Merge()
        worksheet14.Range(worksheet14.Cells(8, 20), worksheet14.Cells(8, 21)).Merge()
        worksheet14.Range(worksheet14.Cells(7, 20), worksheet14.Cells(7, 21)).Merge()
        worksheet14.Range(worksheet14.Cells(8, 22), worksheet14.Cells(8, 22)).Merge()
        worksheet14.Range("V7", "V8").Merge()
        worksheet14.Range("T7", "T8").Merge()

        worksheet14.Range("A10", "A10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("B10", "B10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("A9", "A11").Merge()
        ' worksheet13.Range("B9", "B11").Merge()
        worksheet14.Range("B10", "B10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("B11", "B11").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("A11", "A11").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Rows("10:10").rowheight = 25

        '---------------------------------------------------------------------------ALL DYE M/C
        worksheet14.Cells(10, 2) = "plan"
        worksheet14.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 2).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 2).Font.size = 10

        worksheet14.Cells(10, 3) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 3).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 3).Font.size = 10

        worksheet14.Cells(10, 3).WrapText = True
        worksheet14.Cells(10, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("C10", "C10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Cells(10, 4) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 4).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 4).Font.size = 10

        worksheet14.Cells(10, 4).WrapText = True
        worksheet14.Cells(10, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("D10", "D10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(10, 5) = "Total"
        worksheet14.Cells(10, 5).Font.Bold = True
        worksheet14.Cells(10, 5).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 5).Font.size = 10

        worksheet14.Cells(10, 5).WrapText = True
        worksheet14.Cells(10, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("E10", "E10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        range1 = worksheet14.Cells(10, 5)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet14.Cells(10, 6) = "total hours"
        worksheet14.Cells(10, 6).Font.Bold = True
        worksheet14.Cells(10, 6).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 6).Font.size = 10

        worksheet14.Cells(10, 6).WrapText = True
        worksheet14.Cells(10, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 6)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet14.Range("F10", "F10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet14.Cells(10, 7) = "hours per boil out"
        worksheet14.Cells(10, 7).Font.Bold = True
        worksheet14.Cells(10, 7).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 7).Font.size = 10

        worksheet14.Cells(10, 7).WrapText = True
        worksheet14.Cells(10, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 7)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet14.Range("G10", "G10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '-----------------------------------------------------------------------------------------------------------WATER JET M/C
        worksheet14.Cells(10, 8) = "plan"
        worksheet14.Cells(10, 8).Font.Bold = True
        worksheet14.Cells(10, 8).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 8).Font.size = 10
        worksheet14.Range("h10", "H10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 9) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 9).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 9).Font.size = 10

        worksheet14.Cells(10, 9).WrapText = True
        worksheet14.Cells(10, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("I10", "I10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(10, 10) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 10).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 10).Font.size = 10

        worksheet14.Cells(10, 10).WrapText = True
        worksheet14.Cells(10, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("J10", "J10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 11) = "Total"
        worksheet14.Cells(10, 11).Font.Bold = True
        worksheet14.Cells(10, 11).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 11).Font.size = 10

        worksheet14.Cells(10, 11).WrapText = True
        worksheet14.Cells(10, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 11)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet14.Range("K10", "K10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 12) = "total hours"
        worksheet14.Cells(10, 12).Font.Bold = True
        worksheet14.Cells(10, 12).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 12).Font.size = 10

        worksheet14.Cells(10, 12).WrapText = True
        worksheet14.Cells(10, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 12)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet14.Range("L10", "L10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 13) = "hours per boil out"
        worksheet14.Cells(10, 13).Font.Bold = True
        worksheet14.Cells(10, 13).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 13).Font.size = 10

        worksheet14.Cells(10, 13).WrapText = True
        worksheet14.Cells(10, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 13)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet14.Range("M10", "M10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '---------------------------------------------------------------------------------------------------------- AIR FLOW M/C
        worksheet14.Cells(10, 14) = "plan"
        worksheet14.Cells(10, 14).Font.Bold = True
        worksheet14.Cells(10, 14).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 14).Font.size = 10
        worksheet14.Range("N10", "N10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 15) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 15).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 15).Font.size = 10

        worksheet14.Cells(10, 15).WrapText = True
        worksheet14.Cells(10, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("O10", "O10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(10, 16) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet14.Cells(10, 16).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 16).Font.size = 10

        worksheet14.Cells(10, 16).WrapText = True
        worksheet14.Cells(10, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet14.Range("P10", "P10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 17) = "Total"
        worksheet14.Cells(10, 17).Font.Bold = True
        worksheet14.Cells(10, 17).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 17).Font.size = 10

        worksheet14.Cells(10, 17).WrapText = True
        worksheet14.Cells(10, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 17)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet14.Range("Q10", "Q10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet14.Cells(10, 18) = "total hours"
        worksheet14.Cells(10, 18).Font.Bold = True
        worksheet14.Cells(10, 18).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 18).Font.size = 10

        worksheet14.Cells(10, 18).WrapText = True
        worksheet14.Cells(10, 18).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 18)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet14.Range("R10", "R10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 19) = "hours per boil out"
        worksheet14.Cells(10, 19).Font.Bold = True
        worksheet14.Cells(10, 19).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 19).Font.size = 10

        worksheet14.Cells(10, 19).WrapText = True
        worksheet14.Cells(10, 19).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 19)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet14.Range("S10", "S10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 20) = "Water jet machine"
        worksheet14.Cells(10, 20).Font.Bold = True
        worksheet14.Cells(10, 20).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 20).Font.size = 10

        worksheet14.Cells(10, 20).WrapText = True
        worksheet14.Cells(10, 20).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 20)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet14.Range("T10", "T10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet14.Cells(10, 21) = "Air flow machine"
        worksheet14.Cells(10, 21).Font.Bold = True
        worksheet14.Cells(10, 21).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 21).Font.size = 10

        worksheet14.Cells(10, 21).WrapText = True
        worksheet14.Cells(10, 21).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 21)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet14.Range("U10", "U10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet14.Cells(10, 22) = "all dye machine"
        worksheet14.Cells(10, 22).Font.Bold = True
        worksheet14.Cells(10, 22).Font.Name = "Times New Roman"
        worksheet14.Cells(10, 22).Font.size = 10

        worksheet14.Cells(10, 22).WrapText = True
        worksheet14.Cells(10, 22).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet14.Cells(10, 22)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet14.Range("V10", "V10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet14.Range("A10", "V10").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        ' worksheet13.Range("B9:B10").Style.Color = Color.Yellow
        ' worksheet13.Range("B9:B10").Style.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
        worksheet14.Range("B9:B10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("E9:E10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("F9:F10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("G9:G10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("H9:H10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("K9:K10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("L9:L10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("M9:M10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("N9:N10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("A9:A10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("Q9:Q10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("R9:R10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("S9:S10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("T9:T10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("U9:U10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("V8:V10").Interior.Color = RGB(255, 255, 255)
        '---------------------------------------------------------------------------------------------------
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"
        worksheet14.Range("U9:U10").Interior.Color = RGB(255, 255, 255)
        worksheet14.Range("V8:V10").Interior.Color = RGB(255, 255, 255)
        '---------------------------------------------------------------------------------------------------
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"

        SQL = "SELECT M04Week,max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' group by m04year,M04Week  order by m04year,M04Week "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 11
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet14.Cells(x, 1) = T01.Tables(0).Rows(i)("M04WeekNo")
            worksheet14.Rows(x).Font.size = 10
            'ALL DYE MACHINE
            'MsgBox(DateAdd("ww", T01.Tables(0).Rows(i)("M04Week") - 1, YearStart(T01.Tables(0).Rows(i)("Eyear"))))
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(DayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim Z As Integer
            Dim n_count As Integer
            Dim n_Taken As Integer
            Dim M1 As Integer

            Y = 2
            SQL = "SELECT max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
         "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02')  and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by m04year  order by m04year"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

            n_count = 0
            n_Taken = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next
            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = "0"
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(0, 0, 255)


            Y = Y + 1

            worksheet14.Cells(x, Y) = n_Taken / 1440
            range1 = worksheet14.Cells(x, Y)
            worksheet14.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(255, 0, 0)
            Y = Y + 1


            worksheet14.Cells(x, Y) = (n_Taken / 1440) / n_count
            range1 = worksheet14.Cells(x, Y)
            worksheet14.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(148, 0, 211)
            Y = Y + 1

            Dim x1 As Integer
            Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            Z = Y + 14
            x1 = (24 * 27 * 7) * 60
            x2 = n_Taken
            worksheet14.Cells(x, Z) = x2 / x1
            range1 = worksheet14.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(148, 0, 211)



            SQL = "SELECT max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE='01' and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by m04year  order by m04year"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '  If isValidDataset(T03) Then
            n_count = 0
            n_Taken = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next
            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = "0"
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(0, 0, 255)


            Y = Y + 1

            worksheet14.Cells(x, Y) = n_Taken / 1440
            range1 = worksheet14.Cells(x, Y)
            worksheet14.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(255, 0, 0)
            Y = Y + 1

            If n_Taken / 1440 = 0 Then
                worksheet14.Cells(x, Y) = "0"
            Else
                worksheet14.Cells(x, Y) = (n_Taken / 1440) / n_count
            End If
            range1 = worksheet14.Cells(x, Y)
            worksheet14.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(148, 0, 211)
            Y = Y + 1

            ' Dim Z As Integer
            Z = Y + 6

            ' Dim x1 As Integer
            'Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            'z = Y + 14
            x1 = (24 * 18 * 7) * 60
            x2 = n_Taken
            worksheet14.Cells(x, Z) = x2 / x1
            ' worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 18)
            range1 = worksheet14.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            ' Y = Y + 1

            '--------------------------------------------------------------------------------------------------------------------
            SQL = "SELECT max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE='02'  and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by m04year  order by m04year"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            ' If isValidDataset(T03) Then
            n_count = 0
            n_Taken = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = "0"
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet14.Cells(x, Y) = n_count
            range1 = worksheet14.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(0, 0, 255)


            Y = Y + 1

            worksheet14.Cells(x, Y) = n_Taken / 1440
            range1 = worksheet14.Cells(x, Y)
            worksheet14.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(255, 0, 0)
            Y = Y + 1


            worksheet14.Cells(x, Y) = (n_Taken / 1440) / n_count
            range1 = worksheet14.Cells(x, Y)
            worksheet14.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.Font.Color = RGB(148, 0, 211)
            Y = Y + 1



            'Dim Z As Integer
            Z = Y + 1

            'Dim x1 As Integer
            'Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            ' z = Y + 14
            x1 = (24 * 9 * 7) * 60
            x2 = n_Taken
            worksheet14.Cells(x, Z) = x2 / x1
            '  worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 9)
            range1 = worksheet14.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet14.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(255, 0, 0)
            ' Y = Y + 1

            worksheet14.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet14.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("V" & x & ":V" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet14.Range("V" & x & ":V" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            x = x + 1
            i = i + 1
        Next



        Dim _Chartlocation As Integer

        _Chartlocation = (x + 15) * 10



        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim rh As Double

        rh = (x - 4) * 15
        rh = rh + (33.75 + 15)
        xlCharts = worksheet14.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet14.Range("K11", "K" & (x - 1))
        chartRange1 = worksheet14.Range("A11", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet14.Range("Q11", "Q" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        '  t_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
        '  t_Series.Format.Line.ForeColor.RGB = RGB(255, 0, 0)
        't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
        '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution(no.of boil out)")

        _Chartlocation = _Chartlocation + 350
        'BOIL OUT DISTRIBUTION HOUR
        rh = rh + 300
        xlCharts = worksheet14.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet14.Range("L11", "L" & (x - 1))
        chartRange1 = worksheet14.Range("A11", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet14.Range("R11", "R" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution(hours)")
        '-----------------------------------------------------------------------
        _Chartlocation = _Chartlocation + 360
        rh = rh + 300
        xlCharts = worksheet14.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet14.Range("T11", "T" & (x - 1))
        chartRange1 = worksheet14.Range("A11", "A" & (x - 1))
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet14.Range("U11", "U" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)


        chartRange = worksheet14.Range("V11", "V" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "All Dye Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution of (Usage %)")
        '--------------------------------------------------------------------------------
        'BOIL OUT HOUR PER BOIL OUT

        _Chartlocation = _Chartlocation + 360
        rh = rh + 300
        xlCharts = worksheet14.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet14.Range("M11", "M" & (x - 1))
        chartRange1 = worksheet14.Range("A11", "A" & (x - 1))
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet14.Range("S11", "S" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)


        chartRange = worksheet14.Range("G11", "G" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "All Dye Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Hours per  Boil out")

        worksheet14.Rows(11).Select()
        worksheet14.Application.ActiveWindow.FreezePanes = True
    End Function

    Function Monthly_BoilOut()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)


        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet15 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet15.Name = "Monthly Boil Out"
        worksheet15.Cells(2, 3) = "Textured Jersey PLC"
        worksheet15.Rows(2).Font.Bold = True
        worksheet15.Rows(2).Font.size = 26
        worksheet15.Range("A2:J2").MergeCells = True
        worksheet15.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet15.Cells(6, 1) = "Boil Outs Performance Data"
        worksheet15.Rows(6).Font.Bold = True
        worksheet15.Rows(6).Font.size = 12
        worksheet15.Rows(6).Font.Name = "Times New Roman"


        worksheet15.Rows(6).rowheight = 20.25
        '---------------------------------------------------------------------
        'page Header
        worksheet15.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet15.Cells(7, 1) = "ALL Dye machine  "
        worksheet15.Rows(7).Font.Bold = True
        worksheet15.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet15.Columns("A").ColumnWidth = 8
        worksheet15.Columns("B").ColumnWidth = 5
        worksheet15.Columns("C").ColumnWidth = 8
        worksheet15.Columns("D").ColumnWidth = 8
        worksheet15.Columns("E").ColumnWidth = 5
        worksheet15.Columns("F").ColumnWidth = 8
        worksheet15.Columns("G").ColumnWidth = 8

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet15.Columns("H").ColumnWidth = 5
        worksheet15.Columns("J").ColumnWidth = 8
        worksheet15.Columns("K").ColumnWidth = 5
        worksheet15.Columns("L").ColumnWidth = 8
        worksheet15.Columns("M").ColumnWidth = 8
        worksheet15.Columns("N").ColumnWidth = 5




        'worksheet13.Columns("H").ColumnWidth = 8
        worksheet15.Columns("O").ColumnWidth = 8
        worksheet15.Columns("P").ColumnWidth = 8
        worksheet15.Columns("Q").ColumnWidth = 5
        worksheet15.Columns("R").ColumnWidth = 8
        worksheet15.Columns("S").ColumnWidth = 8
        worksheet15.Columns("T").ColumnWidth = 8

        worksheet15.Columns("U").ColumnWidth = 10
        worksheet15.Columns("V").ColumnWidth = 10
        worksheet15.Columns("W").ColumnWidth = 10


        worksheet15.Range(worksheet15.Cells(7, 1), worksheet15.Cells(7, 7)).Merge()
        worksheet15.Range(worksheet15.Cells(7, 1), worksheet15.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet15.Cells(7, 1)

        ' range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet1.Cells(7, 3).VerticalAlignment = XlVAlign.xlVAlignCenter
        ' range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(7, 8) = "Water jet machine "
        worksheet15.Rows(7).Font.Bold = True
        worksheet15.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet15.Range("B2:G2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet15.Range(worksheet15.Cells(7, 8), worksheet15.Cells(7, 13)).Merge()
        worksheet15.Range(worksheet15.Cells(7, 8), worksheet15.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet15.Cells(7, 8)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        '   range1.Borders.LineStyle = XlLineStyle.xlContinuous
        worksheet15.Cells(7, 14) = "Air flow machine "
        worksheet15.Rows(7).Font.Bold = True
        worksheet15.Rows(7).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet15.Range("B7:G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet15.Range(worksheet15.Cells(7, 14), worksheet15.Cells(7, 19)).Merge()
        worksheet15.Range(worksheet15.Cells(7, 14), worksheet15.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet15.Cells(7, 14)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous
        For i = 1 To 22
            range1 = worksheet15.Cells(7, i)
            If i > 19 Then
                'Dim borders As Microsoft.Office.Interop.Excel.i
                'borders = worksheet13.Range("A2:J2").Borders
                'borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'borders(XlBordersIndex.xlEdgeBottom).Weight = XlBorderWeight.xlThin
                'Borders(XlBordersIndex.xlEdgeBottom).ColorIndex = 3

                worksheet15.Range("T7", "V7").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet15.Range("T7", "V7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlLineStyleNone
                worksheet15.Range("V7", "V7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet15.Range("U7", "U7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Else
                range1.Borders.LineStyle = XlLineStyle.xlContinuous
            End If

        Next

        ' worksheet13.Cells(8, 1) = "Date"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet15.Rows(8).Font.size = 10

        worksheet15.Cells(8, 2) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet15.Rows(8).Font.size = 10
        worksheet15.Range(worksheet15.Cells(8, 2), worksheet15.Cells(8, 7)).Merge()
        worksheet15.Range(worksheet15.Cells(8, 2), worksheet15.Cells(8, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("B8", "G8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("G8", "G8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(8, 8) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet15.Rows(8).Font.size = 10
        worksheet15.Range(worksheet15.Cells(8, 8), worksheet15.Cells(8, 13)).Merge()
        worksheet15.Range(worksheet15.Cells(8, 8), worksheet15.Cells(8, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("H8", "M8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("M8", "M8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(8, 14) = "# of Boil Outs"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet15.Rows(8).Font.size = 10
        worksheet15.Range(worksheet15.Cells(8, 14), worksheet15.Cells(8, 19)).Merge()
        worksheet15.Range(worksheet15.Cells(8, 14), worksheet15.Cells(8, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet13.Range("A8", "A8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("N8", "S8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("S8", "S8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(8, 20) = "Usage %"
        worksheet15.Cells(8, 20).Font.Bold = True
        worksheet15.Cells(8, 20).Font.size = 11
        worksheet15.Range(worksheet15.Cells(8, 20), worksheet15.Cells(8, 21)).Merge()
        worksheet15.Range("T8", "U8").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("U8", "U8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("V8", "V8").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Range("A9", "A9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("B9", "B9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("D9", "D9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("C9", "D9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("E9", "E9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("F9", "F9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("G9", "G9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("H9", "H9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("J9", "J9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("K9", "K9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("L9", "L9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("M9", "M9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("N9", "N9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("P9", "P9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("Q9", "Q9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("R9", "R9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("S9", "S9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("T9", "T9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("U9", "U9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("V9", "V9").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("I9", "J9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("O9", "P9").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Range(worksheet15.Cells(9, 3), worksheet15.Cells(9, 4)).Merge()
        worksheet15.Range(worksheet15.Cells(9, 9), worksheet15.Cells(9, 10)).Merge()
        worksheet15.Range(worksheet15.Cells(9, 15), worksheet15.Cells(9, 16)).Merge()
        worksheet15.Range(worksheet15.Cells(9, 15), worksheet15.Cells(9, 16)).Merge()
        worksheet15.Range(worksheet15.Cells(8, 20), worksheet15.Cells(8, 21)).Merge()
        worksheet15.Range(worksheet15.Cells(7, 20), worksheet15.Cells(7, 21)).Merge()
        worksheet15.Range(worksheet15.Cells(8, 22), worksheet15.Cells(8, 22)).Merge()
        worksheet15.Range("V7", "V8").Merge()
        worksheet15.Range("T7", "T8").Merge()

        worksheet15.Range("A10", "A10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("B10", "B10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("A9", "A11").Merge()
        ' worksheet13.Range("B9", "B11").Merge()
        worksheet15.Range("B10", "B10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("B11", "B11").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet13.Range("A11", "A11").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Rows("10:10").rowheight = 25

        '---------------------------------------------------------------------------ALL DYE M/C
        worksheet15.Cells(10, 2) = "plan"
        worksheet15.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 2).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 2).Font.size = 10

        worksheet15.Cells(10, 3) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 3).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 3).Font.size = 10

        worksheet15.Cells(10, 3).WrapText = True
        worksheet15.Cells(10, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("C10", "C10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Cells(10, 4) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 4).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 4).Font.size = 10

        worksheet15.Cells(10, 4).WrapText = True
        worksheet15.Cells(10, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("D10", "D10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(10, 5) = "Total"
        worksheet15.Cells(10, 5).Font.Bold = True
        worksheet15.Cells(10, 5).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 5).Font.size = 10

        worksheet15.Cells(10, 5).WrapText = True
        worksheet15.Cells(10, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("E10", "E10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        range1 = worksheet15.Cells(10, 5)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet15.Cells(10, 6) = "total hours"
        worksheet15.Cells(10, 6).Font.Bold = True
        worksheet15.Cells(10, 6).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 6).Font.size = 10

        worksheet15.Cells(10, 6).WrapText = True
        worksheet15.Cells(10, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 6)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet15.Range("F10", "F10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet15.Cells(10, 7) = "hours per boil out"
        worksheet15.Cells(10, 7).Font.Bold = True
        worksheet15.Cells(10, 7).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 7).Font.size = 10

        worksheet15.Cells(10, 7).WrapText = True
        worksheet15.Cells(10, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 7)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet15.Range("G10", "G10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '-----------------------------------------------------------------------------------------------------------WATER JET M/C
        worksheet15.Cells(10, 8) = "plan"
        worksheet15.Cells(10, 8).Font.Bold = True
        worksheet15.Cells(10, 8).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 8).Font.size = 10
        worksheet15.Range("h10", "H10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 9) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 9).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 9).Font.size = 10

        worksheet15.Cells(10, 9).WrapText = True
        worksheet15.Cells(10, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("I10", "I10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(10, 10) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 10).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 10).Font.size = 10

        worksheet15.Cells(10, 10).WrapText = True
        worksheet15.Cells(10, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("J10", "J10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 11) = "Total"
        worksheet15.Cells(10, 11).Font.Bold = True
        worksheet15.Cells(10, 11).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 11).Font.size = 10

        worksheet15.Cells(10, 11).WrapText = True
        worksheet15.Cells(10, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 11)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet15.Range("K10", "K10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 12) = "total hours"
        worksheet15.Cells(10, 12).Font.Bold = True
        worksheet15.Cells(10, 12).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 12).Font.size = 10

        worksheet15.Cells(10, 12).WrapText = True
        worksheet15.Cells(10, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 12)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet15.Range("L10", "L10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 13) = "hours per boil out"
        worksheet15.Cells(10, 13).Font.Bold = True
        worksheet15.Cells(10, 13).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 13).Font.size = 10

        worksheet15.Cells(10, 13).WrapText = True
        worksheet15.Cells(10, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 13)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet15.Range("M10", "M10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '---------------------------------------------------------------------------------------------------------- AIR FLOW M/C
        worksheet15.Cells(10, 14) = "plan"
        worksheet15.Cells(10, 14).Font.Bold = True
        worksheet15.Cells(10, 14).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 14).Font.size = 10
        worksheet15.Range("N10", "N10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 15) = "chemical boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 15).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 15).Font.size = 10

        worksheet15.Cells(10, 15).WrapText = True
        worksheet15.Cells(10, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("O10", "O10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(10, 16) = "fabric boil out"
        'worksheet13.Cells(10, 2).Font.Bold = True
        worksheet15.Cells(10, 16).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 16).Font.size = 10

        worksheet15.Cells(10, 16).WrapText = True
        worksheet15.Cells(10, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet15.Range("P10", "P10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 17) = "Total"
        worksheet15.Cells(10, 17).Font.Bold = True
        worksheet15.Cells(10, 17).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 17).Font.size = 10

        worksheet15.Cells(10, 17).WrapText = True
        worksheet15.Cells(10, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 17)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet15.Range("Q10", "Q10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet15.Cells(10, 18) = "total hours"
        worksheet15.Cells(10, 18).Font.Bold = True
        worksheet15.Cells(10, 18).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 18).Font.size = 10

        worksheet15.Cells(10, 18).WrapText = True
        worksheet15.Cells(10, 18).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 18)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet15.Range("R10", "R10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 19) = "hours per boil out"
        worksheet15.Cells(10, 19).Font.Bold = True
        worksheet15.Cells(10, 19).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 19).Font.size = 10

        worksheet15.Cells(10, 19).WrapText = True
        worksheet15.Cells(10, 19).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 19)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet15.Range("S10", "S10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 20) = "Water jet machine"
        worksheet15.Cells(10, 20).Font.Bold = True
        worksheet15.Cells(10, 20).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 20).Font.size = 10

        worksheet15.Cells(10, 20).WrapText = True
        worksheet15.Cells(10, 20).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 20)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet15.Range("T10", "T10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet15.Cells(10, 21) = "Air flow machine"
        worksheet15.Cells(10, 21).Font.Bold = True
        worksheet15.Cells(10, 21).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 21).Font.size = 10

        worksheet15.Cells(10, 21).WrapText = True
        worksheet15.Cells(10, 21).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 21)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet15.Range("U10", "U10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet15.Cells(10, 22) = "all dye machine"
        worksheet15.Cells(10, 22).Font.Bold = True
        worksheet15.Cells(10, 22).Font.Name = "Times New Roman"
        worksheet15.Cells(10, 22).Font.size = 10

        worksheet15.Cells(10, 22).WrapText = True
        worksheet15.Cells(10, 22).HorizontalAlignment = XlHAlign.xlHAlignCenter

        range1 = worksheet15.Cells(10, 22)
        range1.Font.Color = RGB(148, 0, 211)
        worksheet15.Range("V10", "V10").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet15.Range("A10", "V10").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        ' worksheet13.Range("B9:B10").Style.Color = Color.Yellow
        ' worksheet13.Range("B9:B10").Style.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.Yellow)
        worksheet15.Range("B9:B10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("E9:E10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("F9:F10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("G9:G10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("H9:H10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("K9:K10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("L9:L10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("M9:M10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("N9:N10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("A9:A10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("Q9:Q10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("R9:R10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("S9:S10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("T9:T10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("U9:U10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("V8:V10").Interior.Color = RGB(255, 255, 255)
        '---------------------------------------------------------------------------------------------------
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"
        worksheet15.Range("U9:U10").Interior.Color = RGB(255, 255, 255)
        worksheet15.Range("V8:V10").Interior.Color = RGB(255, 255, 255)
        '---------------------------------------------------------------------------------------------------
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Month as M04WeekNo,year(M04Date_Out) as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' group by year(M04Date_Out),M04Month  order by year(M04Date_Out),M04Month "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 11
        Dim L_DateofMonth As Integer
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("M04WeekNo") & "/1/" & T01.Tables(0).Rows(i)("eYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            ' N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet15.Cells(x, 1) = MonthName(T01.Tables(0).Rows(i)("M04WeekNo"), True) & "-" & T01.Tables(0).Rows(i)("eYear")
            ' worksheet15.Cells(x, 1) = T01.Tables(0).Rows(i)("M04WeekNo") & "-" & T01.Tables(0).Rows(i)("Eyear")
            worksheet15.Rows(x).Font.size = 10
            'ALL DYE MACHINE

            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = T01.Tables(0).Rows(i)("M04WeekNo") & "/1/" & T01.Tables(0).Rows(i)("eYear")

            ' Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = StartdateofYear
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            Dim daysInFeb As Integer = System.DateTime.DaysInMonth(T01.Tables(0).Rows(i)("Eyear"), T01.Tables(0).Rows(i)("M04WeekNo"))
            WeekEnddate = CDate(StartdateofYear).AddDays(+daysInFeb)
            ' WeekEnddate = CDate(WeekStartdate).AddDays(+1)
            ' WeekStartdate = CDate(StartdateofYear).AddDays(-1)
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim Z As Integer
            Y = 2
            SQL = "SELECT year(M04Date_Out) as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
         "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and   M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by year(M04Date_Out) order by year(M04Date_Out)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            ' If isValidDataset(T03) Then
            Dim n_count As Integer
            Dim n_Taken As Integer
            Dim M1 As Integer
            n_count = 0
            n_Taken = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next
            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = "0"
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(0, 0, 255)


            Y = Y + 1

            worksheet15.Cells(x, Y) = n_Taken / 1440
            range1 = worksheet15.Cells(x, Y)
            worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(255, 0, 0)
            Y = Y + 1

            If (n_Taken / 1440) < 0 Then
                worksheet15.Cells(x, Y) = "0"
            Else
                worksheet15.Cells(x, Y) = (n_Taken / 1440) / n_count
            End If
            range1 = worksheet15.Cells(x, Y)
            worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(148, 0, 211)
            Y = Y + 1

            Dim x1 As Integer
            Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            Z = Y + 14
            x1 = (24 * 27 * L_DateofMonth) * 60
            x2 = n_Taken
            worksheet15.Cells(x, Z) = x2 / x1
            range1 = worksheet15.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(148, 0, 211)

            'End If

            SQL = "SELECT year(M04Date_Out) as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE='01'  and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by year(M04Date_Out)  order by year(M04Date_Out)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'If isValidDataset(T03) Then
            n_count = 0
            n_Taken = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next
            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = "0"
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(0, 0, 255)


            Y = Y + 1

            worksheet15.Cells(x, Y) = n_Taken / 1440
            range1 = worksheet15.Cells(x, Y)
            worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(255, 0, 0)
            Y = Y + 1


            If (n_Taken / 1440) < 0 Then
                worksheet15.Cells(x, Y) = "0"
            Else
                worksheet15.Cells(x, Y) = (n_Taken / 1440) / n_count
            End If
            range1 = worksheet15.Cells(x, Y)
            worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(148, 0, 211)
            Y = Y + 1

            ' Dim Z As Integer
            Z = Y + 6

            ' Dim x1 As Integer
            'Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            'z = Y + 14
            x1 = (24 * 18 * L_DateofMonth) * 60
            x2 = n_Taken
            worksheet15.Cells(x, Z) = x2 / x1
            ' worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 18)
            range1 = worksheet15.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            ' Y = Y + 1
            'Else
            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'range1.Font.Color = RGB(0, 0, 255)

            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            'worksheet15.Rows(x).Font.size = 10
            'range1.Font.Color = RGB(255, 0, 0)
            'Y = Y + 1


            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            'worksheet15.Rows(x).Font.size = 10
            'range1.Font.Color = RGB(148, 0, 211)
            'Y = Y + 1



            Z = Y + 6

            '    Dim x1 As Integer
            '   Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            'z = Y + 14
            x1 = (24 * 18 * L_DateofMonth) * 60
            x2 = n_Taken
            If x2 = 0 Then
                worksheet15.Cells(x, Z) = "0"
            Else

                worksheet15.Cells(x, Z) = x2 / x1
            End If
            ' worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 18)
            range1 = worksheet15.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            ' End If
            '--------------------------------------------------------------------------------------------------------------------
            SQL = "SELECT year(M04Date_Out) as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE='02'  and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by year(M04Date_Out)  order by year(M04Date_Out)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            ' If isValidDataset(T03) Then


            n_count = 0
            n_Taken = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = "0"
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            Y = Y + 1

            worksheet15.Cells(x, Y) = n_count
            range1 = worksheet15.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(0, 0, 255)


            Y = Y + 1

            worksheet15.Cells(x, Y) = n_Taken / 1440
            range1 = worksheet15.Cells(x, Y)
            worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(255, 0, 0)
            Y = Y + 1


            If (n_Taken / 1440) < 0 Then
                worksheet15.Cells(x, Y) = "0"
            Else
                worksheet15.Cells(x, Y) = (n_Taken / 1440) / n_count
            End If
            range1 = worksheet15.Cells(x, Y)
            worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.Font.Color = RGB(148, 0, 211)
            Y = Y + 1



            'Dim Z As Integer
            Z = Y + 1

            '  Dim x1 As Integer
            ' Dim x2 As Integer
            '  x1 = (24 * 27) & ":00:00"
            ' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            ' z = Y + 14
            x1 = (24 * 9 * L_DateofMonth) * 60
            x2 = n_Taken
            worksheet15.Cells(x, Z) = x2 / x1
            '  worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 9)
            range1 = worksheet15.Cells(x, Z)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet15.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(255, 0, 0)
            ' Y = Y + 1
            'Else
            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'range1.NumberFormat = "0"
            'worksheet15.Rows(x).Font.size = 10
            'range1.Font.Color = RGB(0, 0, 255)


            'Y = Y + 1

            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            'worksheet15.Rows(x).Font.size = 10
            'range1.Font.Color = RGB(255, 0, 0)
            'Y = Y + 1


            'worksheet15.Cells(x, Y) = "0"
            'range1 = worksheet15.Cells(x, Y)
            'worksheet15.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            'worksheet15.Rows(x).Font.size = 10
            'range1.Font.Color = RGB(148, 0, 211)
            'Y = Y + 1


            'Z = Y + 1

            'Dim x1 As Integer
            'Dim x2 As Integer
            ''  x1 = (24 * 27) & ":00:00"
            '' x2 = ((T01.Tables(0).Rows(0)("Taken")) * 1440) & ":00:00"
            '' z = Y + 14
            'x1 = (24 * 9 * L_DateofMonth) * 60
            'x2 = 0
            'worksheet15.Cells(x, Z) = x2 / x1
            ''  worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 9)
            'range1 = worksheet15.Cells(x, Z)
            '' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            'worksheet15.Rows(x).Font.size = 10
            'range1.NumberFormat = "0%"
            'range1.Font.Color = RGB(255, 0, 0)
            'End If
            worksheet15.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet15.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("V" & x & ":V" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet15.Range("V" & x & ":V" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next



        Dim _Chartlocation As Integer
        Dim rh As Double
        _Chartlocation = (x + 15) * 10


        rh = (x - 4) * 15
        rh = rh + 33.75
        rh = rh + 25
        rh = rh + 20.25
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet15.ChartObjects
        rh = rh - 2
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet15.Range("K11", "K" & (x - 1))
        chartRange1 = worksheet15.Range("A11", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet15.Range("Q11", "Q" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        '  t_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
        '  t_Series.Format.Line.ForeColor.RGB = RGB(255, 0, 0)
        't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
        '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution(no.of boil out)")

        _Chartlocation = _Chartlocation + 350
        'BOIL OUT DISTRIBUTION HOUR
        rh = rh + 350
        rh = rh - 50
        xlCharts = worksheet15.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet15.Range("L11", "L" & (x - 1))
        chartRange1 = worksheet15.Range("A11", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet15.Range("R11", "R" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution(hours)")
        '-----------------------------------------------------------------------
        _Chartlocation = _Chartlocation + 360
        rh = rh + 300
        xlCharts = worksheet15.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet15.Range("T11", "T" & (x - 1))
        chartRange1 = worksheet15.Range("A11", "A" & (x - 1))
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet15.Range("U11", "U" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)


        chartRange = worksheet15.Range("V11", "V" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "All Dye Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Boil out Distribution of (Usage %)")
        '--------------------------------------------------------------------------------
        'BOIL OUT HOUR PER BOIL OUT

        _Chartlocation = _Chartlocation + 360
        rh = rh + 300
        xlCharts = worksheet15.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet15.Range("M11", "M" & (x - 1))
        chartRange1 = worksheet15.Range("A11", "A" & (x - 1))
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        ' t_SerCol = chartPage.SeriesCollection
        't_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet15.Range("S11", "S" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)


        chartRange = worksheet15.Range("G11", "G" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "All Dye Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Hours per  Boil out")

        worksheet15.Rows(11).Select()
        worksheet15.Application.ActiveWindow.FreezePanes = True
    End Function

    Function Daily_Efficincy()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet16 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet16.Name = "Daily efficiency"
        worksheet16.Cells(2, 3) = "Textured Jersey PLC"
        worksheet16.Rows(2).Font.Bold = True
        worksheet16.Rows(2).Font.size = 26
        worksheet16.Range("A2:J2").MergeCells = True
        worksheet16.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet16.Cells(4, 1) = "% Daily dyeing efficiency report"
        worksheet16.Rows(4).Font.Bold = True
        worksheet16.Rows(4).Font.size = 12


        worksheet16.Rows(6).rowheight = 28.25

        worksheet16.Rows(6).Font.Bold = True
        ' worksheet16.Rows(6).Font.size = 12



        worksheet16.Cells(6).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet16.Cells(6, 2) = "Air flow machine "
        worksheet16.Rows(6).Font.Bold = True
        worksheet16.Rows(6).Font.size = 11

        worksheet16.Cells(6, 2).WrapText = True
        worksheet16.Cells(6, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        ' worksheet16.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet16.Cells(6, 3) = "Water jet machine "
        worksheet16.Rows(6).Font.Bold = True
        worksheet16.Rows(6).Font.size = 11

        worksheet16.Cells(6, 3).WrapText = True
        worksheet16.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet16.Cells(6, 4) = "Average "
        worksheet16.Rows(6).Font.Bold = True
        worksheet16.Rows(6).Font.size = 11

        worksheet16.Cells(6, 4).WrapText = True
        worksheet16.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet16.Columns("B").ColumnWidth = 12
        worksheet16.Columns("C").ColumnWidth = 12
        worksheet16.Columns("D").ColumnWidth = 12

        worksheet16.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("c6", "C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet16.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet16.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet16.Range("V7", "V7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet16.Range("B").ColumnWidth = 12


        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-daysInFeb)
        n_Date = n_Date & " " & "7:30AM"
        n_Date = CDate(n_Date).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"
        '  N_Date1 = CDate(N_Date1).AddDays(+1)
        ' SQL = ""
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 7
        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120) AS Ddate FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType<>'I' AND " & _
                 " M04ETIME BETWEEN '" & n_Date & "' AND '" & N_Date1 & "'  GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120) order by CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet16.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet16.Cells(x, 1).EntireColumn.NumberFormat = "dd-MMM"
            worksheet16.Rows(x).Font.size = 10
            Dim N_TOTAL As Integer
            Dim N_STD As Integer

            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer

            Y = 2
            x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"
            N_TOTAL = 0
            N_STD = 0
            M1 = 0
            SQL = "SELECT M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY M04ProgrameType"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                Else
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                End If
                M1 = M1 + 1
            Next

            M1 = 0
            Dim M2 As Integer
            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '       "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '       " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"

            Dim N_STD1 As Integer
            Dim N_STD2 As Integer

            N_STD1 = 0
            N_STD2 = 0
            SQL = "SELECT M04Lotno,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                   "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') " & _
                   " GROUP BY M04Lotno having count(M04Lotno)>1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                SQL = "SELECT M04Lotno,M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' "
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M2 = 0
                For Each DTRow5 As DataRow In T04.Tables(0).Rows
                    If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                    Else
                        N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                        N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                    End If
                    M2 = M2 + 1
                Next

                M1 = M1 + 1
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            worksheet16.Cells(x, Y) = N_STD / N_TOTAL
            range1 = worksheet16.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet16.Rows(x).Font.size = 10

            Y = Y + 1

            N_TOTAL = 0
            N_STD = 0
            M1 = 0
            SQL = "SELECT M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') GROUP BY M04ProgrameType"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                Else
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                End If
                M1 = M1 + 1
            Next

            M1 = 0
            N_STD1 = 0
            N_STD2 = 0
            '    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '"INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '" M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"
            '    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

            SQL = "SELECT M04Lotno,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                   "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') " & _
                   " GROUP BY M04Lotno having count(M04Lotno)>1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                SQL = "SELECT M04Lotno,M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "'"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M2 = 0
                For Each DTRow5 As DataRow In T04.Tables(0).Rows
                    If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                    Else

                        N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                        N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                    End If
                    M2 = M2 + 1
                Next

                M1 = M1 + 1
            Next

            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            worksheet16.Cells(x, Y) = N_STD / N_TOTAL
            range1 = worksheet16.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet16.Rows(x).Font.size = 10

            N_TOTAL = 0
            N_STD = 0
            M1 = 0
            Y = Y + 1
            SQL = "SELECT M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01','02') GROUP BY M04ProgrameType"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                Else
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                End If
                M1 = M1 + 1
            Next

            M1 = 0
            '    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '"INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '" M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"
            '    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            N_STD1 = 0
            N_STD2 = 0
            SQL = "SELECT M04Lotno,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                   "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01','02') " & _
                   " GROUP BY M04Lotno having count(M04Lotno)>1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                SQL = "SELECT M04Lotno,M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01','02') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' "
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M2 = 0
                For Each DTRow5 As DataRow In T04.Tables(0).Rows
                    If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                    Else

                        N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                        N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                    End If
                    M2 = M2 + 1
                Next

                M1 = M1 + 1
            Next

            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            worksheet16.Cells(x, Y) = N_STD / N_TOTAL
            range1 = worksheet16.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet16.Rows(x).Font.size = 10


            worksheet16.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("c" & x, "C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet16.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet16.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            x = x + 1
            i = i + 1
        Next
        'DRAW CHART ------------------------------------------------------------>>>


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim rh As Double

        rh = (x - 7) * 12.75
        rh = rh + (15 * 3) + 15.75 + 28.25 + 33.75
        xlCharts = worksheet16.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1
        chartRange = worksheet16.Range("C7", "C" & (x - 1))
        chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet16.Range("B7", "B" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        '  t_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
        '  t_Series.Format.Line.ForeColor.RGB = RGB(255, 0, 0)
        't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
        '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

        chartRange = worksheet16.Range("D7", "D" & (x - 1))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Avarage"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'Next
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Daily efficiency")

    End Function

    Function Weekly_efficincy()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet17 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet17.Name = "Weekly efficiency"
        worksheet17.Cells(2, 3) = "Textured Jersey PLC"
        worksheet17.Rows(2).Font.Bold = True
        worksheet17.Rows(2).Font.size = 26
        worksheet17.Range("A2:J2").MergeCells = True
        worksheet17.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet17.Cells(4, 1) = "% Weekly dyeing efficiency report"
        worksheet17.Rows(4).Font.Bold = True
        worksheet17.Rows(4).Font.size = 12


        worksheet17.Rows(6).rowheight = 28.25

        worksheet17.Rows(6).Font.Bold = True
        ' worksheet16.Rows(6).Font.size = 12



        worksheet17.Cells(6).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet17.Cells(6, 2) = "Air flow machine "
        worksheet17.Rows(6).Font.Bold = True
        worksheet17.Rows(6).Font.size = 11

        worksheet17.Cells(6, 2).WrapText = True
        worksheet17.Cells(6, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        ' worksheet16.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet17.Cells(6, 3) = "Water jet machine "
        worksheet17.Rows(6).Font.Bold = True
        worksheet17.Rows(6).Font.size = 11

        worksheet17.Cells(6, 3).WrapText = True
        worksheet17.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet17.Cells(6, 4) = "Average "
        worksheet17.Rows(6).Font.Bold = True
        worksheet17.Rows(6).Font.size = 11

        worksheet17.Cells(6, 4).WrapText = True
        worksheet17.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet17.Columns("B").ColumnWidth = 12
        worksheet17.Columns("C").ColumnWidth = 12
        worksheet17.Columns("D").ColumnWidth = 12

        worksheet17.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("c6", "C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet17.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet17.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        'daysInFeb = DateDiff("d", CDate("1/1/" & Year(dat)), dat) + 1
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        '  n_Date = CDate(n_Date).AddDays(-1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"
        '  N_Di=i+1ate1 = CDate(N_Date1).AddDays(+1)
        ' SQL = ""
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 7
        '  Overall_IAFFAF = 0
        SQL = "SELECT max(M04WeekNo) AS Ddate,M04Week ,m04Year as Eyear FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType<>'I' AND " & _
                 " M04ETIME BETWEEN '" & n_Date & "' AND '" & N_Date1 & "'  GROUP BY m04Year,M04Week order by m04Year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet17.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            'worksheet17.Cells(x, 1).EntireColumn.NumberFormat = "dd-MMM"
            worksheet17.Rows(x).Font.size = 10
            Dim N_TOTAL As Integer
            Dim N_STD As Integer

            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer

            Y = 2
            Dim txtYear As String
            Dim tmpDate As Date
            Dim Ydate As Integer
            Dim N_STD1 As Integer
            Dim N_STD2 As Integer

            Ydate = T01.Tables(0).Rows(i)("M04week")
            Ydate = Ydate * 7
            txtYear = (T01.Tables(0).Rows(i)("Eyear"))

            tmpDate = "1/1/" & txtYear
            x_date = CDate(tmpDate).AddDays(+Ydate)
            'tmpDate = System.DateTime.FromOADate(CDate("01/01/" & txtYear).ToOADate - Weekday(CDate("01/01/" & txtYear), FirstDayOfWeek.Monday) + 1)

            If T01.Tables(0).Rows(i)("M04Week") = "1" Then
                x_date = "1/1/" & txtYear
            Else
                x_date = CDate(tmpDate).AddDays(+Ydate)
            End If
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(x_date)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                x_date = CDate(x_date).AddDays(-6)
            ElseIf dayName = "Tuesday" Then
                x_date = CDate(x_date).AddDays(-8)
            ElseIf dayName = "Wednesday" Then
                x_date = CDate(x_date).AddDays(-9)
            ElseIf dayName = "Thuesday" Then
                x_date = CDate(x_date).AddDays(-10)
            ElseIf dayName = "Friday" Then
                x_date = CDate(x_date).AddDays(-11)
            ElseIf dayName = "Saturday" Then
                x_date = CDate(x_date).AddDays(-12)
            End If
            x_date1 = CDate(x_date).AddDays(+7)
            If x_date1 > txtTodate.Value Then
                'WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            x_date = x_date & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"


            N_TOTAL = 0
            N_STD = 0
            N_STD1 = 0
            N_STD2 = 0
            M1 = 0
            SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType order by CONVERT(VARCHAR(10) , M04Date_Out, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                Else
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                End If
                M1 = M1 + 1
            Next

            M1 = 0
            Dim M2 As Integer
            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '       "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '       " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"

            SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120) as Ddate,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                   "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') " & _
                   " GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04Lotno having count(M04Lotno)>1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                Dim A1 As Date
                Dim A2 As Date

                SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
                  "  T03TYPE IN ('02') and M04ProgrameType not in ('E','i') AND M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND M04Date_Out='" & T03.Tables(0).Rows(M1)("Ddate") & "'"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M2 = 0
                For Each DTRow5 As DataRow In T04.Tables(0).Rows
                    If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                    Else
                        N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                        N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                    End If
                    M2 = M2 + 1
                Next

                M1 = M1 + 1
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            If N_STD = 0 And N_TOTAL = 0 Then
                worksheet17.Cells(x, Y) = "0"
            Else
                ' worksheet17.Cells(x, Y) = (N_STD / N_TOTAL)
                If (N_STD / N_TOTAL) < 1 Then
                    worksheet17.Cells(x, Y) = (N_STD / N_TOTAL)
                Else
                    'worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                    worksheet17.Cells(x, Y) = "1.001"
                End If
            End If
            range1 = worksheet17.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet17.Rows(x).Font.size = 10

            Y = Y + 1

            N_TOTAL = 0
            N_STD = 0
            M1 = 0
            SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                Else
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                End If
                M1 = M1 + 1
            Next

            M1 = 0
            '    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '"INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '" M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"
            '    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            N_STD1 = 0
            N_STD2 = 0
            SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120) as Ddate,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                   "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') " & _
                   " GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04Lotno having count(M04Lotno)>1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  " & _
                  "  T03TYPE IN ('01') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND M04Date_Out='" & T03.Tables(0).Rows(M1)("Ddate") & "'"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M2 = 0
                For Each DTRow5 As DataRow In T04.Tables(0).Rows
                    If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                    Else

                        N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                        N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                    End If
                    M2 = M2 + 1
                Next

                M1 = M1 + 1
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            ' MsgBox(N_STD / N_TOTAL)
            If N_STD = 0 And N_TOTAL = 0 Then
                worksheet17.Cells(x, Y) = "0"
            Else
                'worksheet17.Cells(x, Y) = (N_STD / N_TOTAL)
                If (N_STD / N_TOTAL) < 1 Then
                    worksheet17.Cells(x, Y) = (N_STD / N_TOTAL)
                Else
                    'worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                    worksheet17.Cells(x, Y) = "1.001"
                End If
            End If

            range1 = worksheet17.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet17.Rows(x).Font.size = 10

            N_TOTAL = 0
            N_STD = 0
            M1 = 0
            Y = Y + 1
            SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                  " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01','02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                Else
                    N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                End If
                M1 = M1 + 1
            Next

            M1 = 0
            '    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '"INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '" M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"
            '    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            N_STD1 = 0
            N_STD2 = 0
            SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120) as Ddate,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                   "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01','02') " & _
                   " GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04Lotno having count(M04Lotno)>1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120) as Ddate,M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  " & _
                  "  T03TYPE IN ('01','02') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND M04Date_Out='" & T03.Tables(0).Rows(M1)("Ddate") & "'"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M2 = 0
                For Each DTRow5 As DataRow In T04.Tables(0).Rows
                    If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                    Else

                        N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                        N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                    End If
                    M2 = M2 + 1
                Next

                M1 = M1 + 1
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2

            If N_STD = 0 And N_TOTAL = 0 Then
                worksheet17.Cells(x, Y) = "0"
            Else

                ' worksheet17.Cells(x, Y) = N_STD / N_TOTAL
                If (N_STD / N_TOTAL) < 1 Then
                    worksheet17.Cells(x, Y) = (N_STD / N_TOTAL)
                Else
                    'worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                    worksheet17.Cells(x, Y) = "1.001"
                End If
            End If
            range1 = worksheet17.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet17.Rows(x).Font.size = 10


            worksheet17.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("c" & x, "C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet17.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet17.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ' Overall_IAFFAF = Overall_IAFFAF + 1
            Y = Y + 1
            x = x + 1
            i = i + 1
        Next
        'DRAW CHART ------------------------------------------------------------>>>


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet17.ChartObjects

        Dim _Chartlocation As Integer
        Dim rh As Double

        _Chartlocation = (x + 15) * 10
        rh = (x - 4) * 15
        rh = rh + 28.25 + 20.75
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1
        chartRange = worksheet17.Range("C7", "C" & (x - 1))
        chartRange1 = worksheet17.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Watere Jet Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet17.Range("B7", "B" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow Machine"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(192, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
        '  t_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
        '  t_Series.Format.Line.ForeColor.RGB = RGB(255, 0, 0)
        't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
        '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

        chartRange = worksheet17.Range("D7", "D" & (x - 1))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Avarage"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'Next
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Weekly efficiency")
       

    End Function

    Function OvarallInAFGrf1()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet1 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet1.Name = "Chart1"


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet1.ChartObjects

        Dim _Chartlocation As Integer

        ' _Chartlocation = (x + 15) * 10

        myChart = xlCharts.Add(10, 20, 905, 500)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1
        Dim exSheet As Microsoft.Office.Interop.Excel.Worksheet
        exSheet = workbooks(1).Worksheets(22)
        Overall_IAFFAF = Overall_IAFFAF - 1
        '  Overall_IAFFWJ = Overall_IAFFWJ - 6
        chartRange = exSheet.Range("j7", "j" & (Overall_IAFFAF))
        chartRange1 = exSheet.Range("b7", "b" & (Overall_IAFFAF))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Boil Out"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 0, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
        chartRange = exSheet.Range("k7", "k" & (Overall_IAFFAF))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Down Time"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(148, 208, 80)
        chartPage.SeriesCollection(2).Interior.Color = RGB(148, 208, 80)


        chartRange = exSheet.Range("l7", "l" & (Overall_IAFFAF))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "No Work"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)

        chartPage.Refresh()

        chartRange = exSheet.Range("M7", "M" & (Overall_IAFFAF))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Process Dilay Time"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(4).Interior.Color = RGB(0, 0, 0)
        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'Next
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Air Flow   Machine Inefficient % Analysis")

        workbook.Sheets("Chart1").Select()
        ' MsgBox(workbook.ActiveSheet.ChartObjects.ToString)
        workbook.ActiveSheet.ChartObjects("1").Activate()
        ' sheets("Overall Inefficiency (WJ)").Select()
        '  workbook.ActiveWindow.SelectedSheets.Delete()
        workbook.ActiveChart.Location(Where:=XlChartLocation.xlLocationAsNewSheet, Name:="Overall Inefficiency (AF)")
        ' workbook.Sheets("NewSheet").Select()
        workbook.Sheets("Overall Inefficiency (AF)").Move(After:=workbook.Sheets(1))

        workbook.Sheets("Chart1").Select()
        workbook.Sheets("Chart1").delete()
        workbook.Sheets("Overall Inefficiency (AF)").Select()
    End Function

    Function OvarallInWJGrf()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet1 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet1.Name = "Chart1"


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet1.ChartObjects

        Dim _Chartlocation As Integer

        ' _Chartlocation = (x + 15) * 10

        myChart = xlCharts.Add(10, 20, 905, 500)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1
        Dim exSheet As Microsoft.Office.Interop.Excel.Worksheet
        exSheet = workbooks(1).Worksheets(24)
        Overall_IAFFWJ = Overall_IAFFWJ + 6
        '  Overall_IAFFWJ = Overall_IAFFWJ - 6
        chartRange = exSheet.Range("j7", "j" & (Overall_IAFFWJ))
        chartRange1 = exSheet.Range("b7", "b" & (Overall_IAFFWJ))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Boil Out"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 0, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
        chartRange = exSheet.Range("k7", "k" & (Overall_IAFFWJ))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Down Time"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(148, 208, 80)
        chartPage.SeriesCollection(2).Interior.Color = RGB(148, 208, 80)
       

        chartRange = exSheet.Range("l7", "l" & (Overall_IAFFWJ))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "No Work"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)

        chartPage.Refresh()

        chartRange = exSheet.Range("M7", "M" & (Overall_IAFFWJ))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Process Dilay Time"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(4).Interior.Color = RGB(0, 0, 0)
        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'Next
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Water Jet   Machine Inefficient % Analysis")

        workbook.Sheets("Chart1").Select()
        ' MsgBox(workbook.ActiveSheet.ChartObjects.ToString)
        workbook.ActiveSheet.ChartObjects("1").Activate()
        ' sheets("Overall Inefficiency (WJ)").Select()
        '  workbook.ActiveWindow.SelectedSheets.Delete()
        workbook.ActiveChart.Location(Where:=XlChartLocation.xlLocationAsNewSheet, Name:="Overall Inefficiency (WJ)")
        ' workbook.Sheets("NewSheet").Select()
        workbook.Sheets("Overall Inefficiency (WJ)").Move(After:=workbook.Sheets(1))

        workbook.Sheets("Chart1").Select()
        workbook.Sheets("Chart1").delete()
        workbook.Sheets("Overall Inefficiency (WJ)").Select()

    End Function

    Function WhiteMalGf()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet1 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet1.Name = "Chart1"


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet1.ChartObjects

        Dim _Chartlocation As Integer

        ' _Chartlocation = (x + 15) * 10

        myChart = xlCharts.Add(10, 20, 905, 500)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1
        Dim exSheet As Microsoft.Office.Interop.Excel.Worksheet
        exSheet = workbooks(1).Worksheets(16)
        StrWitemal = StrWitemal - 1
        '  Overall_IAFFWJ = Overall_IAFFWJ - 6
        chartRange = exSheet.Range("B4", "B" & (StrWitemal))
        chartRange1 = exSheet.Range("A4", "A" & (StrWitemal))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Water Jet"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 192, 0)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 192, 0)
        chartRange = exSheet.Range("c4", "c" & (StrWitemal))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Air Flow"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        '// Try uncommenting the next line if it still doesn't work.
        't_SerCol.Add(t_Series)
        t_Series.Border.Color = RGB(255, 0, 0)
        chartPage.SeriesCollection(2).Interior.Color = RGB(255, 0, 0)


        chartRange = exSheet.Range("d4", "d" & (StrWitemal))
        '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Total"
            '  t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 0, 255)

        chartPage.Refresh()


        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'Next
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("WEEKLY DYEING OUTPUT")

        workbook.Sheets("Chart1").Select()
        ' MsgBox(workbook.ActiveSheet.ChartObjects.ToString)
        workbook.ActiveSheet.ChartObjects("1").Activate()
        ' sheets("Overall Inefficiency (WJ)").Select()
        '  workbook.ActiveWindow.SelectedSheets.Delete()
        workbook.ActiveChart.Location(Where:=XlChartLocation.xlLocationAsNewSheet, Name:="Weekly OUTPUT")
        ' workbook.Sheets("NewSheet").Select()
        workbook.Sheets("Weekly OUTPUT").Move(After:=workbook.Sheets(1))

        workbook.Sheets("Chart1").Select()
        workbook.Sheets("Chart1").delete()
        workbook.Sheets("Weekly OUTPUT").Select()
    End Function
    Function Monthly_efficinacy()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet18 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet18.Name = "Monthly efficiency"
        worksheet18.Cells(2, 3) = "Textured Jersey PLC"
        worksheet18.Rows(2).Font.Bold = True
        worksheet18.Rows(2).Font.size = 26
        worksheet18.Range("A2:J2").MergeCells = True
        worksheet18.Range("A2:J2").VerticalAlignment = XlVAlign.xlVAlignCenter


        worksheet18.Cells(4, 1) = "% Monthly dyeing efficiency report"
        worksheet18.Rows(4).Font.Bold = True
        worksheet18.Rows(4).Font.size = 12


        worksheet18.Rows(6).rowheight = 28.25

        worksheet18.Rows(6).Font.Bold = True
        ' worksheet16.Rows(6).Font.size = 12



        worksheet18.Cells(6).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet18.Cells(6, 2) = "Air flow machine "
        worksheet18.Rows(6).Font.Bold = True
        worksheet18.Rows(6).Font.size = 11

        worksheet18.Cells(6, 2).WrapText = True
        worksheet18.Cells(6, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        ' worksheet16.Cells(7).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet18.Cells(6, 3) = "Water jet machine "
        worksheet18.Rows(6).Font.Bold = True
        worksheet18.Rows(6).Font.size = 11

        worksheet18.Cells(6, 3).WrapText = True
        worksheet18.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet18.Cells(6, 4) = "Average "
        worksheet18.Rows(6).Font.Bold = True
        worksheet18.Rows(6).Font.size = 11

        worksheet18.Cells(6, 4).WrapText = True
        worksheet18.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet18.Columns("B").ColumnWidth = 12
        worksheet18.Columns("C").ColumnWidth = 12
        worksheet18.Columns("D").ColumnWidth = 12

        worksheet18.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("c6", "C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet18.Range("A6", "A6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet18.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        'daysInFeb = DateDiff("d", CDate("1/1/" & Year(dat)), dat) + 1
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        '  n_Date = CDate(n_Date).AddDays(-1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"
        '  N_Di=i+1ate1 = CDate(N_Date1).AddDays(+1)
        ' SQL = ""
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 7

        SQL = "SELECT m04month AS Ddate,year(M04ETIME) as Eyear FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType<>'I' AND " & _
                " M04ETIME BETWEEN '" & n_Date & "' AND '" & N_Date1 & "'  GROUP BY Year(M04ETIME),M04month order by Year(M04ETIME),M04month"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet18.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate") & "-" & T01.Tables(0).Rows(i)("Eyear")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet18.Cells(x, 1).EntireColumn.NumberFormat = "MMM-yyyy"
            worksheet18.Rows(x).Font.size = 10
            Dim N_TOTAL As Integer
            Dim N_STD As Integer

            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer

            Y = 2
            Dim txtYear As String
            Dim tmpDate As Date
            Dim Ydate As Integer
            Dim N_STD1 As Integer
            Dim N_STD2 As Integer
            Dim L_DateofMonth As Integer

            Dim aDate As DateTime
            Dim aDate1 As DateTime

            aDate = T01.Tables(0).Rows(i)("DDATE") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            Dim N_COUNT As Integer

            N_TOTAL = 0
            N_STD = 0
            N_STD1 = 0
            N_STD2 = 0
            M1 = 0
            Dim adDate2 As Date
            Dim adDate3 As Date
            adDate3 = aDate
            For N_COUNT = 1 To L_DateofMonth
                adDate2 = CDate(adDate3).AddDays(+1)
                adDate2 = adDate2 & " " & "7:30AM"
                aDate1 = adDate3 & " " & "7:30AM"
                '  n_Date = CDate(n_Date).AddDays(-1)
                N_Date1 = txtTodate.Text & " " & "7:30AM"
                SQL = "SELECT M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                      "  T03TYPE IN ('02') and M04Etime between '" & aDate1 & "' and '" & adDate2 & "' GROUP BY M04ProgrameType "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                    If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                        N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                    Else
                        N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                    End If
                    M1 = M1 + 1
                Next
                adDate3 = CDate(adDate3).AddDays(+1)
            Next
            M1 = 0
            Dim M2 As Integer
            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '       "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '       " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"
            adDate3 = aDate
            N_STD1 = 0
            N_STD2 = 0
            For N_COUNT = 1 To L_DateofMonth
                adDate2 = CDate(adDate3).AddDays(+1)
                adDate2 = adDate2 & " " & "7:30AM"
                aDate1 = adDate3 & " " & "7:30AM"
                '  n_Date = CDate(n_Date).AddDays(-1)
                N_Date1 = txtTodate.Text & " " & "7:30AM"
                SQL = "SELECT M04Lotno,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                       "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                       "WHERE M04ProgrameType not in ('E','i') AND m04Etime between '" & aDate1 & "' and '" & adDate2 & "' AND T03TYPE IN ('02')  " & _
                       " GROUP BY M04Lotno having count(M04Lotno)>1 "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    Dim A1 As Date
                    Dim A2 As Date

                    SQL = "SELECT M04Lotno,M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
                      "  T03TYPE IN ('02') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND m04etime between '" & aDate1 & "' and '" & adDate2 & "'"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    M2 = 0
                    For Each DTRow5 As DataRow In T04.Tables(0).Rows
                        If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                        Else
                            N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                            N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                        End If
                        M2 = M2 + 1
                    Next

                    M1 = M1 + 1
                Next
                adDate3 = CDate(adDate3).AddDays(+1)
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            If N_STD = 0 And N_TOTAL = 0 Then
                worksheet18.Cells(x, Y) = "0"
            Else
                If (N_STD / N_TOTAL) < 1 Then
                    worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                Else
                    'worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                    worksheet18.Cells(x, Y) = "1.001"
                End If
            End If
            range1 = worksheet18.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet18.Rows(x).Font.size = 10

            Y = Y + 1

            N_TOTAL = 0
            N_STD = 0
            N_STD1 = 0
            N_STD2 = 0
            M1 = 0
            adDate3 = aDate
            N_STD1 = 0
            N_STD2 = 0
            For N_COUNT = 1 To L_DateofMonth
                adDate2 = CDate(adDate3).AddDays(+1)
                adDate2 = adDate2 & " " & "7:30AM"
                aDate1 = adDate3 & " " & "7:30AM"
                '  n_Date = CDate(n_Date).AddDays(-1)
                N_Date1 = txtTodate.Text & " " & "7:30AM"
                SQL = "SELECT M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                      " m04etime between '" & aDate1 & "' and '" & adDate2 & "' AND T03TYPE IN ('01')  GROUP BY M04ProgrameType "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                    If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                        N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                    Else
                        N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                    End If
                    M1 = M1 + 1
                Next
                adDate3 = CDate(adDate3).AddDays(+1)
            Next
            M1 = 0
            ' Dim M2 As Integer
            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '       "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '       " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"

            adDate3 = aDate
            N_STD1 = 0
            N_STD2 = 0
            For N_COUNT = 1 To L_DateofMonth
                adDate2 = CDate(adDate3).AddDays(+1)
                adDate2 = adDate2 & " " & "7:30AM"
                aDate1 = adDate3 & " " & "7:30AM"
                '  n_Date = CDate(n_Date).AddDays(-1)
                N_Date1 = txtTodate.Text & " " & "7:30AM"
                SQL = "SELECT M04Lotno,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                       "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                       "WHERE M04ProgrameType not in ('E','i') AND m04etime between '" & aDate1 & "' and '" & adDate2 & "' AND T03TYPE IN ('01') " & _
                       " GROUP BY m04Lotno having count(M04Lotno)>1 "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                '  N_STD1 = 0
                ' N_STD2 = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    Dim A1 As Date
                    Dim A2 As Date

                    SQL = "SELECT M04Lotno,M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
                      "  T03TYPE IN ('01') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND m04etime between '" & aDate1 & "' and '" & adDate2 & "'"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    M2 = 0
                    For Each DTRow5 As DataRow In T04.Tables(0).Rows
                        If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                        Else
                            N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                            N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                        End If
                        M2 = M2 + 1
                    Next

                    M1 = M1 + 1
                Next
                adDate3 = CDate(adDate3).AddDays(+1)
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            If N_STD = 0 And N_TOTAL = 0 Then
                worksheet18.Cells(x, Y) = "0"
            Else
                ' worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)

                If (N_STD / N_TOTAL) < 1 Then
                    worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                Else
                    'worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                    worksheet18.Cells(x, Y) = "1.001"
                End If
            End If
            range1 = worksheet18.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet18.Rows(x).Font.size = 10

            Y = Y + 1

            N_TOTAL = 0
            N_STD = 0
            N_STD1 = 0
            N_STD2 = 0
            M1 = 0
            adDate3 = aDate
            N_STD1 = 0
            N_STD2 = 0
            For N_COUNT = 1 To L_DateofMonth
                adDate2 = CDate(adDate3).AddDays(+1)
                adDate2 = adDate2 & " " & "7:30AM"
                aDate1 = adDate3 & " " & "7:30AM"
                '  n_Date = CDate(n_Date).AddDays(-1)
                N_Date1 = txtTodate.Text & " " & "7:30AM"
                SQL = "SELECT M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
                      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
                      " m04Etime between '" & aDate1 & "' and '" & adDate2 & "' AND T03TYPE IN ('01','02')  GROUP BY M04ProgrameType "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
                    If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
                        N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
                    Else
                        N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
                    End If
                    M1 = M1 + 1
                Next
                adDate3 = CDate(adDate3).AddDays(+1)
            Next
            M1 = 0
            ' Dim M2 As Integer
            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '       "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='F' AND " & _
            '       " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,M04Lotno"
            adDate3 = aDate
            N_STD1 = 0
            N_STD2 = 0
            For N_COUNT = 1 To L_DateofMonth
                adDate2 = CDate(adDate3).AddDays(+1)
                adDate2 = adDate2 & " " & "7:30AM"
                aDate1 = adDate3 & " " & "7:30AM"
                '  n_Date = CDate(n_Date).AddDays(-1)
                ' N_Date1 = txtTodate.Text & " " & "7:30AM"
                SQL = "SELECT M04Lotno,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
                       "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                       "WHERE M04ProgrameType not in ('E','i') AND m04etime between '" & aDate1 & "' and '" & adDate2 & "' AND T03TYPE IN ('01','02')  " & _
                       " GROUP BY M04Lotno having count(M04Lotno)>1 "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    Dim A1 As Date
                    Dim A2 As Date

                    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
                      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
                      "  T03TYPE IN ('01','02') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' and m04etime between '" & aDate1 & "' and '" & adDate2 & "'"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    M2 = 0
                    For Each DTRow5 As DataRow In T04.Tables(0).Rows
                        If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "E" Or Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "D" Then
                        Else
                            N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
                            N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
                        End If
                        M2 = M2 + 1
                    Next

                    M1 = M1 + 1
                Next
                adDate3 = CDate(adDate3).AddDays(+1)
            Next
            N_STD = N_STD - N_STD1
            N_STD = N_STD + N_STD2
            If N_STD = 0 And N_TOTAL = 0 Then
                worksheet18.Cells(x, Y) = "0"
            Else
                ' worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                If (N_STD / N_TOTAL) < 1 Then
                    worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                Else
                    'worksheet18.Cells(x, Y) = (N_STD / N_TOTAL)
                    worksheet18.Cells(x, Y) = "1.001"
                End If
            End If
            range1 = worksheet18.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet18.Rows(x).Font.size = 10

            '  Y = Y + 1
            worksheet18.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("c" & x, "C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet18.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet18.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            x = x + 1
            i = i + 1
        Next
            'DRAW CHART ------------------------------------------------------------>>>


            Dim chartPage As Microsoft.Office.Interop.Excel.Chart
            Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
            Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
            Dim chartRange As Microsoft.Office.Interop.Excel.Range
            Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
            Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


            Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
            Dim t_Series As Microsoft.Office.Interop.Excel.Series
            Dim z1 As Integer
        Dim sh As Worksheet
            xlCharts = worksheet18.ChartObjects

            Dim _Chartlocation As Integer
        Dim rh As Double
            _Chartlocation = (x + 15) * 10

        rh = (x - 3) * 15
        rh = rh + 28.25 + 33.75
        myChart = xlCharts.Add(7, rh, 905, 300)
            chartPage = myChart.Chart
            Dim _CH As Integer
            '_CH = 7
            'For _CH = 7 To x - 1
            chartRange = worksheet18.Range("C7", "C" & (x - 1))
            chartRange1 = worksheet18.Range("A7", "A" & (x - 1))
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Watere Jet Machine"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 215, 0)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
            chartRange = worksheet18.Range("B7", "B" & (x - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Air Flow Machine"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
            End With

            '// Try uncommenting the next line if it still doesn't work.
            't_SerCol.Add(t_Series)
            t_Series.Border.Color = RGB(192, 0, 0)
            chartPage.SeriesCollection(2).Interior.Color = RGB(192, 0, 0)
            '  t_Series.MarkerStyle = XlMarkerStyle.xlMarkerStyleCircle
            '  t_Series.Format.Line.ForeColor.RGB = RGB(255, 0, 0)
            't_Series.MarkerBackgroundColorIndex = 1    'Blue Markers
            '  t_Series.MarkerBackgroundColorIndex = XlColorIndex.xlColorIndexAutomatic '3

            chartRange = worksheet18.Range("D7", "D" & (x - 1))
            '   chartRange1 = worksheet16.Range("A7", "A" & (x - 1))
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Avarage"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
            chartPage.HasTitle = True
            chartPage.ChartTitle.Text = ("Monthly efficiency%")
            chartPage.Refresh()

            chartPage.Refresh()

            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
            'Next
            '  chartPage.HasTitle = True
            ' chartPage.ChartTitle.Text = ("Monthly efficiency%")
    End Function

    Function ShadeDis_Daaily()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet19 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet19.Name = "Shade Distribution Daily"
       
        'page Header
        worksheet19.Cells(1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet19.Cells(1, 1) = "Air flow Batch Distribution  (Daily)"
        worksheet19.Rows(1).Font.Bold = True
        worksheet19.Rows(1).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet19.Columns("A").ColumnWidth = 10
        worksheet19.Columns("B").ColumnWidth = 10
        worksheet19.Columns("C").ColumnWidth = 10
        worksheet19.Columns("D").ColumnWidth = 10
        worksheet19.Columns("E").ColumnWidth = 10
        worksheet19.Columns("F").ColumnWidth = 10
        worksheet19.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet19.Columns("H").ColumnWidth = 10
       

        worksheet19.Range(worksheet19.Cells(1, 1), worksheet19.Cells(1, 8)).Merge()
        worksheet19.Range(worksheet19.Cells(1, 1), worksheet19.Cells(1, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet19.Cells(1, 1)

        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet19.Range("A1", "H1").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous
       
        worksheet19.Range("A1:H1").Interior.Color = RGB(215, 228, 188)
        worksheet19.Rows(2).Font.size = 10

        worksheet19.Cells(2, 2) = "No. of  batches"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet19.Rows(2).Font.size = 10
        worksheet19.Range(worksheet19.Cells(2, 2), worksheet19.Cells(2, 6)).Merge()
        worksheet19.Range(worksheet19.Cells(2, 2), worksheet19.Cells(2, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet19.Range("A1", "B1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("A1", "H1").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H1", "H1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H1", "H1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("A2", "A2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H2", "H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H2", "H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("A1:A3").Interior.Color = RGB(215, 228, 188)
        worksheet19.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        ' worksheet11.Range("A1:A2").Interior.Color = RGB(255, 255, 255)
        worksheet19.Cells(3, 2) = "Colours"
        worksheet19.Cells(3, 2).Font.Bold = True
        worksheet19.Cells(3, 2).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 2).Font.size = 8

        worksheet19.Cells(3, 2).WrapText = True
        worksheet19.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B2", "B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 2)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet19.Range("B3:B3").Interior.Color = RGB(215, 228, 188)
        'worksheet11.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        worksheet19.Cells(3, 3) = "White"
        worksheet19.Cells(3, 3).Font.Bold = True
        worksheet19.Cells(3, 3).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 3).Font.size = 8

        worksheet19.Cells(3, 3).WrapText = True
        worksheet19.Cells(3, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 3)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("C3:C3").Interior.Color = RGB(215, 228, 188)


        worksheet19.Cells(3, 4) = "Yarn dye & Marl"
        worksheet19.Cells(3, 4).Font.Bold = True
        worksheet19.Cells(3, 4).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 4).Font.size = 8

        worksheet19.Cells(3, 4).WrapText = True
        worksheet19.Cells(3, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 4)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("D3:D3").Interior.Color = RGB(215, 228, 188)

        worksheet19.Cells(3, 5) = "Light"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 5).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 5).Font.size = 8

        worksheet19.Cells(3, 5).WrapText = True
        worksheet19.Cells(3, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 5)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("E3:E3").Interior.Color = RGB(215, 228, 188)

        worksheet19.Cells(3, 6) = "Medium"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 6).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 6).Font.size = 8

        worksheet19.Cells(3, 6).WrapText = True
        worksheet19.Cells(3, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("F3:F3").Interior.Color = RGB(215, 228, 188)



        worksheet19.Cells(3, 7) = "Dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 7).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 7).Font.size = 8

        worksheet19.Cells(3, 7).WrapText = True
        worksheet19.Cells(3, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("G3:G3").Interior.Color = RGB(215, 228, 188)

        worksheet19.Cells(3, 8) = "Extra dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 8).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 8).Font.size = 8

        worksheet19.Cells(3, 8).WrapText = True
        worksheet19.Cells(3, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("H3:H3").Interior.Color = RGB(215, 228, 188)


        worksheet19.Columns("I").ColumnWidth = 3
        '===========================================================================================================
        '===========================================================================================================
        worksheet19.Cells(1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet19.Cells(1, 10) = "WaterJet Batch Distribution(Daily)"
        ' worksheet11.Rows(1).Font.Bold = True
        ' worksheet11.Rows(1).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet19.Columns("J").ColumnWidth = 10
        worksheet19.Columns("K").ColumnWidth = 10
        worksheet19.Columns("L").ColumnWidth = 10
        worksheet19.Columns("M").ColumnWidth = 10
        worksheet19.Columns("N").ColumnWidth = 10
        worksheet19.Columns("O").ColumnWidth = 10
        worksheet19.Columns("P").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet19.Columns("Q").ColumnWidth = 10


        worksheet19.Range(worksheet19.Cells(1, 10), worksheet19.Cells(1, 17)).Merge()
        worksheet19.Range(worksheet19.Cells(1, 10), worksheet19.Cells(1, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet19.Cells(1, 17)

        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet19.Range("J1", "Q1").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("J1:Q1").Interior.Color = RGB(215, 228, 188)
        worksheet19.Rows(2).Font.size = 10

        worksheet19.Cells(2, 11) = "No. of  batches"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet19.Rows(2).Font.size = 10
        worksheet19.Range(worksheet19.Cells(2, 11), worksheet19.Cells(2, 17)).Merge()
        worksheet19.Range(worksheet19.Cells(2, 11), worksheet19.Cells(2, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet19.Range("J1", "J1").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J1", "K1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J1", "Q1").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q1", "Q1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J1", "J1").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J2", "J2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J2", "Q2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q2", "Q2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("M2", "M2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J1:J3").Interior.Color = RGB(215, 228, 188)
        worksheet19.Range("K2:K2").Interior.Color = RGB(215, 228, 188)
        worksheet19.Range("J2", "J2").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Cells(3, 11) = "Colours"
        worksheet19.Cells(3, 11).Font.Bold = True
        worksheet19.Cells(3, 11).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 11).Font.size = 8

        worksheet19.Cells(3, 11).WrapText = True
        worksheet19.Cells(3, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("K3", "K3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K3", "K3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K2", "K3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 11)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet19.Range("K3:K3").Interior.Color = RGB(215, 228, 188)
        'worksheet11.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        worksheet19.Cells(3, 12) = "White"
        worksheet19.Cells(3, 12).Font.Bold = True
        worksheet19.Cells(3, 12).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 12).Font.size = 8

        worksheet19.Cells(3, 12).WrapText = True
        worksheet19.Cells(3, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 12)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("L3:L3").Interior.Color = RGB(215, 228, 188)


        worksheet19.Cells(3, 13) = "Yarn dye & Marl"
        worksheet19.Cells(3, 13).Font.Bold = True
        worksheet19.Cells(3, 13).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 13).Font.size = 8

        worksheet19.Cells(3, 13).WrapText = True
        worksheet19.Cells(3, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 13)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("M3:M3").Interior.Color = RGB(215, 228, 188)

        worksheet19.Cells(3, 14) = "Light"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 14).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 14).Font.size = 8

        worksheet19.Cells(3, 14).WrapText = True
        worksheet19.Cells(3, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 14)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("N3:N3").Interior.Color = RGB(215, 228, 188)

        worksheet19.Cells(3, 15) = "Medium"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 15).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 15).Font.size = 8

        worksheet19.Cells(3, 15).WrapText = True
        worksheet19.Cells(3, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 15)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("O3:O3").Interior.Color = RGB(215, 228, 188)



        worksheet19.Cells(3, 16) = "Dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 16).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 16).Font.size = 8

        worksheet19.Cells(3, 16).WrapText = True
        worksheet19.Cells(3, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 16)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("P3:P3").Interior.Color = RGB(215, 228, 188)

        worksheet19.Cells(3, 17) = "Extra dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet19.Cells(3, 17).Font.Name = "Times New Roman"
        worksheet19.Cells(3, 17).Font.size = 8

        worksheet19.Cells(3, 17).WrapText = True
        worksheet19.Cells(3, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet19.Cells(3, 17)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("Q3:Q3").Interior.Color = RGB(215, 228, 188)



        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-daysInFeb)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet19.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet19.Cells(x, 1).EntireColumn.NumberFormat = "dd-MMM"
            worksheet19.Rows(x).Font.size = 10

            worksheet19.Cells(x, 10) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet19.Cells(x, 10).EntireColumn.NumberFormat = "dd-MMM"
            worksheet19.Rows(x).Font.size = 10

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"


            'COLOUR
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 2) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 2)
                range1.Font.Color = RGB(255, 0, 0)
                
            End If
            worksheet19.Range("B" & x & ":" & "B" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 11) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 11)
                range1.Font.Color = RGB(255, 0, 0)
               
            End If
            worksheet19.Range("K" & x & ":" & "K" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------------------------
            'WHITE
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL='White' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 3) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 3)
                range1.Font.Color = RGB(0, 0, 255)
                
            End If
            worksheet19.Range("C" & x & ":" & "C" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL='White' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 12) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 12)
                range1.Font.Color = RGB(0, 0, 255)
              
            End If

            worksheet19.Range("L" & x & ":" & "L" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '-------------------------------------------------------------------------------------
            'Yarn dye & Marl
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL='MARL & Yarn dye' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 4) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 4)
                range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet19.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL='MARL & Yarn dye' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 13) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 13)
                range1.Font.Color = RGB(0, 0, 255)

            End If

            worksheet19.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '-------------------------------------------------------------------------------
            'LIGHT
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
              "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
              " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 5) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 14) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 14)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '------------------------------------------------------------------------------------
            'Medium

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
             "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
             " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 6) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 6)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 15) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 15)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------
            'DARK
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 7) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 7)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' group by M04Lotno,M08SubName  "

            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 16) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 16)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------------------
            'Extra dark

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 8) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 8)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet19.Cells(x, 17) = T03.Tables(0).Rows.Count
                range1 = worksheet19.Cells(x, 17)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet19.Cells(x, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet19.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet19.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            ' worksheet11.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet19.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next
        worksheet19.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        ' worksheet11.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1

        ' worksheet1Function.Sum(worksheet11.Range("G1:G5000"))
        worksheet19.Cells(x, 1) = "Total"
        worksheet19.Cells(x, 1).Font.Bold = True
        worksheet19.Cells(x, 1).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 1).Font.size = 10
        worksheet19.Cells(x, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("B" & (x)).Formula = "=SUM(B4:B" & (x - 1) & ")"
        worksheet19.Cells(x, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 2).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 2).Font.size = 10
        range1 = worksheet19.Cells(x, 2)
        range1.Font.Color = RGB(255, 0, 0)


        worksheet19.Range("C" & (x)).Formula = "=SUM(C4:C" & (x - 1) & ")"
        worksheet19.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 3).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 3).Font.size = 10
        range1 = worksheet19.Cells(x, 3)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("D" & (x)).Formula = "=SUM(D4:D" & (x - 1) & ")"
        worksheet19.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 4).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 4).Font.size = 10
        range1 = worksheet19.Cells(x, 4)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("E" & (x)).Formula = "=SUM(E4:E" & (x - 1) & ")"
        worksheet19.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 5).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 5).Font.size = 10
        'range1 = worksheet11.Cells(x, 5)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("F" & (x)).Formula = "=SUM(F4:F" & (x - 1) & ")"
        worksheet19.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 6).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 6).Font.size = 10
        'range1 = worksheet11.Cells(x, 6)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("G" & (x)).Formula = "=SUM(G4:G" & (x - 1) & ")"
        worksheet19.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 7).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 7).Font.size = 10
        'range1 = worksheet11.Cells(x, 7)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("H" & (x)).Formula = "=SUM(H4:H" & (x - 1) & ")"
        worksheet19.Cells(x, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 8).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 8).Font.size = 10
        ' range1 = worksheet11.Cells(x, 8)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("B" & x & ":" & "B" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("C" & x & ":" & "C" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("E" & x & ":" & "E" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("F" & x & ":" & "F" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("G" & x & ":" & "G" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("H" & x & ":" & "H" & x).Interior.Color = RGB(219, 238, 243)



        worksheet19.Cells(x, 10) = "Total"
        worksheet19.Cells(x, 10).Font.Bold = True
        worksheet19.Cells(x, 10).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 10).Font.size = 10
        worksheet19.Cells(x, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet19.Range("K" & (x)).Formula = "=SUM(K4:K" & (x - 1) & ")"
        worksheet19.Cells(x, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 11).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 11).Font.size = 10
        range1 = worksheet19.Cells(x, 11)
        range1.Font.Color = RGB(255, 0, 0)


        worksheet19.Range("L" & (x)).Formula = "=SUM(L4:L" & (x - 1) & ")"
        worksheet19.Cells(x, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 12).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 12).Font.size = 10
        range1 = worksheet19.Cells(x, 12)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("M" & (x)).Formula = "=SUM(M4:M" & (x - 1) & ")"
        worksheet19.Cells(x, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 13).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 13).Font.size = 10
        range1 = worksheet19.Cells(x, 13)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("N" & (x)).Formula = "=SUM(N4:N" & (x - 1) & ")"
        worksheet19.Cells(x, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 14).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 14).Font.size = 10
        'range1 = worksheet11.Cells(x, 5)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("O" & (x)).Formula = "=SUM(O4:O" & (x - 1) & ")"
        worksheet19.Cells(x, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 15).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 15).Font.size = 10
        'range1 = worksheet11.Cells(x, 6)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("P" & (x)).Formula = "=SUM(P4:P" & (x - 1) & ")"
        worksheet19.Cells(x, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 16).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 16).Font.size = 10
        'range1 = worksheet11.Cells(x, 7)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet19.Range("Q" & (x)).Formula = "=SUM(Q4:Q" & (x - 1) & ")"
        worksheet19.Cells(x, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet19.Cells(x, 17).Font.Name = "Times New Roman"
        worksheet19.Cells(x, 17).Font.size = 10
        ' range1 = worksheet11.Cells(x, 8)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet19.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet19.Range("K" & x & ":" & "K" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("L" & x & ":" & "L" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("N" & x & ":" & "N" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("O" & x & ":" & "O" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("P" & x & ":" & "P" & x).Interior.Color = RGB(219, 238, 243)
        worksheet19.Range("Q" & x & ":" & "Q" & x).Interior.Color = RGB(219, 238, 243)
        '----------------------------------------------------------------------------------------------
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim rh As Double


        rh = (x - 4) * 12.75
        rh = rh + 50 + 22.5
        xlCharts = worksheet19.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet19.Range("C4", "C" & (x - 2))
        chartRange1 = worksheet19.Range("A4", "A" & (x - 2))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        '  t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet19.Range("D4", "D" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Yarn dye & Marl"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("E4", "E" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("F4", "F" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("G4", "G" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("H4", "H" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Air flow Batch Distribution  (Daily)")


        xlCharts = worksheet19.ChartObjects
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet19.Range("L4", "L" & (x - 2))
        chartRange1 = worksheet19.Range("J4", "J" & (x - 2))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(200, 64, 181)
        'chartPage.SeriesCollection(1).Interior.Color = RGB(200, 64, 181)
        chartPage.Refresh()
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet19.Range("M4", "M" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Yarn dye & Marl"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("N4", "N" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("O4", "O" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("P4", "P" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet19.Range("Q4", "Q" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("WaterJet Batch Distribution(Daily)")
    End Function

    Function ShadeDis_Weekly()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet110 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet110.Name = "Shade Distribution Weekly"

        'page Header
        worksheet110.Cells(1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet110.Cells(1, 1) = "Air flow Batch Distribution  (Weekly)"
        worksheet110.Rows(1).Font.Bold = True
        worksheet110.Rows(1).Font.size = 11
        worksheet110.Cells(1, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter
        'range1 = worksheet1.Cells("B2:G2")

        worksheet110.Columns("A").ColumnWidth = 10
        worksheet110.Columns("B").ColumnWidth = 10
        worksheet110.Columns("C").ColumnWidth = 10
        worksheet110.Columns("D").ColumnWidth = 10
        worksheet110.Columns("E").ColumnWidth = 10
        worksheet110.Columns("F").ColumnWidth = 10
        worksheet110.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet110.Columns("H").ColumnWidth = 10

        ' worksheet111.Range(worksheet111.Cells(1, 1), worksheet111.Cells(1, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet110.Range(worksheet110.Cells(1, 1), worksheet110.Cells(1, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet110.Range(1, 1).VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet110.Cells(1, 1)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet110.Range("A1", "H1").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("A1:H1").Interior.Color = RGB(215, 228, 188)
        worksheet110.Rows(2).Font.size = 10

        worksheet110.Cells(2, 2) = "No. of  batches"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet110.Rows(2).Font.size = 10
        worksheet110.Range(worksheet110.Cells(2, 2), worksheet110.Cells(2, 6)).Merge()
        worksheet110.Range(worksheet110.Cells(2, 2), worksheet110.Cells(2, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet110.Range("A1", "B1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("A1", "H1").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H1", "H1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H1", "H1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("A2", "A2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H2", "H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H2", "H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("A1:A3").Interior.Color = RGB(215, 228, 188)
        worksheet110.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        ' worksheet11.Range("A1:A2").Interior.Color = RGB(255, 255, 255)
        worksheet110.Cells(3, 2) = "Colours"
        worksheet110.Cells(3, 2).Font.Bold = True
        worksheet110.Cells(3, 2).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 2).Font.size = 8

        worksheet110.Cells(3, 2).WrapText = True
        worksheet110.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B2", "B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 2)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet110.Range("B3:B3").Interior.Color = RGB(215, 228, 188)
        'worksheet11.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        worksheet110.Cells(3, 3) = "White"
        worksheet110.Cells(3, 3).Font.Bold = True
        worksheet110.Cells(3, 3).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 3).Font.size = 8

        worksheet110.Cells(3, 3).WrapText = True
        worksheet110.Cells(3, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 3)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("C3:C3").Interior.Color = RGB(215, 228, 188)


        worksheet110.Cells(3, 4) = "Yarn dye & Marl"
        worksheet110.Cells(3, 4).Font.Bold = True
        worksheet110.Cells(3, 4).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 4).Font.size = 8

        worksheet110.Cells(3, 4).WrapText = True
        worksheet110.Cells(3, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 4)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("D3:D3").Interior.Color = RGB(215, 228, 188)

        worksheet110.Cells(3, 5) = "Light"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 5).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 5).Font.size = 8

        worksheet110.Cells(3, 5).WrapText = True
        worksheet110.Cells(3, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 5)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("E3:E3").Interior.Color = RGB(215, 228, 188)

        worksheet110.Cells(3, 6) = "Medium"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 6).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 6).Font.size = 8

        worksheet110.Cells(3, 6).WrapText = True
        worksheet110.Cells(3, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("F3:F3").Interior.Color = RGB(215, 228, 188)



        worksheet110.Cells(3, 7) = "Dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 7).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 7).Font.size = 8

        worksheet110.Cells(3, 7).WrapText = True
        worksheet110.Cells(3, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("G3:G3").Interior.Color = RGB(215, 228, 188)

        worksheet110.Cells(3, 8) = "Extra dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 8).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 8).Font.size = 8

        worksheet110.Cells(3, 8).WrapText = True
        worksheet110.Cells(3, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("H3:H3").Interior.Color = RGB(215, 228, 188)


        worksheet110.Columns("I").ColumnWidth = 2
        '===========================================================================================================
        '===========================================================================================================
        worksheet110.Cells(1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet110.Cells(1, 10) = "WaterJet Batch Distribution(Weekly)"
        ' worksheet11.Rows(1).Font.Bold = True
        ' worksheet11.Rows(1).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet110.Columns("J").ColumnWidth = 10
        worksheet110.Columns("K").ColumnWidth = 10
        worksheet110.Columns("L").ColumnWidth = 10
        worksheet110.Columns("M").ColumnWidth = 10
        worksheet110.Columns("N").ColumnWidth = 10
        worksheet110.Columns("O").ColumnWidth = 10
        worksheet110.Columns("P").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet110.Columns("Q").ColumnWidth = 10


        worksheet110.Range(worksheet110.Cells(1, 10), worksheet110.Cells(1, 17)).Merge()
        worksheet110.Range(worksheet110.Cells(1, 10), worksheet110.Cells(1, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet110.Cells(1, 17)

        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet110.Range("J1", "Q1").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("J1:Q1").Interior.Color = RGB(215, 228, 188)
        worksheet110.Rows(2).Font.size = 10

        worksheet110.Cells(2, 11) = "No. of  batches"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet110.Rows(2).Font.size = 10
        worksheet110.Range(worksheet110.Cells(2, 11), worksheet110.Cells(2, 17)).Merge()
        worksheet110.Range(worksheet110.Cells(2, 11), worksheet110.Cells(2, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet110.Range("J1", "J1").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J1", "K1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J1", "Q1").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q1", "Q1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J1", "J1").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J2", "J2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J2", "Q2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q2", "Q2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("M2", "M2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J1:J3").Interior.Color = RGB(215, 228, 188)
        worksheet110.Range("K2:K2").Interior.Color = RGB(215, 228, 188)
        worksheet110.Range("J2", "J2").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Cells(3, 11) = "Colours"
        worksheet110.Cells(3, 11).Font.Bold = True
        worksheet110.Cells(3, 11).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 11).Font.size = 8

        worksheet110.Cells(3, 11).WrapText = True
        worksheet110.Cells(3, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("K3", "K3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K3", "K3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K2", "K3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 11)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet110.Range("K3:K3").Interior.Color = RGB(215, 228, 188)
        'worksheet11.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        worksheet110.Cells(3, 12) = "White"
        worksheet110.Cells(3, 12).Font.Bold = True
        worksheet110.Cells(3, 12).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 12).Font.size = 8

        worksheet110.Cells(3, 12).WrapText = True
        worksheet110.Cells(3, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 12)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("L3:L3").Interior.Color = RGB(215, 228, 188)


        worksheet110.Cells(3, 13) = "Yarn dye & Marl"
        worksheet110.Cells(3, 13).Font.Bold = True
        worksheet110.Cells(3, 13).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 13).Font.size = 8

        worksheet110.Cells(3, 13).WrapText = True
        worksheet110.Cells(3, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 13)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("M3:M3").Interior.Color = RGB(215, 228, 188)

        worksheet110.Cells(3, 14) = "Light"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 14).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 14).Font.size = 8

        worksheet110.Cells(3, 14).WrapText = True
        worksheet110.Cells(3, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 14)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("N3:N3").Interior.Color = RGB(215, 228, 188)

        worksheet110.Cells(3, 15) = "Medium"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 15).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 15).Font.size = 8

        worksheet110.Cells(3, 15).WrapText = True
        worksheet110.Cells(3, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 15)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("O3:O3").Interior.Color = RGB(215, 228, 188)



        worksheet110.Cells(3, 16) = "Dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 16).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 16).Font.size = 8

        worksheet110.Cells(3, 16).WrapText = True
        worksheet110.Cells(3, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 16)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("P3:P3").Interior.Color = RGB(215, 228, 188)

        worksheet110.Cells(3, 17) = "Extra dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet110.Cells(3, 17).Font.Name = "Times New Roman"
        worksheet110.Cells(3, 17).Font.size = 8

        worksheet110.Cells(3, 17).WrapText = True
        worksheet110.Cells(3, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet110.Cells(3, 17)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("Q3:Q3").Interior.Color = RGB(215, 228, 188)



        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        '  n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet110.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            'worksheet11.Cells(x, 1).EntireColumn.NumberFormat = "dd-MMM"
            worksheet110.Rows(x).Font.size = 10

            worksheet110.Cells(x, 10) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            '  worksheet11.Cells(x, 10).EntireColumn.NumberFormat = "dd-MMM"
            worksheet110.Rows(x).Font.size = 10

            Y = Y + 1
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer
            Dim X_date As Date
            Dim X_date1 As Date
            Dim Y_Date As Date

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"

                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 2) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 2)
                    'range1.Font.Color = RGB(255, 0, 0)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet110.Cells(x, 2) = CL_Count
            range1 = worksheet110.Cells(x, 2)
            range1.Font.Color = RGB(255, 0, 0)
            worksheet110.Range("B" & x & ":" & "B" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 11)
                    'range1.Font.Color = RGB(255, 0, 0)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet110.Cells(x, 11) = CL_Count
            range1 = worksheet110.Cells(x, 11)
            range1.Font.Color = RGB(255, 0, 0)
            worksheet110.Range("K" & x & ":" & "K" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------------------------
            'WHITE
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                    "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                    " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08CL='White' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 3) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 3)
                    'range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            If CL_Count > 0 Then
                worksheet110.Cells(x, 3) = CL_Count
                range1 = worksheet110.Cells(x, 3)
                range1.Font.Color = RGB(0, 0, 255)
            End If
            worksheet110.Range("C" & x & ":" & "C" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter


            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08CL='White' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 12) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 12)
                    'range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            If CL_Count > 0 Then
                worksheet110.Cells(x, 12) = CL_Count
                range1 = worksheet110.Cells(x, 12)
                range1.Font.Color = RGB(0, 0, 255)
            End If
            worksheet110.Range("L" & x & ":" & "L" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '-------------------------------------------------------------------------------------
            'Yarn dye & Marl
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08CL='MARL & Yarn dye' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 4) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 4)
                    'range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            If CL_Count > 0 Then
                worksheet110.Cells(x, 4) = CL_Count
                range1 = worksheet110.Cells(x, 4)
                range1.Font.Color = RGB(0, 0, 255)
            End If
            worksheet110.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08CL='MARL & Yarn dye' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 13) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 13)
                    'range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If CL_Count > 0 Then
                worksheet110.Cells(x, 13) = CL_Count
                range1 = worksheet110.Cells(x, 13)
                range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet110.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '-------------------------------------------------------------------------------
            'LIGHT
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08SubName='Light' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 5) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            If CL_Count > 0 Then
                worksheet110.Cells(x, 5) = CL_Count
                range1 = worksheet110.Cells(x, 5)
            End If
            worksheet110.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 14) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 14)
                    '  range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            If CL_Count > 0 Then
                worksheet110.Cells(x, 14) = CL_Count
                range1 = worksheet110.Cells(x, 14)
            End If
            worksheet110.Cells(x, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '------------------------------------------------------------------------------------
            'Medium
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08SubName='Medium' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 6) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 6)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)

            Next
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            If CL_Count > 0 Then
                worksheet110.Cells(x, 6) = CL_Count
                range1 = worksheet110.Cells(x, 6)
            End If
            worksheet110.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 15) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 15)
                    '  range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)

            Next

            If CL_Count > 0 Then
                worksheet110.Cells(x, 15) = CL_Count
                range1 = worksheet110.Cells(x, 15)
            End If
            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------
            'DARK

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "'  and M04ProgrameType='N' and M08SubName='Dark' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 7) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 7)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            If CL_Count > 0 Then
                worksheet110.Cells(x, 7) = CL_Count
                range1 = worksheet110.Cells(x, 7)
            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' group by M04Lotno,M08SubName "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 16) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 16)
                    '  range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            If CL_Count > 0 Then
                worksheet110.Cells(x, 16) = CL_Count
                range1 = worksheet110.Cells(x, 16)
            End If
            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------------------
            'Extra dark
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' group by M04Lotno,M08SubName "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 8) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 8)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            If CL_Count > 0 Then
                worksheet110.Cells(x, 8) = CL_Count
                'range1 = worksheet110.Cells(x, 8
            End If
            worksheet110.Cells(x, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and  M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' group by M04Lotno,M08SubName having count(M08SubName)=1 "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet110.Cells(x, 17) = T03.Tables(0).Rows.Count
                    'range1 = worksheet110.Cells(x, 17)
                    '  range1.Font.Color = RGB(0, 0, 255)
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If CL_Count > 0 Then
                worksheet110.Cells(x, 17) = CL_Count
                range1 = worksheet110.Cells(x, 17)
            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet110.Cells(x, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet110.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet110.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            ' worksheet11.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet110.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next
        worksheet110.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        ' worksheet11.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1

        ' worksheet1Function.Sum(worksheet11.Range("G1:G5000"))
        worksheet110.Cells(x, 1) = "Total"
        worksheet110.Cells(x, 1).Font.Bold = True
        worksheet110.Cells(x, 1).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 1).Font.size = 10
        worksheet110.Cells(x, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("B" & (x)).Formula = "=SUM(B4:B" & (x - 1) & ")"
        worksheet110.Cells(x, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 2).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 2).Font.size = 10
        range1 = worksheet110.Cells(x, 2)
        range1.Font.Color = RGB(255, 0, 0)


        worksheet110.Range("C" & (x)).Formula = "=SUM(C4:C" & (x - 1) & ")"
        worksheet110.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 3).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 3).Font.size = 10
        range1 = worksheet110.Cells(x, 3)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("D" & (x)).Formula = "=SUM(D4:D" & (x - 1) & ")"
        worksheet110.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 4).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 4).Font.size = 10
        range1 = worksheet110.Cells(x, 4)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("E" & (x)).Formula = "=SUM(E4:E" & (x - 1) & ")"
        worksheet110.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 5).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 5).Font.size = 10
        'range1 = worksheet11.Cells(x, 5)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("F" & (x)).Formula = "=SUM(F4:F" & (x - 1) & ")"
        worksheet110.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 6).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 6).Font.size = 10
        'range1 = worksheet11.Cells(x, 6)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("G" & (x)).Formula = "=SUM(G4:G" & (x - 1) & ")"
        worksheet110.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 7).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 7).Font.size = 10
        'range1 = worksheet11.Cells(x, 7)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("H" & (x)).Formula = "=SUM(H4:H" & (x - 1) & ")"
        worksheet110.Cells(x, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 8).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 8).Font.size = 10
        ' range1 = worksheet11.Cells(x, 8)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("B" & x & ":" & "B" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("C" & x & ":" & "C" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("E" & x & ":" & "E" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("F" & x & ":" & "F" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("G" & x & ":" & "G" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("H" & x & ":" & "H" & x).Interior.Color = RGB(219, 238, 243)



        worksheet110.Cells(x, 10) = "Total"
        worksheet110.Cells(x, 10).Font.Bold = True
        worksheet110.Cells(x, 10).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 10).Font.size = 10
        worksheet110.Cells(x, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet110.Range("K" & (x)).Formula = "=SUM(K4:K" & (x - 1) & ")"
        worksheet110.Cells(x, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 11).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 11).Font.size = 10
        range1 = worksheet110.Cells(x, 11)
        range1.Font.Color = RGB(255, 0, 0)


        worksheet110.Range("L" & (x)).Formula = "=SUM(L4:L" & (x - 1) & ")"
        worksheet110.Cells(x, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 12).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 12).Font.size = 10
        range1 = worksheet110.Cells(x, 12)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("M" & (x)).Formula = "=SUM(M4:M" & (x - 1) & ")"
        worksheet110.Cells(x, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 13).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 13).Font.size = 10
        range1 = worksheet110.Cells(x, 13)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("N" & (x)).Formula = "=SUM(N4:N" & (x - 1) & ")"
        worksheet110.Cells(x, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 14).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 14).Font.size = 10
        'range1 = worksheet11.Cells(x, 5)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("O" & (x)).Formula = "=SUM(O4:O" & (x - 1) & ")"
        worksheet110.Cells(x, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 15).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 15).Font.size = 10
        'range1 = worksheet11.Cells(x, 6)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("P" & (x)).Formula = "=SUM(P4:P" & (x - 1) & ")"
        worksheet110.Cells(x, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 16).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 16).Font.size = 10
        'range1 = worksheet11.Cells(x, 7)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet110.Range("Q" & (x)).Formula = "=SUM(Q4:Q" & (x - 1) & ")"
        worksheet110.Cells(x, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet110.Cells(x, 17).Font.Name = "Times New Roman"
        worksheet110.Cells(x, 17).Font.size = 10
        ' range1 = worksheet11.Cells(x, 8)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet110.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet110.Range("K" & x & ":" & "K" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("L" & x & ":" & "L" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("N" & x & ":" & "N" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("O" & x & ":" & "O" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("P" & x & ":" & "P" & x).Interior.Color = RGB(219, 238, 243)
        worksheet110.Range("Q" & x & ":" & "Q" & x).Interior.Color = RGB(219, 238, 243)
        '----------------------------------------------------------------------------------------------
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet110.ChartObjects
        z1 = x * 15
        z1 = z1 + 50
        Dim rh As Double

        rh = (x - 2) * 15
        rh = rh + 12.5
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet110.Range("C4", "C" & (x - 2))
        chartRange1 = worksheet110.Range("A4", "A" & (x - 2))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        '  t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet110.Range("D4", "D" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Yarn dye & Marl"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("E4", "E" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("F4", "F" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("G4", "G" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("H4", "H" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Air flow Batch Distribution  (Weekly)")


        xlCharts = worksheet110.ChartObjects
        z1 = z1 + 360
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet110.Range("L4", "L" & (x - 2))
        chartRange1 = worksheet110.Range("J4", "J" & (x - 2))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(200, 64, 181)
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(200, 64, 181)
        chartPage.Refresh()
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet110.Range("M4", "M" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Yarn dye & Marl"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("N4", "N" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("O4", "O" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("P4", "P" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet110.Range("Q4", "Q" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("WaterJet Batch Distribution(Weekly)")
    End Function

    Function ShadeDis_Monthly()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet111 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet111.Name = "Shade Distribution Monthly"

        'page Header
        worksheet111.Cells(1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet111.Cells(1, 1) = "Air flow Batch Distribution  (Monthly)"
        worksheet111.Cells(1, 1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet111.Rows(1).Font.Bold = True
        worksheet111.Rows(1).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet111.Columns("A").ColumnWidth = 10
        worksheet111.Columns("B").ColumnWidth = 10
        worksheet111.Columns("C").ColumnWidth = 10
        worksheet111.Columns("D").ColumnWidth = 10
        worksheet111.Columns("E").ColumnWidth = 10
        worksheet111.Columns("F").ColumnWidth = 10
        worksheet111.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet111.Columns("H").ColumnWidth = 10


        ' worksheet111.Range(worksheet111.Cells(1, 1), worksheet111.Cells(1, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet111.Cells(1, 1).VerticalAlignment = XlVAlign.xlVAlignDistributed
        range1 = worksheet111.Cells(1, 1)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet111.Range("A1", "H1").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("A1:H1").Interior.Color = RGB(215, 228, 188)
        worksheet111.Rows(2).Font.size = 10

        worksheet111.Cells(2, 2) = "No. of  batches"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet111.Rows(2).Font.size = 10
        worksheet111.Range(worksheet111.Cells(2, 2), worksheet111.Cells(2, 6)).Merge()
        worksheet111.Range(worksheet111.Cells(2, 2), worksheet111.Cells(2, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet111.Range("A1", "B1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("A1", "H1").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H1", "H1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H1", "H1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("A2", "A2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H2", "H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H2", "H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("A1:A3").Interior.Color = RGB(215, 228, 188)
        worksheet111.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        ' worksheet11.Range("A1:A2").Interior.Color = RGB(255, 255, 255)
        worksheet111.Cells(3, 2) = "Colours"
        worksheet111.Cells(3, 2).Font.Bold = True
        worksheet111.Cells(3, 2).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 2).Font.size = 8

        worksheet111.Cells(3, 2).WrapText = True
        worksheet111.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B2", "B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 2)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet111.Range("B3:B3").Interior.Color = RGB(215, 228, 188)
        'worksheet11.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        worksheet111.Cells(3, 3) = "White"
        worksheet111.Cells(3, 3).Font.Bold = True
        worksheet111.Cells(3, 3).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 3).Font.size = 8

        worksheet111.Cells(3, 3).WrapText = True
        worksheet111.Cells(3, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("C3", "C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 3)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("C3:C3").Interior.Color = RGB(215, 228, 188)


        worksheet111.Cells(3, 4) = "Yarn dye & Marl"
        worksheet111.Cells(3, 4).Font.Bold = True
        worksheet111.Cells(3, 4).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 4).Font.size = 8

        worksheet111.Cells(3, 4).WrapText = True
        worksheet111.Cells(3, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("D3", "D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 4)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("D3:D3").Interior.Color = RGB(215, 228, 188)

        worksheet111.Cells(3, 5) = "Light"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 5).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 5).Font.size = 8

        worksheet111.Cells(3, 5).WrapText = True
        worksheet111.Cells(3, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("E3", "E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 5)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("E3:E3").Interior.Color = RGB(215, 228, 188)

        worksheet111.Cells(3, 6) = "Medium"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 6).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 6).Font.size = 8

        worksheet111.Cells(3, 6).WrapText = True
        worksheet111.Cells(3, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("F3", "F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("F3:F3").Interior.Color = RGB(215, 228, 188)



        worksheet111.Cells(3, 7) = "Dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 7).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 7).Font.size = 8

        worksheet111.Cells(3, 7).WrapText = True
        worksheet111.Cells(3, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("G3", "G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("G3:G3").Interior.Color = RGB(215, 228, 188)

        worksheet111.Cells(3, 8) = "Extra dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 8).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 8).Font.size = 8

        worksheet111.Cells(3, 8).WrapText = True
        worksheet111.Cells(3, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H3", "H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 6)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("H3:H3").Interior.Color = RGB(215, 228, 188)


        worksheet111.Columns("I").ColumnWidth = 3
        '===========================================================================================================
        '===========================================================================================================
        worksheet111.Cells(1).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet111.Cells(1, 10) = "WaterJet Batch Distribution(Monthly)"
        ' worksheet11.Rows(1).Font.Bold = True
        ' worksheet11.Rows(1).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet111.Columns("J").ColumnWidth = 10
        worksheet111.Columns("K").ColumnWidth = 10
        worksheet111.Columns("L").ColumnWidth = 10
        worksheet111.Columns("M").ColumnWidth = 10
        worksheet111.Columns("N").ColumnWidth = 10
        worksheet111.Columns("O").ColumnWidth = 10
        worksheet111.Columns("P").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet111.Columns("Q").ColumnWidth = 10


        worksheet111.Range(worksheet111.Cells(1, 10), worksheet111.Cells(1, 17)).Merge()
        worksheet111.Range(worksheet111.Cells(1, 10), worksheet111.Cells(1, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet111.Cells(1, 17)

        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet111.Range("J1", "Q1").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        'range1.Borders.LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("J1:Q1").Interior.Color = RGB(215, 228, 188)
        worksheet111.Rows(2).Font.size = 10

        worksheet111.Cells(2, 11) = "No. of  batches"
        '  worksheet13.Rows(7).Font.Bold = True
        worksheet111.Rows(2).Font.size = 10
        worksheet111.Range(worksheet111.Cells(2, 11), worksheet111.Cells(2, 17)).Merge()
        worksheet111.Range(worksheet111.Cells(2, 11), worksheet111.Cells(2, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet111.Range("J1", "J1").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J1", "K1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J1", "Q1").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q1", "Q1").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J1", "J1").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J2", "J2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J2", "Q2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q2", "Q2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("M2", "M2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J1:J3").Interior.Color = RGB(215, 228, 188)
        worksheet111.Range("K2:K2").Interior.Color = RGB(215, 228, 188)
        worksheet111.Range("J2", "J2").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J3", "J3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Cells(3, 11) = "Colours"
        worksheet111.Cells(3, 11).Font.Bold = True
        worksheet111.Cells(3, 11).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 11).Font.size = 8

        worksheet111.Cells(3, 11).WrapText = True
        worksheet111.Cells(3, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("K3", "K3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K3", "K3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K2", "K3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 11)
        range1.Font.Color = RGB(255, 0, 0)
        worksheet111.Range("K3:K3").Interior.Color = RGB(215, 228, 188)
        'worksheet11.Range("B2:H2").Interior.Color = RGB(215, 228, 188)
        worksheet111.Cells(3, 12) = "White"
        worksheet111.Cells(3, 12).Font.Bold = True
        worksheet111.Cells(3, 12).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 12).Font.size = 8

        worksheet111.Cells(3, 12).WrapText = True
        worksheet111.Cells(3, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("L3", "L3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 12)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("L3:L3").Interior.Color = RGB(215, 228, 188)


        worksheet111.Cells(3, 13) = "Yarn dye & Marl"
        worksheet111.Cells(3, 13).Font.Bold = True
        worksheet111.Cells(3, 13).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 13).Font.size = 8

        worksheet111.Cells(3, 13).WrapText = True
        worksheet111.Cells(3, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("M3", "M3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 13)
        range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("M3:M3").Interior.Color = RGB(215, 228, 188)

        worksheet111.Cells(3, 14) = "Light"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 14).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 14).Font.size = 8

        worksheet111.Cells(3, 14).WrapText = True
        worksheet111.Cells(3, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 14)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("N3:N3").Interior.Color = RGB(215, 228, 188)

        worksheet111.Cells(3, 15) = "Medium"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 15).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 15).Font.size = 8

        worksheet111.Cells(3, 15).WrapText = True
        worksheet111.Cells(3, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("O3", "O3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 15)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("O3:O3").Interior.Color = RGB(215, 228, 188)



        worksheet111.Cells(3, 16) = "Dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 16).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 16).Font.size = 8

        worksheet111.Cells(3, 16).WrapText = True
        worksheet111.Cells(3, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("P3", "P3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 16)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("P3:P3").Interior.Color = RGB(215, 228, 188)

        worksheet111.Cells(3, 17) = "Extra dark"
        ' worksheet11.Cells(3, 5).Font.Bold = True
        worksheet111.Cells(3, 17).Font.Name = "Times New Roman"
        worksheet111.Cells(3, 17).Font.size = 8

        worksheet111.Cells(3, 17).WrapText = True
        worksheet111.Cells(3, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q3", "Q3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("A3", "A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet111.Cells(3, 17)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("Q3:Q3").Interior.Color = RGB(215, 228, 188)



        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        '  n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT month(m04Etime) as [Ddate],year(m04Etime) as [Eyear] FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY month(m04Etime),year(m04Etime) order by year(m04Etime),month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            'worksheet111.Cells(x, 1) = T01.Tables(0).Rows(i)("Ddate")
            worksheet111.Cells(x, 1) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet111.Cells(x, 1).EntireColumn.NumberFormat = "MM-yy"
            worksheet111.Rows(x).Font.size = 10
            worksheet111.Cells(x, 10) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            ' worksheet111.Cells(x, 10) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            'worksheet111.Cells(x, 10).EntireColumn.NumberFormat = "MM-yy"
            worksheet111.Rows(x).Font.size = 10

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer

            ' MsgBox((T01.Tables(0).Rows(i)("ddate")))
            x_date = (T01.Tables(0).Rows(i)("ddate")) & "/1/" & (T01.Tables(0).Rows(i)("EYear"))
            '  x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = x_date & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"


            'COLOUR

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 2) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 2)
                range1.Font.Color = RGB(255, 0, 0)

            End If
            worksheet111.Range("B" & x & ":" & "B" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 11) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 11)
                range1.Font.Color = RGB(255, 0, 0)

            End If
            worksheet111.Range("K" & x & ":" & "K" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------------------------
            'WHITE
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08CL='White' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 3) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 3)
                range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet111.Range("C" & x & ":" & "C" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08CL='White' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 12) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 12)
                range1.Font.Color = RGB(0, 0, 255)

            End If

            worksheet111.Range("L" & x & ":" & "L" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '-------------------------------------------------------------------------------------
            'Yarn dye & Marl
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08CL='MARL & Yarn dye' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 4) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 4)
                range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet111.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08CL='MARL & Yarn dye' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 13) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 13)
                range1.Font.Color = RGB(0, 0, 255)

            End If

            worksheet111.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '-------------------------------------------------------------------------------
            'LIGHT
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
              "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
              " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Light' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 5) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Light' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 14) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 14)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '------------------------------------------------------------------------------------
            'Medium

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
             "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
             " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Medium' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 6) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 6)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("DDate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Medium' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 15) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 15)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------
            'DARK
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Dark' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 7) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 7)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Dark' group by M04Lotno,M08SubName "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 16) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 16)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '--------------------------------------------------------------------------------
            'Extra dark

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Extra Dark' group by M04Lotno,M08SubName "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 8) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 8)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            ' worksheet11.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("Ddate") & "' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType='N' and M08SubName='Extra Dark' group by M04Lotno,M08SubName having count(M08SubName)=1 "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet111.Cells(x, 17) = T03.Tables(0).Rows.Count
                range1 = worksheet111.Cells(x, 17)
                '  range1.Font.Color = RGB(0, 0, 255)

            End If

            ' worksheet11.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
            worksheet111.Cells(x, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet111.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet111.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            ' worksheet11.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet111.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next
        worksheet111.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        ' worksheet11.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1

        ' worksheet1Function.Sum(worksheet11.Range("G1:G5000"))
        worksheet111.Cells(x, 1) = "Total"
        worksheet111.Cells(x, 1).Font.Bold = True
        worksheet111.Cells(x, 1).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 1).Font.size = 10
        worksheet111.Cells(x, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("B" & (x)).Formula = "=SUM(B4:B" & (x - 1) & ")"
        worksheet111.Cells(x, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 2).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 2).Font.size = 10
        range1 = worksheet111.Cells(x, 2)
        range1.Font.Color = RGB(255, 0, 0)


        worksheet111.Range("C" & (x)).Formula = "=SUM(C4:C" & (x - 1) & ")"
        worksheet111.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 3).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 3).Font.size = 10
        range1 = worksheet111.Cells(x, 3)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("D" & (x)).Formula = "=SUM(D4:D" & (x - 1) & ")"
        worksheet111.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 4).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 4).Font.size = 10
        range1 = worksheet111.Cells(x, 4)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("E" & (x)).Formula = "=SUM(E4:E" & (x - 1) & ")"
        worksheet111.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 5).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 5).Font.size = 10
        'range1 = worksheet11.Cells(x, 5)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("F" & (x)).Formula = "=SUM(F4:F" & (x - 1) & ")"
        worksheet111.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 6).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 6).Font.size = 10
        'range1 = worksheet11.Cells(x, 6)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("G" & (x)).Formula = "=SUM(G4:G" & (x - 1) & ")"
        worksheet111.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 7).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 7).Font.size = 10
        'range1 = worksheet11.Cells(x, 7)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("H" & (x)).Formula = "=SUM(H4:H" & (x - 1) & ")"
        worksheet111.Cells(x, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 8).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 8).Font.size = 10
        ' range1 = worksheet11.Cells(x, 8)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("B" & x & ":" & "B" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("C" & x & ":" & "C" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("D" & x & ":" & "D" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("E" & x & ":" & "E" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("F" & x & ":" & "F" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("G" & x & ":" & "G" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("H" & x & ":" & "H" & x).Interior.Color = RGB(219, 238, 243)



        worksheet111.Cells(x, 10) = "Total"
        worksheet111.Cells(x, 10).Font.Bold = True
        worksheet111.Cells(x, 10).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 10).Font.size = 10
        worksheet111.Cells(x, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet111.Range("K" & (x)).Formula = "=SUM(K4:K" & (x - 1) & ")"
        worksheet111.Cells(x, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 11).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 11).Font.size = 10
        range1 = worksheet111.Cells(x, 11)
        range1.Font.Color = RGB(255, 0, 0)


        worksheet111.Range("L" & (x)).Formula = "=SUM(L4:L" & (x - 1) & ")"
        worksheet111.Cells(x, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 12).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 12).Font.size = 10
        range1 = worksheet111.Cells(x, 12)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("M" & (x)).Formula = "=SUM(M4:M" & (x - 1) & ")"
        worksheet111.Cells(x, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 13).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 13).Font.size = 10
        range1 = worksheet111.Cells(x, 13)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("N" & (x)).Formula = "=SUM(N4:N" & (x - 1) & ")"
        worksheet111.Cells(x, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 14).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 14).Font.size = 10
        'range1 = worksheet11.Cells(x, 5)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("O" & (x)).Formula = "=SUM(O4:O" & (x - 1) & ")"
        worksheet111.Cells(x, 15).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 15).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 15).Font.size = 10
        'range1 = worksheet11.Cells(x, 6)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("P" & (x)).Formula = "=SUM(P4:P" & (x - 1) & ")"
        worksheet111.Cells(x, 16).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 16).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 16).Font.size = 10
        'range1 = worksheet11.Cells(x, 7)
        'range1.Font.Color = RGB(0, 0, 255)

        worksheet111.Range("Q" & (x)).Formula = "=SUM(Q4:Q" & (x - 1) & ")"
        worksheet111.Cells(x, 17).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Cells(x, 2).Font.Bold = True
        worksheet111.Cells(x, 17).Font.Name = "Times New Roman"
        worksheet111.Cells(x, 17).Font.size = 10
        ' range1 = worksheet11.Cells(x, 8)
        '  range1.Font.Color = RGB(0, 0, 255)
        worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet111.Range("Q" & x, "Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet111.Range("K" & x & ":" & "K" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("L" & x & ":" & "L" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("M" & x & ":" & "M" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("N" & x & ":" & "N" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("O" & x & ":" & "O" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("P" & x & ":" & "P" & x).Interior.Color = RGB(219, 238, 243)
        worksheet111.Range("Q" & x & ":" & "Q" & x).Interior.Color = RGB(219, 238, 243)
        '----------------------------------------------------------------------------------------------
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim rh As Double
        xlCharts = worksheet111.ChartObjects
        z1 = x * 15
        z1 = z1 + 50

        rh = (x - 1) * 15
        rh = rh + 22.5
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet111.Range("C4", "C" & (x - 2))
        chartRange1 = worksheet111.Range("A4", "A" & (x - 2))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        '  t_Series.Border.Color = RGB(255, 215, 0)
        chartPage.Refresh()
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet111.Range("D4", "D" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Yarn dye & Marl"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("E4", "E" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("F4", "F" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("G4", "G" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("H4", "H" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Air flow Batch Distribution  (Daily)")


        xlCharts = worksheet111.ChartObjects
        z1 = z1 + 360
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet111.Range("L4", "L" & (x - 2))
        chartRange1 = worksheet111.Range("J4", "J" & (x - 2))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        ' t_Series.Border.Color = RGB(200, 64, 181)
        'chartPage.SeriesCollection(1).Interior.Color = RGB(200, 64, 181)
        chartPage.Refresh()
        '  chartPage.SeriesCollection(1).Interior.Color = RGB(255, 215, 0)
        chartRange = worksheet111.Range("M4", "M" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Yarn dye & Marl"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("N4", "N" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("O4", "O" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("P4", "P" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartRange = worksheet111.Range("Q4", "Q" & (x - 2))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra dark"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE
        End With

        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("WaterJet Batch Distribution(Monthly)")
    End Function

    Function Weekly_AFInefficiency()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet112 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet112.Name = "Weekly Inefficiency (AF)"

        'page Header
        worksheet112.Cells(2).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet112.Cells(2, 2) = "Air flow machine (LR1-LR9) utilization and  down time + delay time analysis"
        worksheet112.Rows(2).Font.Bold = True
        worksheet112.Rows(2).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet112.Columns("A").ColumnWidth = 3
        worksheet112.Columns("B").ColumnWidth = 10
        worksheet112.Columns("C").ColumnWidth = 10
        worksheet112.Columns("D").ColumnWidth = 10
        worksheet112.Columns("E").ColumnWidth = 10
        worksheet112.Columns("F").ColumnWidth = 10
        worksheet112.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet112.Columns("H").ColumnWidth = 18
        worksheet112.Columns("I").ColumnWidth = 3
        worksheet112.Columns("J").ColumnWidth = 10
        worksheet112.Columns("K").ColumnWidth = 10
        worksheet112.Columns("L").ColumnWidth = 10
        worksheet112.Columns("M").ColumnWidth = 10
        worksheet112.Columns("N").ColumnWidth = 10
        '  worksheet11.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        ' worksheet11.Columns("H").ColumnWidth = 15

        'worksheet11.Range(worksheet11.Cells(1, 2), worksheet11.Cells(2, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet112.Cells(2, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet112.Range(worksheet112.Cells(2, 2), worksheet112.Cells(2, 14)).Merge()
        ' worksheet11.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("B2", "N2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Cells(3, 2) = "Daily / per machine(hrs)"
        worksheet112.Rows(3).Font.Bold = True
        worksheet112.Rows(3).Font.size = 10
        worksheet112.Range("B3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range(worksheet112.Cells(3, 2), worksheet112.Cells(3, 14)).Merge()
        worksheet112.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Cells(4, 2) = "Week No."
        worksheet112.Cells(4, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 2).Font.size = 10
        worksheet112.Cells(4, 2).WrapText = True
        worksheet112.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet112.Cells(4, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet112.Cells(4, 4) = "Actual STD running  Time "
        worksheet112.Cells(4, 4).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 4).Font.size = 10
        'worksheet11.Cells(4, 4).WrapText = True
        'worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("G4", "G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range(worksheet112.Cells(4, 3), worksheet112.Cells(4, 7)).Merge()
        ' worksheet11.Cells(4, 4).WrapText = True
        worksheet112.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet112.Cells(4, 8) = "Total"
        worksheet112.Cells(4, 8).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 8).Font.size = 10
        worksheet112.Cells(4, 8).Font.Bold = True
        'worksheet11.Cells(4, 8).WrapText = True
        worksheet112.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("H4", "H4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("C4", "H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("H4:H4").Interior.Color = RGB(255, 204, 0)


        worksheet112.Cells(4, 10) = "Boil out"
        worksheet112.Cells(4, 10).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 10).Font.size = 10
        'worksheet11.Cells(4, 10).WrapText = True
        worksheet112.Cells(4, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("I4", "I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("J4", "J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Cells(4, 11) = "M/C down time"
        worksheet112.Cells(4, 11).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 11).Font.size = 10
        ' worksheet11.Cells(4, 11).WrapText = True
        worksheet112.Cells(4, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("L4", "L4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range(worksheet112.Cells(4, 11), worksheet112.Cells(4, 12)).Merge()
        worksheet112.Cells(4, 13) = "Delay time"
        worksheet112.Cells(4, 13).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 13).Font.size = 10
        'worksheet11.Cells(4, 13).WrapText = True
        worksheet112.Cells(4, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("M4", "M4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Cells(4, 14) = "Total delay"
        worksheet112.Cells(4, 14).Font.Name = "Times New Roman"
        worksheet112.Cells(4, 14).Font.size = 10
        worksheet112.Cells(4, 14).Font.BOLD = True
        ' worksheet11.Cells(4, 14).WrapText = True
        worksheet112.Cells(4, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("N4", "N4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("N4:N4").Interior.Color = RGB(255, 204, 0)

        worksheet112.Cells(5, 3) = "Production "
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(5, 3).Font.size = 10
        'worksheet11.Cells(5, 3).WrapText = True
        worksheet112.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("C5", "D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 3).WrapText = True
        worksheet112.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range(worksheet112.Cells(5, 3), worksheet112.Cells(5, 4)).Merge()


        worksheet112.Cells(5, 5) = "Redye "
        worksheet112.Cells(5, 5).Font.size = 10
        worksheet112.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("F5", "F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("E5", "F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range(worksheet112.Cells(5, 5), worksheet112.Cells(5, 6)).Merge()



        worksheet112.Cells(5, 7) = "Reprocess"
        worksheet112.Cells(5, 7).Font.size = 10
        worksheet112.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 7).WrapText = True
        worksheet112.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet112.Cells(5, 8) = "M/c Utilization factor"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(5, 8).Font.size = 10
        worksheet112.Cells(5, 8).Font.BOLD = True
        worksheet112.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet112.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("H5:H5").Interior.Color = RGB(255, 204, 0)


        worksheet112.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("J4:J5").Interior.Color = RGB(255, 255, 255)
        worksheet112.Range("K5", "L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("L5", "L5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("K4:K5").Interior.Color = RGB(255, 255, 255)
        worksheet112.Range("L4:L5").Interior.Color = RGB(255, 255, 255)

        worksheet112.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet112.Range("M5:M5").Interior.Color = RGB(255, 255, 255)


        worksheet112.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet112.Range("N5:N5").Interior.Color = RGB(255, 204, 0)


        worksheet112.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("B4", "B6").Merge()
        worksheet112.Rows(6).rowheight = 50.25


        worksheet112.Cells(6, 3) = "Color"
        worksheet112.Cells(6, 3).Font.size = 9
        worksheet112.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 3).WrapText = True
        worksheet112.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet112.Cells(6, 4) = "White"
        worksheet112.Cells(6, 4).Font.size = 9
        worksheet112.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 4).WrapText = True
        worksheet112.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 5) = "Color"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 5).Font.size = 9
        worksheet112.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 5).WrapText = True
        worksheet112.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 6) = "White"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 6).Font.size = 9
        worksheet112.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 6).WrapText = True
        worksheet112.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 7) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 7).Font.size = 9
        worksheet112.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 7).WrapText = True
        worksheet112.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 8) = "(STD running time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 8).Font.size = 9
        worksheet112.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 8).WrapText = True
        worksheet112.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("H6:H6").Interior.Color = RGB(255, 204, 0)

        worksheet112.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Cells(6, 10) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 10).Font.size = 10
        worksheet112.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 10).WrapText = True
        worksheet112.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 11) = "Fabric delay + dye tech + maintenance(hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 11).Font.size = 9
        worksheet112.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 11).WrapText = True
        worksheet112.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 12) = "No work (hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 12).Font.size = 9
        worksheet112.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 12).WrapText = True
        worksheet112.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 13) = "Fresh bulk+RD+RP (actual - standard time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 13).Font.size = 9
        worksheet112.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 13).WrapText = True
        worksheet112.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet112.Cells(6, 14) = "Boil out + down time + delay"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet112.Cells(6, 14).Font.size = 10
        worksheet112.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Cells(6, 14).WrapText = True
        worksheet112.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet112.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet112.Range("N6:N6").Interior.Color = RGB(255, 204, 0)
        '----------------------------------------------------------------------------------------------------------
        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','F') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        Dim M3 As Integer
        M3 = 7
        ' Dim Y As Integer
        Y = 2
        x = 7
        Overall_IAFFAF = 7
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet112.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            worksheet112.Rows(x).Font.size = 10
            worksheet112.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------PRODUCTION
            Dim N_TAKEN As Double
            N_TAKEN = 0

            Dim datDatum As Date
            Dim intWkNo As Integer
            Dim F As Integer

            Dim yX As Short
            Dim w As Short
            Dim d As Short
            Dim sDate As Date
            yX = T01.Tables(0).Rows(i)("EYEAR")
            w = T01.Tables(0).Rows(i)("m04week")
            sDate = CDate("01/01/" & yX)

            intWkNo = Weekday(sDate, vbSunday)

            If intWkNo = 1 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Sunday)
            ElseIf intWkNo = 2 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Monday)
            ElseIf intWkNo = 3 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Tuesday)
            ElseIf intWkNo = 4 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Wednesday)
            ElseIf intWkNo = 5 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Thursday)
            ElseIf intWkNo = 6 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Friday)
            ElseIf intWkNo = 7 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Saturday)
            End If
            sDate = DateAdd(Microsoft.VisualBasic.DateInterval.WeekOfYear, w - 1, CDate("01/" & d & "/" & yX))

            datDatum = CDate(sDate).AddDays(-6)
            'sDate = CDate(sDate).AddDays(+1)
            'COLOR
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(datDatum)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(datDatum)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    sDate = CDate(datDatum).AddDays(+L_DateofMonth)
                    sDate = CDate(sDate).AddDays(+1)
                End If
            Else
                sDate = CDate(sDate).AddDays(+1)
                'End If
            End If
            datDatum = datDatum & " " & "7:30AM"
            sDate = sDate & " " & "7:30AM"
            'COLOR 
            '***************************************BLOCK BY SURANGA R WIJESINGHE ON 9/2/2013 2:30 PM
            '***************************************CREATE NEW SQL QUARRY ON 9/2/2013
            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType IN ('N','F') and M08CL='Colour' group by M04Week "

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & datDatum & "' and '" & sDate & "' and  M04ProgrameType IN ('N','F') and M08CL='Colour' group by M08CL "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / 63
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Cells(x, Y) = N_TAKEN
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------------------------
            'WHITE
            N_TAKEN = 0

            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType IN ('N','F') and M08CL IN ('White','MARL & Yarn dye') group by M04Week "

            F = 0
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & datDatum & "' and '" & sDate & "'  and M04ProgrameType IN ('N','F') and M08CL IN ('White','MARL & Yarn dye') group by M08CL "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TAKEN = N_TAKEN + T03.Tables(0).Rows(F)("M04Taken")

                F = F + 1
            Next
            N_TAKEN = N_TAKEN / 63
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Cells(x, Y) = N_TAKEN
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-------------------------------------------------------------------
            N_TAKEN = 0
            'COLOR
            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType IN ('R') and M08CL='Colour' group by M04Week "
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & datDatum & "' and '" & sDate & "' and  M04ProgrameType IN ('R') and M08CL='Colour' group by M08CL "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / 63
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Cells(x, Y) = N_TAKEN
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------------------------
            'Redye
            N_TAKEN = 0

            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType ='R' and M08CL IN ('White','MARL & Yarn dye') group by M04Week "
            F = 0
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & datDatum & "' and '" & sDate & "' and  M04ProgrameType ='R' and M08CL IN ('White','MARL & Yarn dye') group by M08CL "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TAKEN = N_TAKEN + T03.Tables(0).Rows(F)("M04Taken")

                F = F + 1
            Next
            N_TAKEN = N_TAKEN / 63
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Cells(x, Y) = N_TAKEN
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-----------------------------------------------------------------------------------------------------------
            N_TAKEN = 0

            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType not in ('R','N','F','I','D','B') group by M04Week "

            F = 0
            N_TAKEN = 0
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & datDatum & "' and '" & sDate & "' and  M04ProgrameType not in ('R','N','F','I','D','B') group by M04ProgrameType "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                N_TAKEN = N_TAKEN + T03.Tables(0).Rows(F)("M04Taken")

                F = F + 1
            Next
            N_TAKEN = N_TAKEN / 63
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Cells(x, Y) = N_TAKEN
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------

            worksheet112.Range("H" & (x)).Formula = "=SUM(C" & x & ":G" & x & ")"
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet112.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 2
            '-----------------------------------------------------------------
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim Z As Integer
            Dim n_count As Integer
            Dim M1 As Integer


            SQL = "SELECT max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE='02' and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by m04year  order by m04year"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '  If isValidDataset(T03) Then
            n_count = 0
            N_TAKEN = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                N_TAKEN = N_TAKEN + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next


            Dim X1 As Integer
            Dim X2 As Integer

            X1 = (24 * 9 * 7) * 60
            X2 = N_TAKEN
            worksheet112.Cells(x, Y) = X2 / X1
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ' worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 18)
            range1 = worksheet112.Cells(x, Y)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet112.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            ' range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1
            worksheet112.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            n_per = 0
            M1 = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T01Machine NOT IN ('18','19','20')   AND t01weekno='" & T01.Tables(0).Rows(i)("m04Week") & "' and M05Name in ('Fabric','PM','MainM','TechD') AND t01date between '" & n_Date & "' and '" & N_Date1 & "' and T03TYPE='02' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                M1 = M1 + 1
            Next
            Dim N_TOTALHR As Integer

            N_TOTALHR = 24 * 9 * 60 * 7

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet112.Cells(x, Y) = n_per
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Rows(x).Font.size = 10

            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            Y = Y + 1
            ' worksheet11.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            n_per = 0
            M1 = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T01Machine NOT IN ('18','19','20')   AND t01weekno='" & T01.Tables(0).Rows(i)("m04Week") & "' and M05Name in ('No Work') AND t01date between '" & n_Date & "' and '" & N_Date1 & "' and T03TYPE='02' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                M1 = M1 + 1
            Next
            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet112.Cells(x, Y) = n_per
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Rows(x).Font.size = 10

            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            Y = Y + 1
            ' worksheet11.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            Dim txtYear As String
            Dim tmpDate As Date
            Dim Ydate As Integer
            Dim N_STD1 As Integer
            Dim N_STD2 As Integer

            'Ydate = T01.Tables(0).Rows(i)("M04week")
            'Ydate = Ydate * 7
            'txtYear = (T01.Tables(0).Rows(i)("Eyear"))
            'Dim x_date As Date
            'Dim x_date1 As Date
            'tmpDate = System.DateTime.FromOADate(CDate("01/01/" & txtYear).ToOADate - Weekday(CDate("01/01/" & txtYear), FirstDayOfWeek.Monday) + 1)

            'If T01.Tables(0).Rows(i)("M04Week") = "1" Then
            '    x_date = "1/1/" & txtYear
            'Else
            '    x_date = CDate(tmpDate).AddDays(+Ydate)
            'End If
            'Dim thisCulture1 = Globalization.CultureInfo.CurrentCulture
            'Dim dayOfWeek1 As DayOfWeek = thisCulture1.Calendar.GetDayOfWeek(x_date)
            'Dim dayName1 As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek1)

            'If dayName1 = "Sunday" Then
            '    '  x_date = CDate(WeekStartDate()).AddDays(-6)
            'ElseIf dayName1 = "Tuesday" Then
            '    x_date = CDate(x_date).AddDays(-1)
            'ElseIf dayName1 = "Wednesday" Then
            '    x_date = CDate(x_date).AddDays(-2)
            'ElseIf dayName1 = "Thuesday" Then
            '    x_date = CDate(x_date).AddDays(-3)
            'ElseIf dayName1 = "Friday" Then
            '    x_date = CDate(x_date).AddDays(-4)
            'ElseIf dayName1 = "Saturday" Then
            '    x_date = CDate(x_date).AddDays(-5)
            'End If
            'x_date1 = CDate(x_date).AddDays(+7)
            'If x_date1 > txtTodate.Value Then
            '    'WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            'End If
            '' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            'x_date = tmpDate & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"

            'Dim N_TOTAL As Integer
            'Dim N_STD As Integer

            'N_TOTAL = 0
            'N_STD = 0
            'N_STD1 = 0
            'N_STD2 = 0
            'M1 = 0

            'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
            '      " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType order by CONVERT(VARCHAR(10) , M04Date_Out, 120)"
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
            '    If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
            '        N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
            '    Else
            '        N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
            '    End If
            '    M1 = M1 + 1
            'Next

            'M1 = 0
            'Dim M2 As Integer

            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120) as Ddate,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
            '     "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
            '     "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('02') " & _
            '     " GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04Lotno having count(M04Lotno)>1 "
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    Dim A1 As Date
            '    Dim A2 As Date

            '    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
            '      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
            '      "  T03TYPE IN ('02') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND M04Date_Out='" & T03.Tables(0).Rows(M1)("Ddate") & "'"
            '    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '    M2 = 0
            '    For Each DTRow5 As DataRow In T04.Tables(0).Rows
            '        If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Then
            '        Else
            '            N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
            '            N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
            '        End If
            '        M2 = M2 + 1
            '    Next

            '    M1 = M1 + 1
            'Next

            'N_STD = N_STD - N_STD1
            'N_STD = N_STD + N_STD2
            'Dim U1 As Double
            'U1 = (N_STD / N_TOTAL)
            ''If N_STD = 0 And N_TOTAL = 0 Then
            ''    worksheet112.Cells(x, Y) = "0"
            ''Else
            ''    If (1 - U1) > 0 Then
            ''        worksheet112.Cells(x, Y) = 1 - U1
            ''    Else
            ''        worksheet112.Cells(x, Y) = "0"
            ''    End If
            ''End If


            'worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'range1 = worksheet112.Cells(x, Y)
            'range1.NumberFormat = "0%"
            ''worksheet17.Rows(x).Font.size = 10
            ' Y = Y + 1
            worksheet112.Cells(x, Y) = "=1-'Weekly efficiency'!B" & M3
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet112.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            If CDbl(worksheet112.Range("M" & x).Value.ToString) > 0 Then

            Else
                worksheet112.Cells(x, Y) = "0"
            End If
            M3 = M3 + 1

            Y = Y + 1

            worksheet112.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet112.Range("N" & (x)).Formula = "=SUM(J" & x & ":M" & x & ")"
            worksheet112.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet112.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet112.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet112.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            Overall_IAFFAF = Overall_IAFFAF + 1
            x = x + 1
            i = i + 1
        Next



    End Function

    Function WEEKLYAF_INEFFICINCY()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet113 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet113.Name = "Weekly Inefficiency (WJ)"

        'page Header
        worksheet113.Cells(2).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet113.Cells(2, 2) = "Water jet  (ECO 02- ITM 23) utilization and  down time + delay time analysis"
        worksheet113.Rows(2).Font.Bold = True
        worksheet113.Rows(2).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet113.Columns("A").ColumnWidth = 3
        worksheet113.Columns("B").ColumnWidth = 10
        worksheet113.Columns("C").ColumnWidth = 10
        worksheet113.Columns("D").ColumnWidth = 10
        worksheet113.Columns("E").ColumnWidth = 10
        worksheet113.Columns("F").ColumnWidth = 10
        worksheet113.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet113.Columns("H").ColumnWidth = 18
        worksheet113.Columns("I").ColumnWidth = 3
        worksheet113.Columns("J").ColumnWidth = 10
        worksheet113.Columns("K").ColumnWidth = 10
        worksheet113.Columns("L").ColumnWidth = 10
        worksheet113.Columns("M").ColumnWidth = 10
        worksheet113.Columns("N").ColumnWidth = 10
        '  worksheet11.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        ' worksheet11.Columns("H").ColumnWidth = 15

        'worksheet11.Range(worksheet11.Cells(1, 2), worksheet11.Cells(2, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet113.Cells(2, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet113.Range(worksheet113.Cells(2, 2), worksheet113.Cells(2, 14)).Merge()
        ' worksheet11.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("B2", "N2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Cells(3, 2) = "Daily / per machine(hrs)"
        worksheet113.Rows(3).Font.Bold = True
        worksheet113.Rows(3).Font.size = 10
        worksheet113.Range("B3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range(worksheet113.Cells(3, 2), worksheet113.Cells(3, 14)).Merge()
        worksheet113.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Cells(4, 2) = "Week No."
        worksheet113.Cells(4, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 2).Font.size = 10
        worksheet113.Cells(4, 2).WrapText = True
        worksheet113.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet113.Cells(4, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet113.Cells(4, 4) = "Actual STD running  Time "
        worksheet113.Cells(4, 4).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 4).Font.size = 10
        'worksheet11.Cells(4, 4).WrapText = True
        'worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("G4", "G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range(worksheet113.Cells(4, 3), worksheet113.Cells(4, 7)).Merge()
        ' worksheet11.Cells(4, 4).WrapText = True
        worksheet113.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet113.Cells(4, 8) = "Total"
        worksheet113.Cells(4, 8).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 8).Font.size = 10
        worksheet113.Cells(4, 8).Font.Bold = True
        'worksheet11.Cells(4, 8).WrapText = True
        worksheet113.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("H4", "H4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("C4", "H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("H4:H4").Interior.Color = RGB(255, 204, 0)


        worksheet113.Cells(4, 10) = "Boil out"
        worksheet113.Cells(4, 10).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 10).Font.size = 10
        'worksheet11.Cells(4, 10).WrapText = True
        worksheet113.Cells(4, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("I4", "I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("J4", "J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Cells(4, 11) = "M/C down time"
        worksheet113.Cells(4, 11).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 11).Font.size = 10
        ' worksheet11.Cells(4, 11).WrapText = True
        worksheet113.Cells(4, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("L4", "L4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range(worksheet113.Cells(4, 11), worksheet113.Cells(4, 12)).Merge()
        worksheet113.Cells(4, 13) = "Delay time"
        worksheet113.Cells(4, 13).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 13).Font.size = 10
        'worksheet11.Cells(4, 13).WrapText = True
        worksheet113.Cells(4, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("M4", "M4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Cells(4, 14) = "Total delay"
        worksheet113.Cells(4, 14).Font.Name = "Times New Roman"
        worksheet113.Cells(4, 14).Font.size = 10
        worksheet113.Cells(4, 14).Font.BOLD = True
        ' worksheet11.Cells(4, 14).WrapText = True
        worksheet113.Cells(4, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("N4", "N4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("N4:N4").Interior.Color = RGB(255, 204, 0)

        worksheet113.Cells(5, 3) = "Production "
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(5, 3).Font.size = 10
        'worksheet11.Cells(5, 3).WrapText = True
        worksheet113.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("C5", "D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 3).WrapText = True
        worksheet113.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range(worksheet113.Cells(5, 3), worksheet113.Cells(5, 4)).Merge()


        worksheet113.Cells(5, 5) = "Redye "
        worksheet113.Cells(5, 5).Font.size = 10
        worksheet113.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("F5", "F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("E5", "F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range(worksheet113.Cells(5, 5), worksheet113.Cells(5, 6)).Merge()



        worksheet113.Cells(5, 7) = "Reprocess"
        worksheet113.Cells(5, 7).Font.size = 10
        worksheet113.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 7).WrapText = True
        worksheet113.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet113.Cells(5, 8) = "M/c Utilization factor"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(5, 8).Font.size = 10
        worksheet113.Cells(5, 8).Font.BOLD = True
        worksheet113.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet113.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("H5:H5").Interior.Color = RGB(255, 204, 0)


        worksheet113.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("J4:J5").Interior.Color = RGB(255, 255, 255)
        worksheet113.Range("K5", "L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("L5", "L5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("K4:K5").Interior.Color = RGB(255, 255, 255)
        worksheet113.Range("L4:L5").Interior.Color = RGB(255, 255, 255)

        worksheet113.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet113.Range("M5:M5").Interior.Color = RGB(255, 255, 255)


        worksheet113.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet113.Range("N5:N5").Interior.Color = RGB(255, 204, 0)


        worksheet113.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("B4", "B6").Merge()
        worksheet113.Rows(6).rowheight = 50.25


        worksheet113.Cells(6, 3) = "Color"
        worksheet113.Cells(6, 3).Font.size = 9
        worksheet113.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 3).WrapText = True
        worksheet113.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet113.Cells(6, 4) = "White"
        worksheet113.Cells(6, 4).Font.size = 9
        worksheet113.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 4).WrapText = True
        worksheet113.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 5) = "Color"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 5).Font.size = 9
        worksheet113.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 5).WrapText = True
        worksheet113.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 6) = "White"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 6).Font.size = 9
        worksheet113.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 6).WrapText = True
        worksheet113.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 7) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 7).Font.size = 9
        worksheet113.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 7).WrapText = True
        worksheet113.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 8) = "(STD running time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 8).Font.size = 9
        worksheet113.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 8).WrapText = True
        worksheet113.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("H6:H6").Interior.Color = RGB(255, 204, 0)

        worksheet113.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Cells(6, 10) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 10).Font.size = 10
        worksheet113.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 10).WrapText = True
        worksheet113.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 11) = "Fabric delay + dye tech + maintenance(hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 11).Font.size = 9
        worksheet113.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 11).WrapText = True
        worksheet113.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 12) = "No work (hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 12).Font.size = 9
        worksheet113.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 12).WrapText = True
        worksheet113.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 13) = "Fresh bulk+RD+RP (actual - standard time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 13).Font.size = 9
        worksheet113.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 13).WrapText = True
        worksheet113.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet113.Cells(6, 14) = "Boil out + down time + delay"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet113.Cells(6, 14).Font.size = 10
        worksheet113.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Cells(6, 14).WrapText = True
        worksheet113.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet113.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet113.Range("N6:N6").Interior.Color = RGB(255, 204, 0)
        '----------------------------------------------------------------------------------------------------------
        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        Dim M3 As Integer
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"
        Overall_IAFFWJ = 0
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01') AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','F') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 7
        M3 = 7
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet113.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            worksheet113.Rows(x).Font.size = 10
            worksheet113.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------PRODUCTION
            Dim N_TAKEN As Double
            N_TAKEN = 0
            Dim datDatum As Date
            Dim intWkNo As Integer

            Dim yX As Short
            Dim w As Short
            Dim d As Short
            Dim sDate As Date
            yX = T01.Tables(0).Rows(i)("EYEAR")
            w = T01.Tables(0).Rows(i)("m04week")
            sDate = CDate("01/01/" & yX)

            intWkNo = Weekday(sDate, vbSunday)

            If intWkNo = 1 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Sunday)
            ElseIf intWkNo = 2 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Monday)
            ElseIf intWkNo = 3 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Tuesday)
            ElseIf intWkNo = 4 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Wednesday)
            ElseIf intWkNo = 5 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Thursday)
            ElseIf intWkNo = 6 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Friday)
            ElseIf intWkNo = 7 Then
                d = 7 - Weekday(sDate, FirstDayOfWeek.Saturday)
            End If
            sDate = DateAdd(Microsoft.VisualBasic.DateInterval.WeekOfYear, w - 1, CDate("01/" & d & "/" & yX))

            datDatum = CDate(sDate).AddDays(-6)
            '   sDate = CDate(sDate).AddDays(+1)
            'COLOR
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(datDatum)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(datDatum)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                    sDate = CDate(sDate).AddDays(+1)
                Else
                    sDate = CDate(datDatum).AddDays(+L_DateofMonth)
                    sDate = CDate(sDate).AddDays(+1)
                End If
            Else
                sDate = CDate(sDate).AddDays(+1)
                'End If
            End If
            datDatum = datDatum & " " & "7:30AM"
            sDate = sDate & " " & "7:30AM"

            '********************BLOCK BY SURANGA R WIJESINGHE
            '********************DATE   : 9/2/2013 11:10 am

            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType IN ('N','F') and M08CL='Colour' group by M04Week "

            '********************CREATE NEW SQL QUARRY BY SURANGA R WIJESINGHE
            '********************DATE   : 9/2/2013 11:10 AM

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & datDatum & "' and '" & sDate & "'  and M04ProgrameType IN ('N','F') and M08CL='Colour' group by M08CL "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / 126
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Cells(x, Y) = N_TAKEN
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------------------------
            'WHITE
            N_TAKEN = 0
            Dim F As Integer

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Machine_No NOT IN ('18','19','20') AND M04ETime between '" & datDatum & "' and '" & sDate & "'  and M04ProgrameType IN ('N','F') and M08CL IN ('White','MARL & Yarn dye') group by M08CL "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            F = 0
            For Each DTRow2 As DataRow In T03.Tables(0).Rows
                N_TAKEN = N_TAKEN + T03.Tables(0).Rows(F)("M04Taken")
                F = F + 1
            Next
            N_TAKEN = N_TAKEN / 126
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Cells(x, Y) = N_TAKEN
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-------------------------------------------------------------------
            N_TAKEN = 0
            'COLOR
            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType IN ('R') and M08CL='Colour' group by M04Week "

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & datDatum & "' and '" & sDate & "' and  M04ProgrameType IN ('R') and M08CL='Colour' group by M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / 126
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Cells(x, Y) = N_TAKEN
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------------------------
            'Redye
            N_TAKEN = 0

            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType ='R' and M08CL IN ('White','MARL & Yarn dye') group by M04Week "
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & datDatum & "' and '" & sDate & "' and  M04ProgrameType ='R' and M08CL IN ('White','MARL & Yarn dye') group by M08CL "

            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            F = 0
            For Each DTRow2 As DataRow In T03.Tables(0).Rows
                N_TAKEN = N_TAKEN + T03.Tables(0).Rows(F)("M04Taken")

                F = F + 1
            Next
            N_TAKEN = N_TAKEN / 126
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Cells(x, Y) = N_TAKEN
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-----------------------------------------------------------------------------------------------------------
            N_TAKEN = 0

            'SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
            '      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
            '      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' AND M04Machine_No NOT IN ('18','19','20') and M04Week='" & T01.Tables(0).Rows(i)("M04Week") & "' and M04ProgrameType not in ('R','N','F','I','D','B') group by M04Week "

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & datDatum & "' and '" & sDate & "' AND M04Machine_No NOT IN ('18','19','20') and  M04ProgrameType not in ('R','N','F','I','D','B') group by M04ProgrameType "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            F = 0
            For Each DTRow2 As DataRow In T03.Tables(0).Rows
                N_TAKEN = N_TAKEN + T03.Tables(0).Rows(F)("M04Taken")

                F = F + 1
            Next
            N_TAKEN = N_TAKEN / 126
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Cells(x, Y) = N_TAKEN
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------

            worksheet113.Range("H" & (x)).Formula = "=SUM(C" & x & ":G" & x & ")"
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet113.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 2
            '-----------------------------------------------------------------
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim Z As Integer
            Dim n_count As Integer
            Dim M1 As Integer


            SQL = "SELECT max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND M04Machine_No NOT IN ('18','19','20') AND T03TYPE='01' and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "'  group by m04year  order by m04year"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '  If isValidDataset(T03) Then
            n_count = 0
            N_TAKEN = 0
            M1 = 0
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                N_TAKEN = N_TAKEN + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next


            Dim X1 As Integer
            Dim X2 As Integer

            X1 = (24 * 18 * 7) * 60
            X2 = N_TAKEN
            worksheet113.Cells(x, Y) = X2 / X1
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ' worksheet13.Cells(x, z) = (Val(T03.Tables(0).Rows(0)("Taken")) * 1440) / (24 * 18)
            range1 = worksheet113.Cells(x, Y)
            ' worksheet13.Cells(x, Y).EntireColumn.NumberFormat = "[hh]:mm"
            worksheet113.Rows(x).Font.size = 10
            range1.NumberFormat = "0%"
            ' range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1
            worksheet113.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            n_per = 0
            M1 = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T01Machine NOT IN ('18','19','20')   AND t01weekno='" & T01.Tables(0).Rows(i)("m04Week") & "' and M05Name in ('Fabric','PM','MainM','TechD') AND t01date between '" & n_Date & "' and '" & N_Date1 & "' and T03TYPE='01' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                M1 = M1 + 1
            Next
            Dim N_TOTALHR As Integer

            N_TOTALHR = 24 * 18 * 60 * 7

            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet113.Cells(x, Y) = n_per
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Rows(x).Font.size = 10

            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            Y = Y + 1
            ' worksheet11.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            n_per = 0
            M1 = 0
            SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T01Machine NOT IN ('18','19','20')   AND t01weekno='" & T01.Tables(0).Rows(i)("m04Week") & "' and M05Name in ('No Work') AND t01date between '" & n_Date & "' and '" & N_Date1 & "' and T03TYPE='01' GROUP BY T03Type,T01WeekNo" 'CONVERT(VARCHAR(10), T01Date, 120)"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                M1 = M1 + 1
            Next
            n_per = n_per / N_TOTALHR
            ' n_per = n_per * 100
            worksheet113.Cells(x, Y) = n_per
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Rows(x).Font.size = 10

            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            Y = Y + 1
            ' worksheet11.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            'Dim txtYear As String
            'Dim tmpDate As Date
            'Dim Ydate As Integer
            'Dim N_STD1 As Integer
            'Dim N_STD2 As Integer

            'Ydate = T01.Tables(0).Rows(i)("M04week")
            'Ydate = Ydate * 7
            'txtYear = (T01.Tables(0).Rows(i)("Eyear"))
            'Dim x_date As Date
            'Dim x_date1 As Date
            'tmpDate = System.DateTime.FromOADate(CDate("01/01/" & txtYear).ToOADate - Weekday(CDate("01/01/" & txtYear), FirstDayOfWeek.Monday) + 1)

            'If T01.Tables(0).Rows(i)("M04Week") = "1" Then
            '    x_date = "1/1/" & txtYear
            'Else
            '    x_date = CDate(tmpDate).AddDays(+Ydate - 7)
            'End If
            'Dim thisCulture1 = Globalization.CultureInfo.CurrentCulture
            'Dim dayOfWeek1 As DayOfWeek = thisCulture1.Calendar.GetDayOfWeek(x_date)
            'Dim dayName1 As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek1)

            'If dayName1 = "Sunday" Then
            '    '  x_date = CDate(WeekStartDate()).AddDays(-6)
            'ElseIf dayName1 = "Tuesday" Then
            '    x_date = CDate(x_date).AddDays(-1)
            'ElseIf dayName1 = "Wednesday" Then
            '    x_date = CDate(x_date).AddDays(-2)
            'ElseIf dayName1 = "Thuesday" Then
            '    x_date = CDate(x_date).AddDays(-3)
            'ElseIf dayName1 = "Friday" Then
            '    x_date = CDate(x_date).AddDays(-4)
            'ElseIf dayName1 = "Saturday" Then
            '    x_date = CDate(x_date).AddDays(-5)
            'End If
            'x_date1 = CDate(x_date).AddDays(+7)
            'If x_date1 > txtTodate.Value Then
            '    'WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            'End If
            '' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            'x_date = x_date & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"

            'Dim N_TOTAL As Integer
            'Dim N_STD As Integer

            'N_TOTAL = 0
            'N_STD = 0
            'N_STD1 = 0
            'N_STD2 = 0
            'M1 = 0

            'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN FROM M04Lot " & _
            '      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType not in ('I','E') AND " & _
            '      " M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND T03TYPE IN ('01') AND M04Machine_No NOT IN ('18','19','20') GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType order by CONVERT(VARCHAR(10) , M04Date_Out, 120)"
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    N_TOTAL = N_TOTAL + T03.Tables(0).Rows(M1)("TAKEN")
            '    If Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "F" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "E" Or Trim(T03.Tables(0).Rows(M1)("M04ProgrameType")) = "D" Then
            '        N_STD = N_STD + T03.Tables(0).Rows(M1)("TAKEN")
            '    Else
            '        N_STD = N_STD + T03.Tables(0).Rows(M1)("STD")
            '    End If
            '    M1 = M1 + 1
            'Next

            'M1 = 0
            'Dim M2 As Integer

            'SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120) as Ddate,SUM(M04STD) AS STD,SUM(M04Taken) AS TAKEN,count(M04Lotno) " & _
            '     "FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
            '     "WHERE M04ProgrameType not in ('E','i') AND M04ETIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M04Machine_No NOT IN ('18','19','20') AND T03TYPE IN ('01') " & _
            '     " GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120),M04Lotno having count(M04Lotno)>1 "
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    Dim A1 As Date
            '    Dim A2 As Date

            '    SQL = "SELECT M04Lotno,CONVERT(VARCHAR(10) , M04Date_Out, 120),M04ProgrameType,(M04STD) AS STD,(M04Taken) AS TAKEN FROM M04Lot " & _
            '      "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE " & _
            '      "  T03TYPE IN ('01') and M04Lotno='" & T03.Tables(0).Rows(M1)("M04Lotno") & "' AND M04Machine_No NOT IN ('18','19','20') AND M04Date_Out='" & T03.Tables(0).Rows(M1)("Ddate") & "'"
            '    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '    M2 = 0
            '    For Each DTRow5 As DataRow In T04.Tables(0).Rows
            '        If Trim(T04.Tables(0).Rows(M2)("M04ProgrameType")) = "F" Then
            '        Else
            '            N_STD1 = N_STD1 + Val(T04.Tables(0).Rows(M2)("STD"))
            '            N_STD2 = N_STD2 + Val(T04.Tables(0).Rows(M2)("taken"))
            '        End If
            '        M2 = M2 + 1
            '    Next

            '    M1 = M1 + 1
            'Next

            'N_STD = N_STD - N_STD1
            'N_TOTAL = N_TOTAL - N_STD2
            'Dim U1 As Double
            'U1 = (N_STD / N_TOTAL)
            'If N_STD = 0 And N_TOTAL = 0 Then
            '    worksheet113.Cells(x, Y) = "0"
            'Else
            '    If (1 - U1) > 0 Then
            '        worksheet113.Cells(x, Y) = 1 - U1
            '    Else
            '        worksheet113.Cells(x, Y) = "0"
            '    End If
            'End If
            'worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'range1 = worksheet113.Cells(x, Y)
            'range1.NumberFormat = "0%"
            ''worksheet17.Rows(x).Font.size = 10

            worksheet113.Cells(x, Y) = "=1-'Weekly efficiency'!C" & M3
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet113.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            If CDbl(worksheet113.Range("M" & x).Value.ToString) > 0 Then

            Else
                worksheet113.Cells(x, Y) = "0"
            End If
            M3 = M3 + 1

            Y = Y + 1

            worksheet113.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet113.Range("N" & (x)).Formula = "=SUM(J" & x & ":M" & x & ")"
            worksheet113.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet113.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet113.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet113.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Overall_IAFFWJ = Overall_IAFFWJ + 1
            x = x + 1
            i = i + 1
        Next

    End Function

    Function MonthlyInefficiency_AF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet114 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet114.Name = "Monthly Inefficiency (AFM)"
        Dim exApp As Microsoft.Office.Interop.Excel.Application
        exApp = CreateObject("Excel.Application")


        Dim exSheet As Microsoft.Office.Interop.Excel.Worksheet
        exSheet = workbooks(1).Worksheets(8)
        'page Header
        worksheet114.Cells(2).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet114.Cells(2, 2) = "Air flow machine (LR1-LR9) utilization and  down time + delay time analysis - Monthly"
        worksheet114.Cells(2).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet114.Rows(2).Font.Bold = True
        worksheet114.Rows(2).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet114.Columns("A").ColumnWidth = 3
        worksheet114.Columns("B").ColumnWidth = 10
        worksheet114.Columns("C").ColumnWidth = 10
        worksheet114.Columns("D").ColumnWidth = 10
        worksheet114.Columns("E").ColumnWidth = 10
        worksheet114.Columns("F").ColumnWidth = 10
        worksheet114.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet114.Columns("H").ColumnWidth = 18
        worksheet114.Columns("I").ColumnWidth = 3
        worksheet114.Columns("J").ColumnWidth = 10
        worksheet114.Columns("K").ColumnWidth = 10
        worksheet114.Columns("L").ColumnWidth = 10
        worksheet114.Columns("M").ColumnWidth = 10
        worksheet114.Columns("N").ColumnWidth = 10
        '  worksheet11.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        ' worksheet11.Columns("H").ColumnWidth = 15

        'worksheet11.Range(worksheet11.Cells(1, 2), worksheet11.Cells(2, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet114.Cells(2, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet114.Range(worksheet114.Cells(2, 2), worksheet114.Cells(2, 14)).Merge()
        ' worksheet11.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B2", "N2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(3, 2) = "Daily / per machine(hrs)"
        worksheet114.Rows(3).Font.Bold = True
        worksheet114.Rows(3).Font.size = 10
        worksheet114.Range("B3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range(worksheet114.Cells(3, 2), worksheet114.Cells(3, 14)).Merge()
        worksheet114.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(4, 2) = "Week No."
        worksheet114.Cells(4, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 2).Font.size = 10
        worksheet114.Cells(4, 2).WrapText = True
        worksheet114.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet114.Cells(4, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet114.Cells(4, 4) = "Actual STD running  Time "
        worksheet114.Cells(4, 4).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 4).Font.size = 10
        'worksheet11.Cells(4, 4).WrapText = True
        'worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("G4", "G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range(worksheet114.Cells(4, 3), worksheet114.Cells(4, 7)).Merge()
        ' worksheet11.Cells(4, 4).WrapText = True
        worksheet114.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet114.Cells(4, 8) = "Total"
        worksheet114.Cells(4, 8).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 8).Font.size = 10
        worksheet114.Cells(4, 8).Font.Bold = True
        'worksheet11.Cells(4, 8).WrapText = True
        worksheet114.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("H4", "H4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("C4", "H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H4:H4").Interior.Color = RGB(255, 204, 0)


        worksheet114.Cells(4, 10) = "Boil out"
        worksheet114.Cells(4, 10).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 10).Font.size = 10
        'worksheet11.Cells(4, 10).WrapText = True
        worksheet114.Cells(4, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("I4", "I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J4", "J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(4, 11) = "M/C down time"
        worksheet114.Cells(4, 11).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 11).Font.size = 10
        ' worksheet11.Cells(4, 11).WrapText = True
        worksheet114.Cells(4, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("L4", "L4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range(worksheet114.Cells(4, 11), worksheet114.Cells(4, 12)).Merge()
        worksheet114.Cells(4, 13) = "Delay time"
        worksheet114.Cells(4, 13).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 13).Font.size = 10
        'worksheet11.Cells(4, 13).WrapText = True
        worksheet114.Cells(4, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("M4", "M4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(4, 14) = "Total delay"
        worksheet114.Cells(4, 14).Font.Name = "Times New Roman"
        worksheet114.Cells(4, 14).Font.size = 10
        worksheet114.Cells(4, 14).Font.BOLD = True
        ' worksheet11.Cells(4, 14).WrapText = True
        worksheet114.Cells(4, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("N4", "N4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N4:N4").Interior.Color = RGB(255, 204, 0)

        worksheet114.Cells(5, 3) = "Production "
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(5, 3).Font.size = 10
        'worksheet11.Cells(5, 3).WrapText = True
        worksheet114.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("C5", "D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 3).WrapText = True
        worksheet114.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range(worksheet114.Cells(5, 3), worksheet114.Cells(5, 4)).Merge()


        worksheet114.Cells(5, 5) = "Redye "
        worksheet114.Cells(5, 5).Font.size = 10
        worksheet114.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("F5", "F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("E5", "F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range(worksheet114.Cells(5, 5), worksheet114.Cells(5, 6)).Merge()



        worksheet114.Cells(5, 7) = "Reprocess"
        worksheet114.Cells(5, 7).Font.size = 10
        worksheet114.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 7).WrapText = True
        worksheet114.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet114.Cells(5, 8) = "M/c Utilization factor"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(5, 8).Font.size = 10
        worksheet114.Cells(5, 8).Font.BOLD = True
        worksheet114.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet114.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H5:H5").Interior.Color = RGB(255, 204, 0)


        worksheet114.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J4:J5").Interior.Color = RGB(255, 255, 255)
        worksheet114.Range("K5", "L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("L5", "L5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("K4:K5").Interior.Color = RGB(255, 255, 255)
        worksheet114.Range("L4:L5").Interior.Color = RGB(255, 255, 255)

        worksheet114.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet114.Range("M5:M5").Interior.Color = RGB(255, 255, 255)


        worksheet114.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet114.Range("N5:N5").Interior.Color = RGB(255, 204, 0)


        worksheet114.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B4", "B6").Merge()
        worksheet114.Rows(6).rowheight = 50.25


        worksheet114.Cells(6, 3) = "Color"
        worksheet114.Cells(6, 3).Font.size = 9
        worksheet114.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 3).WrapText = True
        worksheet114.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet114.Cells(6, 4) = "White"
        worksheet114.Cells(6, 4).Font.size = 9
        worksheet114.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 4).WrapText = True
        worksheet114.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 5) = "Color"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 5).Font.size = 9
        worksheet114.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 5).WrapText = True
        worksheet114.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 6) = "White"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 6).Font.size = 9
        worksheet114.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 6).WrapText = True
        worksheet114.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 7) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 7).Font.size = 9
        worksheet114.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 7).WrapText = True
        worksheet114.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 8) = "(STD running time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 8).Font.size = 9
        worksheet114.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 8).WrapText = True
        worksheet114.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H6:H6").Interior.Color = RGB(255, 204, 0)

        worksheet114.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(6, 10) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 10).Font.size = 10
        worksheet114.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 10).WrapText = True
        worksheet114.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 11) = "Fabric delay + dye tech + maintenance(hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 11).Font.size = 9
        worksheet114.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 11).WrapText = True
        worksheet114.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 12) = "No work (hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 12).Font.size = 9
        worksheet114.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 12).WrapText = True
        worksheet114.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 13) = "Fresh bulk+RD+RP (actual - standard time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 13).Font.size = 9
        worksheet114.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 13).WrapText = True
        worksheet114.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Cells(6, 14) = "Boil out + down time + delay"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet114.Cells(6, 14).Font.size = 10
        worksheet114.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Cells(6, 14).WrapText = True
        worksheet114.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet114.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N6:N6").Interior.Color = RGB(255, 204, 0)
        '----------------------------------------------------------------------------------------------------------
        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT month(m04etime) as ddate,count(T03TYPE) as nCount,year(m04etime) as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','F') GROUP BY year(m04etime),month(m04etime) order by year(m04etime),month(m04etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 7
        Dim M3 As Integer
        M3 = 7
        Dim M2 As Integer
        M2 = 9
        Dim m1 As Integer
        m1 = 11
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            Dim aDate As DateTime
            Dim L_DateofMonth As Integer
            aDate = T01.Tables(0).Rows(i)("DDATE") & "/1/" & T01.Tables(0).Rows(i)("eYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            worksheet114.Cells(x, Y) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("eYear")

            worksheet114.Rows(x).Font.size = 10
            worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------PRODUCTION
            Dim N_TAKEN As Double
            N_TAKEN = 0
            'COLOR
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04ETime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04ETime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType IN ('N','F') and M08CL='Colour' group by month(M04ETime),year(M04ETime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            Dim M_Count As Integer
            M_Count = L_DateofMonth * 9

            N_TAKEN = N_TAKEN / M_Count
            ' N_TAKEN = N_TAKEN / 604y
            N_TAKEN = (N_TAKEN) / 1440
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Cells(x, Y) = N_TAKEN
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------------------------
            'WHITE
            N_TAKEN = 0

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04ETime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04ETime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType IN ('N','F') and M08CL IN ('White','MARL & Yarn dye') group by year(M04ETime),month(M04ETime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / M_Count
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Cells(x, Y) = N_TAKEN
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-------------------------------------------------------------------
            N_TAKEN = 0
            'COLOR
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04ETime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04ETime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType IN ('R') and M08CL='Colour' group by year(M04ETime),month(M04ETime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / M_Count
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Cells(x, Y) = N_TAKEN
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------------------------
            'Redye
            N_TAKEN = 0

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04ETime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04ETime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType ='R' and M08CL IN ('White','MARL & Yarn dye') group by year(M04ETime),month(M04ETime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / M_Count
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Cells(x, Y) = N_TAKEN
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-----------------------------------------------------------------------------------------------------------
            N_TAKEN = 0

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04ETime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04ETime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType not in ('R','N','F','I','D','B') group by year(M04ETime),month(M04ETime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / M_Count
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Cells(x, Y) = N_TAKEN
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------

            worksheet114.Range("H" & (x)).Formula = "=SUM(C" & x & ":G" & x & ")"
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet114.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 2
            '-----------------------------------------------------------------
            'Dim StartdateofYear As Date
            'Dim Dateofweek As Integer
            'Dim WeekStartdate As Date
            'Dim WeekEnddate As Date

            'StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            'Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            'WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            'Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            'Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            'Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            'If dayName = "Sunday" Then
            '    WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            'ElseIf dayName = "Tuesday" Then
            '    WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            'ElseIf dayName = "Wednesday" Then
            '    WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            'ElseIf dayName = "Thuesday" Then
            '    WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            'ElseIf dayName = "Friday" Then
            '    WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            'ElseIf dayName = "Saturday" Then
            '    WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            'End If
            'WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            'If WeekEnddate > txtTodate.Value Then
            '    WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            'End If
            '' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            'WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"
            'Dim Z As Integer
            Dim n_count As Integer
            ' Dim M1 As Integer

            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date


            worksheet114.Cells(x, Y) = "='Monthly Boil Out'!U" & m1
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            m1 = m1 + 1


            worksheet114.Cells(x, Y) = "=SUM('Monthly Down Time Analysis'!N" & M2 & ":Q" & M2 & ")"
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            worksheet114.Cells(x, Y) = "='Monthly Down Time Analysis'!R" & M2
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            M2 = M2 + 1

            worksheet114.Cells(x, Y) = "=1-'Monthly efficiency'!B" & M3
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            If CDbl(worksheet114.Range("M" & x).Value.ToString) > 0 Then

            Else
                worksheet114.Cells(x, Y) = "0"
            End If
            M3 = M3 + 1


            ';worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet114.Range("N" & (x)).Formula = "=SUM(J" & x & ":M" & x & ")"
            ' worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet114.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet114.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet114.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

        Y = 2
        worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet114.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        x = x + 1

        worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Cells(x, Y) = "AVG"
        worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("C" & (x)).Formula = "=AVERAGE(C7:C" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("D" & (x)).Formula = "=AVERAGE(D7:D" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("E" & (x)).Formula = "=AVERAGE(E7:E" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("F" & (x)).Formula = "=AVERAGE(F7:F" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("G" & (x)).Formula = "=AVERAGE(G7:G" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("H" & (x)).Formula = "=AVERAGE(H7:H" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("H" & x & ":H" & x).Interior.Color = RGB(0, 176, 80)

        Y = Y + 2
        worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J" & (x)).Formula = "=AVERAGE(J7:J" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("K" & (x)).Formula = "=AVERAGE(K7:K" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("L" & (x)).Formula = "=AVERAGE(L7:L" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("M" & (x)).Formula = "=AVERAGE(M7:M" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet114.Range("N" & (x)).Formula = "=AVERAGE(N7:N" & (x - 2) & ")"
        worksheet114.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet114.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet114.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet114.Range("N" & x & ":N" & x).Interior.Color = RGB(0, 176, 80)
    End Function

    Function Monthly_InefficincyWJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet115 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet115.Name = "Monthly Inefficiency (WJ)"

        'page Header
        worksheet115.Cells(2).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet115.Cells(2, 2) = "Water jet  (ECO 02- ITM 23) utilization and  down time + delay time analysis - Monthly"
        worksheet115.Rows(2).Font.Bold = True
        worksheet115.Rows(2).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet115.Columns("A").ColumnWidth = 3
        worksheet115.Columns("B").ColumnWidth = 10
        worksheet115.Columns("C").ColumnWidth = 10
        worksheet115.Columns("D").ColumnWidth = 10
        worksheet115.Columns("E").ColumnWidth = 10
        worksheet115.Columns("F").ColumnWidth = 10
        worksheet115.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        worksheet115.Columns("H").ColumnWidth = 18
        worksheet115.Columns("I").ColumnWidth = 3
        worksheet115.Columns("J").ColumnWidth = 10
        worksheet115.Columns("K").ColumnWidth = 10
        worksheet115.Columns("L").ColumnWidth = 10
        worksheet115.Columns("M").ColumnWidth = 10
        worksheet115.Columns("N").ColumnWidth = 10
        '  worksheet11.Columns("G").ColumnWidth = 10

        '  worksheet13.Columns("H").ColumnWidth = 8
        ' worksheet11.Columns("H").ColumnWidth = 15

        'worksheet11.Range(worksheet11.Cells(1, 2), worksheet11.Cells(2, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet1.Range("C7", "G7").VerticalAlignment = XlVAlign.xlVAlignCenter
        range1 = worksheet115.Cells(2, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet115.Range(worksheet115.Cells(2, 2), worksheet115.Cells(2, 14)).Merge()
        ' worksheet11.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("B2", "H2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B2", "N2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B3", "B3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(3, 2) = "Daily / per machine(hrs)"
        worksheet115.Rows(3).Font.Bold = True
        worksheet115.Rows(3).Font.size = 10
        worksheet115.Range("B3", "N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N3", "N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range(worksheet115.Cells(3, 2), worksheet115.Cells(3, 14)).Merge()
        worksheet115.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(4, 2) = "Week No."
        worksheet115.Cells(4, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 2).Font.size = 10
        worksheet115.Cells(4, 2).WrapText = True
        worksheet115.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("B4", "B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        range1 = worksheet115.Cells(4, 2)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet115.Cells(4, 4) = "Actual STD running  Time "
        worksheet115.Cells(4, 4).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 4).Font.size = 10
        'worksheet11.Cells(4, 4).WrapText = True
        'worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("G4", "G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range(worksheet115.Cells(4, 3), worksheet115.Cells(4, 7)).Merge()
        ' worksheet11.Cells(4, 4).WrapText = True
        worksheet115.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet115.Cells(4, 8) = "Total"
        worksheet115.Cells(4, 8).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 8).Font.size = 10
        worksheet115.Cells(4, 8).Font.Bold = True
        'worksheet11.Cells(4, 8).WrapText = True
        worksheet115.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("H4", "H4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("C4", "H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H4:H4").Interior.Color = RGB(255, 204, 0)


        worksheet115.Cells(4, 10) = "Boil out"
        worksheet115.Cells(4, 10).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 10).Font.size = 10
        'worksheet11.Cells(4, 10).WrapText = True
        worksheet115.Cells(4, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("I4", "I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J4", "J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(4, 11) = "M/C down time"
        worksheet115.Cells(4, 11).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 11).Font.size = 10
        ' worksheet11.Cells(4, 11).WrapText = True
        worksheet115.Cells(4, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("L4", "L4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range(worksheet115.Cells(4, 11), worksheet115.Cells(4, 12)).Merge()
        worksheet115.Cells(4, 13) = "Delay time"
        worksheet115.Cells(4, 13).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 13).Font.size = 10
        'worksheet11.Cells(4, 13).WrapText = True
        worksheet115.Cells(4, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("M4", "M4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(4, 14) = "Total delay"
        worksheet115.Cells(4, 14).Font.Name = "Times New Roman"
        worksheet115.Cells(4, 14).Font.size = 10
        worksheet115.Cells(4, 14).Font.BOLD = True
        ' worksheet11.Cells(4, 14).WrapText = True
        worksheet115.Cells(4, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("N4", "N4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N4:N4").Interior.Color = RGB(255, 204, 0)

        worksheet115.Cells(5, 3) = "Production "
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(5, 3).Font.size = 10
        'worksheet11.Cells(5, 3).WrapText = True
        worksheet115.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("C5", "D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 3).WrapText = True
        worksheet115.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range(worksheet115.Cells(5, 3), worksheet115.Cells(5, 4)).Merge()


        worksheet115.Cells(5, 5) = "Redye "
        worksheet115.Cells(5, 5).Font.size = 10
        worksheet115.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("F5", "F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("E5", "F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range(worksheet115.Cells(5, 5), worksheet115.Cells(5, 6)).Merge()



        worksheet115.Cells(5, 7) = "Reprocess"
        worksheet115.Cells(5, 7).Font.size = 10
        worksheet115.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        ' worksheet11.Range("B5", "B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("D5", "D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("G5", "G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Cells(5, 7).WrapText = True
        worksheet115.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet115.Cells(5, 8) = "M/c Utilization factor"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(5, 8).Font.size = 10
        worksheet115.Cells(5, 8).Font.BOLD = True
        worksheet115.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet115.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H5", "H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H5:H5").Interior.Color = RGB(255, 204, 0)


        worksheet115.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J5", "J5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J4:J5").Interior.Color = RGB(255, 255, 255)
        worksheet115.Range("K5", "L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("L5", "L5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("K4:K5").Interior.Color = RGB(255, 255, 255)
        worksheet115.Range("L4:L5").Interior.Color = RGB(255, 255, 255)

        worksheet115.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet115.Range("M5:M5").Interior.Color = RGB(255, 255, 255)


        worksheet115.Range("M5", "M5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N5", "N5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        '  worksheet11.Range("M4:M4").Interior.Color = RGB(255, 255, 255)
        worksheet115.Range("N5:N5").Interior.Color = RGB(255, 204, 0)


        worksheet115.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B6", "B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B4", "B6").Merge()
        worksheet115.Rows(6).rowheight = 50.25


        worksheet115.Cells(6, 3) = "Color"
        worksheet115.Cells(6, 3).Font.size = 9
        worksheet115.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 3).WrapText = True
        worksheet115.Cells(6, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("C6", "C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet115.Cells(6, 4) = "White"
        worksheet115.Cells(6, 4).Font.size = 9
        worksheet115.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 4).WrapText = True
        worksheet115.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("D6", "D6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 5) = "Color"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 5).Font.size = 9
        worksheet115.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 5).WrapText = True
        worksheet115.Cells(6, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("E6", "E6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 6) = "White"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 6).Font.size = 9
        worksheet115.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 6).WrapText = True
        worksheet115.Cells(6, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("F6", "F6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 7) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 7).Font.size = 9
        worksheet115.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 7).WrapText = True
        worksheet115.Cells(6, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("G6", "G6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 8) = "(STD running time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 8).Font.size = 9
        worksheet115.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 8).WrapText = True
        worksheet115.Cells(6, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H6", "H6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H6:H6").Interior.Color = RGB(255, 204, 0)

        worksheet115.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(6, 10) = "Hrs/day"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 10).Font.size = 10
        worksheet115.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 10).WrapText = True
        worksheet115.Cells(6, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J6", "J6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 11) = "Fabric delay + dye tech + maintenance(hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 11).Font.size = 9
        worksheet115.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 11).WrapText = True
        worksheet115.Cells(6, 11).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("K6", "K6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 12) = "No work (hrs)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 12).Font.size = 9
        worksheet115.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 12).WrapText = True
        worksheet115.Cells(6, 12).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("L6", "L6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 13) = "Fresh bulk+RD+RP (actual - standard time)"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 13).Font.size = 9
        worksheet115.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 13).WrapText = True
        worksheet115.Cells(6, 13).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("M6", "M6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Cells(6, 14) = "Boil out + down time + delay"
        '   worksheet11.Cells(5, 2).Font.Name = "Times New Roman"
        worksheet115.Cells(6, 14).Font.size = 10
        worksheet115.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Cells(6, 14).WrapText = True
        worksheet115.Cells(6, 14).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet115.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N6", "N6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N6:N6").Interior.Color = RGB(255, 204, 0)
        '----------------------------------------------------------------------------------------------------------
        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        Dim M3 As Integer
        M3 = 7
        Dim M2 As Integer
        M2 = 9
        Dim m1 As Integer
        m1 = 11

        SQL = "SELECT month(M04Etime) as [Ddate],count(T03TYPE) as nCount,year(M04Etime) as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01') AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','F') GROUP BY year(m04Etime),month(m04Etime) order by year(m04Etime),month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 7
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            Dim aDate As DateTime
            Dim L_DateofMonth As Integer
            aDate = T01.Tables(0).Rows(i)("DDATE") & "/1/" & T01.Tables(0).Rows(i)("eYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            worksheet115.Cells(x, Y) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("eYear")

            ' worksheet115.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            worksheet115.Rows(x).Font.size = 10
            worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------PRODUCTION
            Dim N_TAKEN As Double
            N_TAKEN = 0
            'COLOR
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(m04Etime)='" & T01.Tables(0).Rows(i)("ddate") & "' and M04ProgrameType IN ('N','F') and M08CL='Colour' and year(m04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' group by year(m04Etime),month(m04Etime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            Dim U_1 As Integer
            U_1 = L_DateofMonth * 18
            N_TAKEN = N_TAKEN / U_1
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Cells(x, Y) = N_TAKEN
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------------------------------------------------------------------
            'WHITE
            N_TAKEN = 0

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Machine_No NOT IN ('18','19','20') AND M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04Etime)='" & T01.Tables(0).Rows(i)("ddate") & "'  and year(M04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType IN ('N','F') and M08CL IN ('White','MARL & Yarn dye') group by year(M04Etime),month(M04Etime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / U_1
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Cells(x, Y) = N_TAKEN
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-------------------------------------------------------------------
            N_TAKEN = 0
            'COLOR
            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04Etime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType IN ('R') and M08CL='Colour' group by year(M04Etime),month(M04Etime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / U_1
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Cells(x, Y) = N_TAKEN
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------------------------
            'Redye
            N_TAKEN = 0

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' AND M04Machine_No NOT IN ('18','19','20') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and month(M04Etime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType ='R' and M08CL IN ('White','MARL & Yarn dye') group by year(M04Etime),month(M04Etime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / U_1
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Cells(x, Y) = N_TAKEN
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-----------------------------------------------------------------------------------------------------------
            N_TAKEN = 0

            SQL = "select SUM(M04Taken) AS M04Taken  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' AND M04Machine_No NOT IN ('18','19','20') and month(M04Etime)='" & T01.Tables(0).Rows(i)("ddate") & "' and year(M04Etime)='" & T01.Tables(0).Rows(i)("Eyear") & "' and M04ProgrameType not in ('R','N','F','I','D','B') group by year(M04Etime),month(M04Etime) "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                N_TAKEN = T03.Tables(0).Rows(0)("M04Taken")
            End If
            N_TAKEN = N_TAKEN / U_1
            ' N_TAKEN = N_TAKEN / 60
            N_TAKEN = (N_TAKEN) / 1440
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Cells(x, Y) = N_TAKEN
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            ' worksheet11.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '----------------------------------------------------------------

            worksheet115.Range("H" & (x)).Formula = "=SUM(C" & x & ":G" & x & ")"
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet115.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 2
            '-----------------------------------------------------------------

            worksheet115.Cells(x, Y) = "='Monthly Boil Out'!T" & m1
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            m1 = m1 + 1


            worksheet115.Cells(x, Y) = "=SUM('Monthly Down Time Analysis'!H" & M2 & ":K" & M2 & ")"
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            worksheet115.Cells(x, Y) = "='Monthly Down Time Analysis'!L" & M2
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            M2 = M2 + 1

            worksheet115.Cells(x, Y) = "=1-'Monthly efficiency'!C" & M3
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet115.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            If CDbl(worksheet115.Range("M" & x).Value.ToString) > 0 Then

            Else
                worksheet115.Cells(x, Y) = "0"
            End If
            M3 = M3 + 1



            worksheet115.Range("N" & (x)).Formula = "=SUM(J" & x & ":M" & x & ")"
            worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet115.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet115.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet115.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next


        Y = 2
        worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet115.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        x = x + 1

        worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Cells(x, Y) = "AVG"
        worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("B" & x, "B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("C" & (x)).Formula = "=AVERAGE(C7:C" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("D" & (x)).Formula = "=AVERAGE(D7:D" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("E" & (x)).Formula = "=AVERAGE(E7:E" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("F" & (x)).Formula = "=AVERAGE(F7:F" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("G" & (x)).Formula = "=AVERAGE(G7:G" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("G" & x, "G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("H" & (x)).Formula = "=AVERAGE(H7:H" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("H" & x & ":H" & x).Interior.Color = RGB(0, 176, 80)

        Y = Y + 2
        worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J" & (x)).Formula = "=AVERAGE(J7:J" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("K" & (x)).Formula = "=AVERAGE(K7:K" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("L" & (x)).Formula = "=AVERAGE(L7:L" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("M" & (x)).Formula = "=AVERAGE(M7:M" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Y = Y + 1
        worksheet115.Range("N" & (x)).Formula = "=AVERAGE(N7:N" & (x - 2) & ")"
        worksheet115.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet115.Cells(x, Y)
        range1.NumberFormat = "0%"
        worksheet115.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet115.Range("N" & x & ":N" & x).Interior.Color = RGB(0, 176, 80)
    End Function

    Function Whitemal_Weekly()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet116 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet116.Name = "White & Marl Weekly"

        worksheet116.Columns("A").ColumnWidth = 15
        worksheet116.Columns("B").ColumnWidth = 13
        worksheet116.Columns("C").ColumnWidth = 13
        worksheet116.Columns("D").ColumnWidth = 13
        worksheet116.Columns("E").ColumnWidth = 13
        worksheet116.Columns("F").ColumnWidth = 13
        worksheet116.Columns("G").ColumnWidth = 13
        worksheet116.Columns("H").ColumnWidth = 13
        worksheet116.Columns("I").ColumnWidth = 10
        worksheet116.Columns("J").ColumnWidth = 10
        worksheet116.Columns("K").ColumnWidth = 10
        worksheet116.Columns("L").ColumnWidth = 10
        worksheet116.Columns("M").ColumnWidth = 10
        worksheet116.Columns("N").ColumnWidth = 10
        worksheet116.Columns("O").ColumnWidth = 10
        worksheet116.Columns("P").ColumnWidth = 10

        worksheet116.Range("A2:A2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("B2:B2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("C2:C2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("D2:D2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("E2:E2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("F2:F2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("G2:G2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("H2:H2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("I2:I2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("J2:J2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("K2:K2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("L2:L2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("M2:M2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("N2:N2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("O2:O2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("P2:P2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("P2:P2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Range("A2:A2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("B2:B2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("C2:C2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("D2:D2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("E2:E2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("F2:F2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet116.Cells(2, 7) = "All dye machine"
        ' worksheet11.Rows(7).Font.Bold = True
        worksheet116.Rows(2).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet116.Range("G2:H2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet116.Range(worksheet116.Cells(2, 7), worksheet116.Cells(2, 8)).Merge()
        worksheet116.Range(worksheet116.Cells(2, 7), worksheet116.Cells(2, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet116.Cells(2, 7)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet116.Range("G2:G2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("H2:H2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("H2:H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("I2:I2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Cells(2, 9) = "Against total colour production"
        ' worksheet11.Rows(7).Font.Bold = True
        worksheet116.Rows(2).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet116.Range("I2:L2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet116.Range(worksheet116.Cells(2, 9), worksheet116.Cells(2, 12)).Merge()
        worksheet116.Range(worksheet116.Cells(2, 9), worksheet116.Cells(2, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet116.Cells(2, 9)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter

        worksheet116.Range("I2:I2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("J2:J2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("K2:K2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("L2:L2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("L2:L2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(2, 13) = "Against total dyed production"
        ' worksheet11.Rows(7).Font.Bold = True
        worksheet116.Rows(2).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet116.Range("M2:P2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet116.Range(worksheet116.Cells(2, 13), worksheet116.Cells(2, 16)).Merge()
        worksheet116.Range(worksheet116.Cells(2, 13), worksheet116.Cells(2, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet116.Cells(2, 13)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet116.Range("M2:M2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("N2:N2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("O2:O2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("P2:P2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 2) = "Water Jet"
        worksheet116.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 2), worksheet116.Cells(3, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("B3:B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("B3:B3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("B2:B3").Interior.Color = RGB(255, 255, 255)

        worksheet116.Cells(3, 3) = "AirFlow"
        worksheet116.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 3), worksheet116.Cells(3, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("C3:C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("C3:C3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("C2:C3").Interior.Color = RGB(255, 255, 255)

        worksheet116.Cells(3, 4) = "Total"
        worksheet116.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 4), worksheet116.Cells(3, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("D3:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("D3:D3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("D2:D3").Interior.Color = RGB(255, 255, 255)

        worksheet116.Cells(3, 5) = "Colours"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 5), worksheet116.Cells(3, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("E3:E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("E3:E3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("E2:E3").Interior.Color = RGB(255, 255, 255)

        worksheet116.Cells(3, 6) = "White / Marl"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 6), worksheet116.Cells(3, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("F3:F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("F3:F3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("F2:F3").Interior.Color = RGB(255, 255, 255)

        worksheet116.Cells(3, 7) = "Colours %"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 7), worksheet116.Cells(3, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("G3:G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("G3:G3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet116.Cells(3, 8) = "White/ Marl "
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 8), worksheet116.Cells(3, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("H3:H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("H3:H3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 9) = "Light  "
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 9), worksheet116.Cells(3, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("I3:I3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("I3:I3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 10) = "Medium"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 10), worksheet116.Cells(3, 10)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("J3:J3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("J3:J3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 11) = "Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 11), worksheet116.Cells(3, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("K3:K3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("K3:K3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 12) = "Extra Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 12), worksheet116.Cells(3, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("L3:L3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("L3:L3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet116.Cells(3, 13) = "Light  "
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 13), worksheet116.Cells(3, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("M3:M3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("M3:M3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 14) = "Medium"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 14), worksheet116.Cells(3, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("N3:N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("N3:N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 15) = "Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 15), worksheet116.Cells(3, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("O3:O3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("O3:O3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet116.Cells(3, 16) = "Extra Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet116.Rows(3).Font.size = 9
        worksheet116.Range(worksheet116.Cells(3, 16), worksheet116.Cells(3, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet116.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("P3:P3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet116.Range("P3:P3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        '--------------------------------------------------------------------------------------------
        'Data updating
   
      
        '---------------------------------------------------------------------------------------------------
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"
        StrWitemal = 4
        SQL = "SELECT M04Week,max(M04WeekNo) as M04WeekNo,m04year as Eyear,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' group by m04year,M04Week  order by m04year,M04Week "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 1
        x = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            worksheet116.Cells(x, 1) = T01.Tables(0).Rows(i)("M04WeekNo")
            worksheet116.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Rows(x).Font.size = 10
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim Z As Integer
            Dim n_count As Integer
            Dim n_Taken As Double
            Dim M1 As Integer


            'WATER JET MACHINE
            n_Taken = 0
            M1 = 0
            Y = 2
            SQL = "SELECT SUM(M04Batchwt) as Taken FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type WHERE M04ProgrameType='N' AND T03TYPE IN ('01')  and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M08CL NOT IN ('Boil out')  group by T03TYPE"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next
            worksheet116.Cells(x, Y) = n_Taken
            range1 = worksheet116.Cells(x, Y)
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0"
            worksheet116.Rows(x).Font.size = 10
            worksheet116.Range("b" & x, "b" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("b" & x, "b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------
            'AIR FLOW
            n_Taken = 0
            M1 = 0
            SQL = "SELECT SUM(M04Batchwt) as Taken FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type WHERE M04ProgrameType='N' AND T03TYPE IN ('02')  AND M08CL NOT IN ('Boil out') and  M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M08CL NOT IN ('Boil out') group by T03TYPE"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                M1 = M1 + 1
            Next
            worksheet116.Cells(x, Y) = n_Taken
            range1 = worksheet116.Cells(x, Y)
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0"
            worksheet116.Rows(x).Font.size = 10
            worksheet116.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            worksheet116.Range("D" & (x)).Formula = "=SUM(B" & x & ":C" & x & ")"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '-------------------------------------------------------------------------------
            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            worksheet116.Cells(x, Y) = n_Taken
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1

            'WHITE MALE
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl IN ('MARL & Yarn dye','White') AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            worksheet116.Cells(x, Y) = n_Taken
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1

            Dim n_count1 As Double
            Dim n_count2 As Double

            n_count1 = 0
            n_count2 = 0

            n_count1 = (worksheet116.Range("e" & x).Value.ToString)
            n_count2 = (worksheet116.Range("d" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_count1 / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1

            n_count1 = 0
            n_count2 = 0

            n_count1 = (worksheet116.Range("f" & x).Value.ToString)
            n_count2 = (worksheet116.Range("d" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_count1 / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '---------------------------------------------------------
            'LIGHT

            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Light' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("E" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("I" & x, "I" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'MEDIAM

            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Medium' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("E" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("J" & x, "J" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'DARK
            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Dark' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("E" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("K" & x, "K" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'DARK
            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Extra Dark' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("E" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("L" & x, "L" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1


            'LIGHT

            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  M08SUBNAME='Light' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08SUBNAME"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("D" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("M" & x, "M" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1

            'MEDIAM

            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  M08SUBNAME='Medium' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08SUBNAME"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("D" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("N" & x, "N" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1

            'DARK
            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08SUBNAME='Dark' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08SUBNAME"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("D" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("O" & x, "O" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1

            'DARK
            'COLOR
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  M08SUBNAME='Extra Dark' AND " & _
            "m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08SUBNAME"
            n_Taken = 0
            M1 = 0
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In T03.Tables(0).Rows
                ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                M1 = M1 + 1
            Next
            n_count2 = 0
            n_count2 = (worksheet116.Range("D" & x).Value.ToString)
            worksheet116.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet116.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet116.Range(worksheet116.Cells(x, Y), worksheet116.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet116.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet116.Range("P" & x, "P" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1
            x = x + 1
            StrWitemal = StrWitemal + 1
            i = i + 1
        Next



        'chart
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet116.ChartObjects

        Dim _Chartlocation As Integer
        Dim rh As Double

        _Chartlocation = (x + 12) * 10
        rh = (x - 1) * 12.75
        rh = rh + 5
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1
        chartRange = worksheet116.Range("H4", "H" & (x - 1))
        chartRange1 = worksheet116.Range("A4", "A" & (x - 1))
        'chartRange = worksheet1.Range("H8", "K" & (X - 1))
        'chartRange = worksheet1.Range("H8:K39", "A9:A39")
        ' chartPage.SetSourceData(Source:=chartRange)
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White & Mal"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLineMarkers

        _Chartlocation = _Chartlocation + 300
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
       
        chartRange = worksheet116.Range("H4", "H" & (x - 1))
        chartRange1 = worksheet116.Range("A4", "A" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "White & Mal"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 0, 255)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)

        'LIGHT
        chartRange = worksheet116.Range("M4", "M" & (x - 1))
        '  chartRange1 = worksheet11.Range("A4", "A" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Light"
            '    t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(180, 70, 58)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(2).Interior.Color = RGB(180, 70, 58)


        'MEDIUM
        chartRange = worksheet116.Range("N4", "N" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Medium"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(0, 153, 0)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(3).Interior.Color = RGB(0, 153, 0)

        'Dark
        chartRange = worksheet116.Range("o4", "o" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Dark"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(158, 0, 214)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(4).Interior.Color = RGB(158, 0, 214)

        'Extra Dark
        chartRange = worksheet116.Range("p4", "p" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Extra Dark"
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(21, 194, 255)
        '  t_Series.Points.mark = RGB(255, 255, 0)
        chartPage.SeriesCollection(5).Interior.Color = RGB(21, 194, 255)

        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Shade distribution")
        chartPage.Refresh()

        chartPage.Refresh()

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLineMarkers

    End Function

    Function Whitemal_Monthly()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet117 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet117.Name = "White & Marl Monthly"

        worksheet117.Columns("A").ColumnWidth = 15
        worksheet117.Columns("B").ColumnWidth = 13
        worksheet117.Columns("C").ColumnWidth = 13
        worksheet117.Columns("D").ColumnWidth = 13
        worksheet117.Columns("E").ColumnWidth = 13
        worksheet117.Columns("F").ColumnWidth = 13
        worksheet117.Columns("G").ColumnWidth = 13
        worksheet117.Columns("H").ColumnWidth = 13
        worksheet117.Columns("I").ColumnWidth = 10
        worksheet117.Columns("J").ColumnWidth = 10
        worksheet117.Columns("K").ColumnWidth = 10
        worksheet117.Columns("L").ColumnWidth = 10
        worksheet117.Columns("M").ColumnWidth = 10
        worksheet117.Columns("N").ColumnWidth = 10
        worksheet117.Columns("O").ColumnWidth = 10
        worksheet117.Columns("P").ColumnWidth = 10

        worksheet117.Range("A2:A2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("B2:B2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("C2:C2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("D2:D2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("E2:E2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("F2:F2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("G2:G2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("H2:H2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("I2:I2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("J2:J2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("K2:K2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("L2:L2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("M2:M2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("N2:N2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("O2:O2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("P2:P2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("P2:P2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Range("A2:A2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("B2:B2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("C2:C2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("D2:D2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("E2:E2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("F2:F2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        worksheet117.Cells(2, 7) = "All dye machine"
        ' worksheet11.Rows(7).Font.Bold = True
        worksheet117.Rows(2).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet117.Range("G2:H2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet117.Range(worksheet117.Cells(2, 7), worksheet117.Cells(2, 8)).Merge()
        worksheet117.Range(worksheet117.Cells(2, 7), worksheet117.Cells(2, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet117.Cells(2, 7)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet117.Range("G2:G2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("H2:H2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("H2:H2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("I2:I2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Cells(2, 9) = "Against total colour production"
        ' worksheet11.Rows(7).Font.Bold = True
        worksheet117.Rows(2).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet117.Range("I2:L2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet117.Range(worksheet117.Cells(2, 9), worksheet117.Cells(2, 12)).Merge()
        worksheet117.Range(worksheet117.Cells(2, 9), worksheet117.Cells(2, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet117.Cells(2, 9)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter

        worksheet117.Range("I2:I2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("J2:J2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("K2:K2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("L2:L2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("L2:L2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(2, 13) = "Against total dyed production"
        ' worksheet11.Rows(7).Font.Bold = True
        worksheet117.Rows(2).Font.size = 10
        'range1 = worksheet1.Cells("B2:G2")

        worksheet117.Range("M2:P2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet117.Range(worksheet117.Cells(2, 13), worksheet117.Cells(2, 16)).Merge()
        worksheet117.Range(worksheet117.Cells(2, 13), worksheet117.Cells(2, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet117.Cells(2, 13)
        range1.VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet117.Range("M2:M2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("N2:N2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("O2:O2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("P2:P2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 2) = "Water Jet"
        worksheet117.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 2), worksheet117.Cells(3, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("B3:B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("B3:B3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("B2:B3").Interior.Color = RGB(255, 255, 255)

        worksheet117.Cells(3, 3) = "AirFlow"
        worksheet117.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 3), worksheet117.Cells(3, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("C3:C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("C3:C3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("C2:C3").Interior.Color = RGB(255, 255, 255)

        worksheet117.Cells(3, 4) = "Total"
        worksheet117.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 4), worksheet117.Cells(3, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("D3:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("D3:D3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("D2:D3").Interior.Color = RGB(255, 255, 255)

        worksheet117.Cells(3, 5) = "Colours"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 5), worksheet117.Cells(3, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("E3:E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("E3:E3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("E2:E3").Interior.Color = RGB(255, 255, 255)

        worksheet117.Cells(3, 6) = "White / Marl"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 6), worksheet117.Cells(3, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("F3:F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("F3:F3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("F2:F3").Interior.Color = RGB(255, 255, 255)

        worksheet117.Cells(3, 7) = "Colours %"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 7), worksheet117.Cells(3, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("G3:G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("G3:G3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet117.Cells(3, 8) = "White/ Marl "
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 8), worksheet117.Cells(3, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("H3:H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("H3:H3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 9) = "Light  "
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 9), worksheet117.Cells(3, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("I3:I3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("I3:I3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 10) = "Medium"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 10), worksheet117.Cells(3, 10)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("J3:J3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("J3:J3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 11) = "Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 11), worksheet117.Cells(3, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("K3:K3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("K3:K3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 12) = "Extra Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 12), worksheet117.Cells(3, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("L3:L3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("L3:L3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet117.Cells(3, 13) = "Light  "
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 13), worksheet117.Cells(3, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("M3:M3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("M3:M3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 14) = "Medium"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 14), worksheet117.Cells(3, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("N3:N3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("N3:N3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 15) = "Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 15), worksheet117.Cells(3, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("O3:O3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("O3:O3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet117.Cells(3, 16) = "Extra Dark"
        ' worksheet11.Rows(3).Font.Bold = True
        worksheet117.Rows(3).Font.size = 9
        worksheet117.Range(worksheet117.Cells(3, 16), worksheet117.Cells(3, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet117.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("P3:P3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet117.Range("P3:P3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        '--------------------------------------------------------------------------------------------
        'Data updating


        '---------------------------------------------------------------------------------------------------
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"

        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' group by year(m04Etime), Month(m04Etime)  order by year(m04Etime), Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        Dim L_DateofMonth As Integer
        ' Dim Y As Integer
        Y = 1
        x = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            ' N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet117.Cells(x, 1) = MonthName(T01.Tables(0).Rows(i)("T01month"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            worksheet117.Rows(x).Font.size = 10


            worksheet117.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("A" & x, "A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Rows(x).Font.size = 10
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate = StartdateofYear
           
            '    WeekEnddate = CDate(WeekStartdate).AddDays(+L_DateofMonth)
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            '   WeekEnddate = WeekEnddate & " " & "7:30AM"
            'Dim Z As Integer
            Dim n_count As Integer
            Dim n_Taken As Double
            Dim M1 As Integer
            Dim C1 As Integer
            Dim _AF As Double
            Dim _WJ As Double
            Dim _COLOUR As Double
            Dim _WHITE As Double
            Dim _LIGHT As Double
            Dim _MEDIUM As Double
            Dim _DARK As Double
            Dim _EXDARK As Double

            'WATER JET MACHINE

            _AF = 0
            _WJ = 0
            _COLOUR = 0
            _EXDARK = 0
            _DARK = 0
            _MEDIUM = 0
            _LIGHT = 0
            _WHITE = 0

            n_Taken = 0
            M1 = 0
            Y = 2
            For C1 = 1 To L_DateofMonth
                WeekEnddate = CDate(WeekStartdate).AddDays(+1)
                If C1 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    '  X_date = X_date & " " & "7:30AM"
                    ' WeekEnddate = WeekEnddate & " " & "7:30AM"
                End If

                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) as Taken FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                       "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type WHERE M04ProgrameType='N' AND T03TYPE IN ('01')  and  m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M08CL NOT IN ('Boil out')  group by T03TYPE"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _WJ = _WJ + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                '-----------------------------------------------------------------
                'AIR FLOW
                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) as Taken FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                  "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type WHERE M04ProgrameType='N' AND T03TYPE IN ('02')  AND M08CL NOT IN ('Boil out') and m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M08CL NOT IN ('Boil out') group by T03TYPE"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _AF = _AF + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                '-----------------------------------------------------------------
                'COLOUR
                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND " & _
           "m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
                n_Taken = 0
                M1 = 0
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _COLOUR = _COLOUR + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                    M1 = M1 + 1
                Next
                '------------------------------------------------------------------
                'WHITE MARL
                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl IN ('MARL & Yarn dye','White') AND " & _
            "m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
                n_Taken = 0
                M1 = 0
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _WHITE = _WHITE + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                    M1 = M1 + 1
                Next
                '--------------------------------------------------------------------

                'LIGHT
                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Light' AND " & _
          "m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
                n_Taken = 0
                M1 = 0
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _LIGHT = _LIGHT + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                    M1 = M1 + 1
                Next
                '-----------------------------------------------------------------
                'MEDIUM 
                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Medium' AND " & _
           "m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
                n_Taken = 0
                M1 = 0
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _MEDIUM = _MEDIUM + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                    M1 = M1 + 1
                Next
                '---------------------------------------------------------------
                'DARK

                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Dark' AND " & _
            "m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
                n_Taken = 0
                M1 = 0
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _DARK = _DARK + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                    M1 = M1 + 1
                Next
                '---------------------------------------------------------------

                'EXDARK
                M1 = 0
                SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Extra Dark' AND " & _
           "m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
                n_Taken = 0
                M1 = 0
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    _EXDARK = _EXDARK + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
                    M1 = M1 + 1
                Next

                WeekStartdate = WeekEnddate
            Next
            worksheet117.Cells(x, Y) = _WJ
            range1 = worksheet117.Cells(x, Y)
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0"
            worksheet117.Rows(x).Font.size = 10
            worksheet117.Range("b" & x, "b" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("b" & x, "b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '------------------------------------------------
            'AIR FLOW

            worksheet117.Cells(x, Y) = _AF
            range1 = worksheet117.Cells(x, Y)
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0"
            worksheet117.Rows(x).Font.size = 10
            worksheet117.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            worksheet117.Range("D" & (x)).Formula = "=SUM(B" & x & ":C" & x & ")"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            'COLOUR
            worksheet117.Cells(x, Y) = _COLOUR
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            'WHITE

            worksheet117.Cells(x, Y) = _WHITE
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1


            'n_Taken = 0
            'M1 = 0
            'SQL = "SELECT SUM(M04Batchwt) as Taken FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
            '       "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type WHERE M04ProgrameType='N' AND T03TYPE IN ('02')  AND M08CL NOT IN ('Boil out') and m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M08CL NOT IN ('Boil out') group by T03TYPE"
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
            '    M1 = M1 + 1
            'Next
            'worksheet117.Cells(x, Y) = n_Taken
            'range1 = worksheet117.Cells(x, Y)
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'range1.NumberFormat = "0"
            'worksheet117.Rows(x).Font.size = 10
            'worksheet117.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("C" & x, "C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'Y = Y + 1
            'worksheet117.Range("D" & (x)).Formula = "=SUM(B" & x & ":C" & x & ")"
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("D" & x, "D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'Y = Y + 1
            ''-------------------------------------------------------------------------------
            ''COLOR
            'SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND " & _
            '"m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            'n_Taken = 0
            'M1 = 0
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
            '    M1 = M1 + 1
            'Next
            'worksheet117.Cells(x, Y) = n_Taken
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("E" & x, "E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'Y = Y + 1

            ''WHITE MALE
            'SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl IN ('MARL & Yarn dye','White') AND " & _
            '"m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            'n_Taken = 0
            'M1 = 0
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
            '    M1 = M1 + 1
            'Next
            'worksheet117.Cells(x, Y) = n_Taken
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("F" & x, "F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'Y = Y + 1

            Dim n_count1 As Double
            Dim n_count2 As Double

            n_count1 = 0
            n_count2 = 0

            n_count1 = (worksheet117.Range("e" & x).Value.ToString)
            n_count2 = (worksheet117.Range("d" & x).Value.ToString)
            worksheet117.Cells(x, Y) = n_count1 / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1

            n_count1 = 0
            n_count2 = 0

            n_count1 = (worksheet117.Range("f" & x).Value.ToString)
            n_count2 = (worksheet117.Range("d" & x).Value.ToString)
            worksheet117.Cells(x, Y) = n_count1 / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            Y = Y + 1
            '---------------------------------------------------------
            'LIGHT
            n_count2 = 0
            n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            worksheet117.Cells(x, Y) = _LIGHT / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("I" & x, "I" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'MEDIUM
            n_count2 = 0
            n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            worksheet117.Cells(x, Y) = _MEDIUM / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("J" & x, "J" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'DARK
            n_count2 = 0
            n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            worksheet117.Cells(x, Y) = _DARK / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("K" & x, "K" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'EXDARK
            n_count2 = 0
            n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            worksheet117.Cells(x, Y) = _EXDARK / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("L" & x, "L" & x).Interior.Color = RGB(112, 254, 153)
            Y = Y + 1

            'LIGHT

            'COLOR
            'SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Light' AND " & _
            '"m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            'n_Taken = 0
            'M1 = 0
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
            '    M1 = M1 + 1
            'Next
            'n_count2 = 0
            'n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            'worksheet117.Cells(x, Y) = n_Taken / n_count2
            'range1 = worksheet117.Cells(x, Y)
            'range1.NumberFormat = "0%"
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("I" & x, "I" & x).Interior.Color = RGB(112, 254, 153)
            'Y = Y + 1

            ''MEDIAM

            ''COLOR
            'SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Medium' AND " & _
            '"m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            'n_Taken = 0
            'M1 = 0
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
            '    M1 = M1 + 1
            'Next
            'n_count2 = 0
            'n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            'worksheet117.Cells(x, Y) = n_Taken / n_count2
            'range1 = worksheet117.Cells(x, Y)
            'range1.NumberFormat = "0%"
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("J" & x, "J" & x).Interior.Color = RGB(112, 254, 153)
            'Y = Y + 1

            ''DARK
            ''COLOR
            'SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Dark' AND " & _
            '"m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            'n_Taken = 0
            'M1 = 0
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
            '    M1 = M1 + 1
            'Next
            'n_count2 = 0
            'n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            'worksheet117.Cells(x, Y) = n_Taken / n_count2
            'range1 = worksheet117.Cells(x, Y)
            'range1.NumberFormat = "0%"
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("K" & x, "K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("K" & x, "K" & x).Interior.Color = RGB(112, 254, 153)
            'Y = Y + 1

            ''EXDARK
            ''COLOR
            'SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot INNER JOIN M08Sub_Shade ON M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M08cl='Colour' AND M08SUBNAME='Extra Dark' AND " & _
            '"m04Etime between '" & WeekStartdate & "' and '" & WeekEnddate & "' AND M04ProgrameType='N' AND T03TYPE IN ('01','02') GROUP BY M08cl"
            'n_Taken = 0
            'M1 = 0
            'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            'For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '    ' n_count = n_count + Val(T03.Tables(0).Rows(M1)("ncount"))
            '    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("M04Batchwt"))
            '    M1 = M1 + 1
            'Next
            'n_count2 = 0
            'n_count2 = (worksheet117.Range("E" & x).Value.ToString)
            'worksheet117.Cells(x, Y) = n_Taken / n_count2
            'range1 = worksheet117.Cells(x, Y)
            'range1.NumberFormat = "0%"
            'worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet117.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("L" & x, "L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet117.Range("L" & x, "L" & x).Interior.Color = RGB(112, 254, 153)
            'Y = Y + 1


            worksheet117.Range("M" & (x)).Formula = "=(I" & x & "*E" & x & "/d" & x & ")"
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("M" & x, "M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("M" & x, "M" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1

          
            worksheet117.Range("N" & (x)).Formula = "=(J" & x & "*E" & x & "/d" & x & ")"
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("N" & x, "N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("N" & x, "N" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1

        
            worksheet117.Range("O" & (x)).Formula = "=(K" & x & "*E" & x & "/d" & x & ")"
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("O" & x, "O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("O" & x, "O" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1

         
            worksheet117.Range("P" & (x)).Formula = "=(L" & x & "*E" & x & "/d" & x & ")"
            ' worksheet11.Cells(x, Y) = n_Taken / n_count2
            range1 = worksheet117.Cells(x, Y)
            range1.NumberFormat = "0%"
            worksheet117.Range(worksheet117.Cells(x, Y), worksheet117.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet117.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("P" & x, "P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet117.Range("P" & x, "P" & x).Interior.Color = RGB(155, 243, 241)
            Y = Y + 1
            x = x + 1
            i = i + 1
        Next



            'chart
            Dim chartPage As Microsoft.Office.Interop.Excel.Chart
            Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
            Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
            Dim chartRange As Microsoft.Office.Interop.Excel.Range
            Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
            Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


            Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
            Dim t_Series As Microsoft.Office.Interop.Excel.Series
            Dim z1 As Integer
            Dim sh As Worksheet
            xlCharts = worksheet117.ChartObjects

            Dim _Chartlocation As Integer
            Dim rh As Double

            _Chartlocation = (x + 12) * 10
            rh = (x - 1) * 12.75
            rh = rh + 4
            myChart = xlCharts.Add(7, rh, 905, 300)
            chartPage = myChart.Chart
            Dim _CH As Integer
            '_CH = 7
            'For _CH = 7 To x - 1
            chartRange = worksheet117.Range("H4", "H" & (x - 1))
            chartRange1 = worksheet117.Range("A4", "A" & (x - 1))
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "White & Mal"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
            chartPage.HasTitle = True
            chartPage.ChartTitle.Text = ("White & Mal")
            chartPage.Refresh()

            chartPage.Refresh()

            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLineMarkers

            _Chartlocation = _Chartlocation + 300
            rh = rh + 300
            myChart = xlCharts.Add(7, rh, 905, 300)
            chartPage = myChart.Chart

            chartRange = worksheet117.Range("H4", "H" & (x - 1))
            chartRange1 = worksheet117.Range("A4", "A" & (x - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "White & Mal"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            'chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)

            'LIGHT
            chartRange = worksheet117.Range("M4", "M" & (x - 1))
            '  chartRange1 = worksheet11.Range("A4", "A" & (x - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Light"
                '    t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(180, 70, 58)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(180, 70, 58)


            'MEDIUM
            chartRange = worksheet117.Range("N4", "N" & (x - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Medium"
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(0, 153, 0)

            'Dark
            chartRange = worksheet117.Range("o4", "o" & (x - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Dark"
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(158, 0, 214)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(4).Interior.Color = RGB(158, 0, 214)

            'Extra Dark
            chartRange = worksheet117.Range("p4", "p" & (x - 1))
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Extra Dark"
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(21, 194, 255)
            '  t_Series.Points.mark = RGB(255, 255, 0)
            chartPage.SeriesCollection(5).Interior.Color = RGB(21, 194, 255)

            chartPage.HasTitle = True
            chartPage.ChartTitle.Text = ("Shade distribution")
            chartPage.Refresh()

            chartPage.Refresh()

            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLineMarkers

    End Function

    Function Product_Af()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet118 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet118.Name = "Product & Depth Mix(AF)"

        worksheet118.Columns("A").ColumnWidth = 3
        worksheet118.Columns("B").ColumnWidth = 3
        worksheet118.Columns("C").ColumnWidth = 13
        worksheet118.Columns("D").ColumnWidth = 10
        worksheet118.Columns("E").ColumnWidth = 10
        worksheet118.Columns("F").ColumnWidth = 10
        worksheet118.Columns("G").ColumnWidth = 10
        worksheet118.Columns("H").ColumnWidth = 13
        worksheet118.Columns("I").ColumnWidth = 13
        worksheet118.Columns("J").ColumnWidth = 13


        worksheet118.Range("c2:c2").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("c2:c2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("c2:c2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("c2:c2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(2, 4) = "All dye machine"
        worksheet118.Rows(2).Font.Bold = True
        worksheet118.Rows(2).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet118.Range("d2:d2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet118.Range(worksheet118.Cells(2, 4), worksheet118.Cells(2, 10)).Merge()
        worksheet118.Range(worksheet118.Cells(2, 4), worksheet118.Cells(2, 10)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("d2:d2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("d2:d2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("e2:e2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("e2:e2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("f2:f2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("f2:f2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("g2:g2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("g2:g2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("h2:h2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("h2:h2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("i2:i2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("i2:i2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("j2:j2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("j2:j2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("j2:j2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet118.Range("C2:C2").Interior.Color = RGB(252, 213, 180)
        worksheet118.Range("d2:d2").Interior.Color = RGB(252, 213, 180)

        worksheet118.Range("c3:c3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("c3:c3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("c3:c3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("c3:c3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("C3:C3").Interior.Color = RGB(252, 213, 180)
        worksheet118.Range("d3:d3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("d3:d3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("d3:d3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 4) = "Light"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("d3:d3").Interior.Color = RGB(252, 213, 180)


        worksheet118.Range("e3:e3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("e3:e3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("e3:e3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 5) = "Medium"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("e3:e3").Interior.Color = RGB(252, 213, 180)

        worksheet118.Range("f3:f3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("f3:f3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("f3:f3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 6) = "Dark"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("f3:f3").Interior.Color = RGB(252, 213, 180)

        worksheet118.Range("g3:g3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("g3:g3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("g3:g3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 7) = "Extra Dark"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("g3:g3").Interior.Color = RGB(252, 213, 180)

        worksheet118.Range("h3:h3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("h3:h3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("h3:h3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 8) = "Non-Biopolish"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("h3:h3").Interior.Color = RGB(255, 192, 0)

        worksheet118.Range("i3:i3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("i3:i3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("i3:i3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 9) = "Biopolish"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("i3:i3").Interior.Color = RGB(255, 192, 0)

        worksheet118.Range("j3:j3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("j3:j3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Range("j3:j3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet118.Cells(3, 10) = "Viscose"
        worksheet118.Rows(3).Font.Bold = True
        worksheet118.Rows(3).Font.size = 10
        worksheet118.Cells(3, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet118.Range("j3:j3").Interior.Color = RGB(255, 192, 0)


        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        '  n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 3
        x = 4
        Dim exSheet As Microsoft.Office.Interop.Excel.Worksheet
        exSheet = workbooks(1).Worksheets(3)
        Dim _Coulor As Integer
        Dim _Light As Integer
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 3
            _Coulor = 0
            _Light = 0

            worksheet118.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("C" & x & ":c" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("C" & x & ":c" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("C" & x & ":c" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            _Coulor = exSheet.Cells(x, 2).Value
            _Light = exSheet.Cells(x, 5).Value


            Y = Y + 1

            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("d" & x, "d" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("d" & x, "d" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("d" & x, "d" & x).Interior.Color = RGB(204, 255, 204)

            Y = Y + 1
            _Light = 0
            _Light = exSheet.Cells(x, 6).Value
            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("e" & x, "e" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("e" & x, "e" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("e" & x, "e" & x).Interior.Color = RGB(204, 255, 204)
            Y = Y + 1
            _Light = 0

            _Light = exSheet.Cells(x, 7).Value
            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("f" & x, "f" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("f" & x, "f" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("f" & x, "f" & x).Interior.Color = RGB(204, 255, 204)
            Y = Y + 1
            _Light = 0

            _Light = exSheet.Cells(x, 8).Value
            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("g" & x, "g" & x).Interior.Color = RGB(204, 255, 204)
            Y = Y + 1
            '----------------------------------------------------------------------
            'NON BIO POLISH
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"

            _Coulor = 0
            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
                   " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _Coulor = T03.Tables(0).Rows.Count
            End If


            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                  " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                  "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
                    " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B'"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            _Light = 0
            If isValidDataset(T03) Then
                _Light = T03.Tables(0).Rows.Count

            End If
            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("H" & x, "H" & x).Interior.Color = RGB(204, 255, 255)
            Y = Y + 1

            'BIO POISH
            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
           " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)  inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
           " WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
             " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B'"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            _Light = 0
            If isValidDataset(T03) Then
                _Light = T03.Tables(0).Rows.Count

            End If
            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("I" & x, "I" & x).Interior.Color = RGB(204, 255, 255)
            Y = Y + 1

            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
           " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)  inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
           "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
             " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M09TYPE='VISCOSE' "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            _Light = 0
            If isValidDataset(T03) Then
                _Light = T03.Tables(0).Rows.Count

            End If
            worksheet118.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet118.Cells(x, Y)
            worksheet118.Range(worksheet118.Cells(x, Y), worksheet118.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet118.Rows(x).Font.size = 10
            worksheet118.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet118.Range("J" & x, "J" & x).Interior.Color = RGB(204, 255, 255)
            x = x + 1

            i = i + 1
        Next


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim _Chartlocation As Integer
        Dim rh As Double
        _Chartlocation = (x * 10) + 80

        rh = (x - 3) * 12.75
        rh = rh + 32
        xlCharts = worksheet118.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        '  chartPage.SeriesCollection.NewSeries()
        '  chartPage.SeriesCollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        ' chartPage.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))

        chartRange = worksheet118.Range("c3", "g" & (x - 1))
        ' chartPage.ChartObjects(1).CHART.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))
        'chartPage.ChartObjects(1).chart.seriescollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        '  chartPage.SeriesCollection(1).Series.AxisX = worksheet11.Range("A8", "A" & (X - 1))
        ' t_Series = chartPage.SeriesCollection.NewSeries
        ' t_Series.Name = "Q1"
        '   sh = "Weekly Down Time Analysis"
        ' t_Series.Values = "='Weekly Down Time Analysis'!$A$8:$E$21" '& chartRange
        ' t_Series.XValues = "='Weekly Down Time Analysis'!$A$9:$A$21"
        ' chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$B$8:$E$21"))
        'chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$A$8:$A$21"))
        chartPage.SetSourceData(Source:=chartRange)
        chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True

        chartPage.ChartTitle.Text = ("Light - Medium -Dark shade % Analysis")


        xlCharts = worksheet118.ChartObjects
        _Chartlocation = _Chartlocation + 300
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet118.Range("h4", "h" & (x - 1))
        chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Non-Biopolish"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(146, 208, 80)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(146, 208, 80)
        chartPage.HasTitle = True
        ' chartPage.ChartTitle.Text = ("White & Mal")


        chartRange = worksheet118.Range("i4", "i" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Biopolish"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 91, 91)

        chartRange = worksheet118.Range("j4", "j" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Viscose"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(141, 180, 227)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(141, 180, 227)

      
        chartPage.HasTitle = False
        'chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked


   
    End Function

    Function Product_WJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet119 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet119.Name = "Product & Depth Mix(WJ)"

        worksheet119.Columns("A").ColumnWidth = 3
        worksheet119.Columns("B").ColumnWidth = 3
        worksheet119.Columns("C").ColumnWidth = 13
        worksheet119.Columns("D").ColumnWidth = 10
        worksheet119.Columns("E").ColumnWidth = 10
        worksheet119.Columns("F").ColumnWidth = 10
        worksheet119.Columns("G").ColumnWidth = 10
        worksheet119.Columns("H").ColumnWidth = 13
        worksheet119.Columns("I").ColumnWidth = 13
        worksheet119.Columns("J").ColumnWidth = 13


        worksheet119.Range("c2:c2").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("c2:c2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("c2:c2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("c2:c2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(2, 4) = "All dye machine"
        worksheet119.Rows(2).Font.Bold = True
        worksheet119.Rows(2).Font.size = 11
        'range1 = worksheet1.Cells("B2:G2")

        worksheet119.Range("d2:d2").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet119.Range(worksheet119.Cells(2, 4), worksheet119.Cells(2, 10)).Merge()
        worksheet119.Range(worksheet119.Cells(2, 4), worksheet119.Cells(2, 10)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("d2:d2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("d2:d2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("e2:e2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("e2:e2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("f2:f2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("f2:f2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("g2:g2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("g2:g2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("h2:h2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("h2:h2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("i2:i2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("i2:i2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("j2:j2").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("j2:j2").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("j2:j2").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet119.Range("C2:C2").Interior.Color = RGB(252, 213, 180)
        worksheet119.Range("d2:d2").Interior.Color = RGB(252, 213, 180)

        worksheet119.Range("c3:c3").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("c3:c3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("c3:c3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("c3:c3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("C3:C3").Interior.Color = RGB(252, 213, 180)
        worksheet119.Range("d3:d3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("d3:d3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("d3:d3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 4) = "Light"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("d3:d3").Interior.Color = RGB(252, 213, 180)


        worksheet119.Range("e3:e3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("e3:e3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("e3:e3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 5) = "Medium"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("e3:e3").Interior.Color = RGB(252, 213, 180)

        worksheet119.Range("f3:f3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("f3:f3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("f3:f3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 6) = "Dark"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("f3:f3").Interior.Color = RGB(252, 213, 180)

        worksheet119.Range("g3:g3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("g3:g3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("g3:g3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 7) = "Extra Dark"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("g3:g3").Interior.Color = RGB(252, 213, 180)

        worksheet119.Range("h3:h3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("h3:h3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("h3:h3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 8) = "Non-Biopolish"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("h3:h3").Interior.Color = RGB(255, 192, 0)

        worksheet119.Range("i3:i3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("i3:i3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("i3:i3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 9) = "Biopolish"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("i3:i3").Interior.Color = RGB(255, 192, 0)

        worksheet119.Range("j3:j3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("j3:j3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Range("j3:j3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet119.Cells(3, 10) = "Viscose"
        worksheet119.Rows(3).Font.Bold = True
        worksheet119.Rows(3).Font.size = 10
        worksheet119.Cells(3, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet119.Range("j3:j3").Interior.Color = RGB(255, 192, 0)


        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        '  n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 3
        x = 4
        Dim exSheet As Microsoft.Office.Interop.Excel.Worksheet
        exSheet = workbooks(1).Worksheets(2)
        '  MsgBox(exSheet.Name)
        Dim _Coulor As Integer
        Dim _Light As Integer
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 3
            _Coulor = 0
            _Light = 0

            worksheet119.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("C" & x & ":c" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("C" & x & ":c" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("C" & x & ":c" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            _Coulor = exSheet.Cells(x, 11).Value
            _Light = exSheet.Cells(x, 14).Value


            Y = Y + 1
            If _Coulor = 0 And _Light = 0 Then
                worksheet119.Cells(x, Y) = "0"
            Else
                worksheet119.Cells(x, Y) = (_Light / _Coulor)
            End If
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("d" & x, "d" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("d" & x, "d" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("d" & x, "d" & x).Interior.Color = RGB(204, 255, 204)

            Y = Y + 1
            _Light = 0
            _Light = exSheet.Cells(x, 15).Value
            If _Coulor = 0 And _Light = 0 Then
                worksheet119.Cells(x, Y) = "0"
            Else
                worksheet119.Cells(x, Y) = (_Light / _Coulor)
            End If
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("e" & x, "e" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("e" & x, "e" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("e" & x, "e" & x).Interior.Color = RGB(204, 255, 204)
            Y = Y + 1
            _Light = 0

            _Light = exSheet.Cells(x, 16).Value
            If _Coulor = 0 And _Light = 0 Then
                worksheet119.Cells(x, Y) = "0"
            Else
                worksheet119.Cells(x, Y) = (_Light / _Coulor)
            End If
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("f" & x, "f" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("f" & x, "f" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("f" & x, "f" & x).Interior.Color = RGB(204, 255, 204)
            Y = Y + 1
            _Light = 0

            _Light = exSheet.Cells(x, 17).Value
            If _Coulor = 0 And _Light = 0 Then
                worksheet119.Cells(x, Y) = "0"
            Else
                worksheet119.Cells(x, Y) = (_Light / _Coulor)
            End If
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("g" & x, "g" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("g" & x, "g" & x).Interior.Color = RGB(204, 255, 204)
            Y = Y + 1
            '----------------------------------------------------------------------
            'NON BIO POLISH
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"

            _Coulor = 0
            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
                   " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _Coulor = T03.Tables(0).Rows.Count
            End If


            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                  " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                  "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
                    " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B'"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            _Light = 0
            If isValidDataset(T03) Then
                _Light = T03.Tables(0).Rows.Count

            End If
            worksheet119.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("H" & x, "H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("H" & x, "H" & x).Interior.Color = RGB(204, 255, 255)
            Y = Y + 1

            'BIO POISH
            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
           " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)  inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
           " WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
             " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B'"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            _Light = 0
            If isValidDataset(T03) Then
                _Light = T03.Tables(0).Rows.Count

            End If
            worksheet119.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("I" & x, "I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("I" & x, "I" & x).Interior.Color = RGB(204, 255, 255)
            Y = Y + 1

            SQL = "select M09Dis,M09TYPE from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
           " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)  inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
           "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour'" & _
             " AND M04eTIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND M09TYPE='VISCOSE' "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            _Light = 0
            If isValidDataset(T03) Then
                _Light = T03.Tables(0).Rows.Count

            End If
            worksheet119.Cells(x, Y) = (_Light / _Coulor)
            range1 = worksheet119.Cells(x, Y)
            worksheet119.Range(worksheet119.Cells(x, Y), worksheet119.Cells(x, Y)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1.NumberFormat = "0%"
            worksheet119.Rows(x).Font.size = 10
            worksheet119.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("J" & x, "J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet119.Range("J" & x, "J" & x).Interior.Color = RGB(204, 255, 255)
            x = x + 1

            i = i + 1
        Next


        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim _Chartlocation As Integer
        Dim rh As Integer
        _Chartlocation = (x * 10) + 80

        rh = (x - 3) * 12.75
        rh = rh + 32
        xlCharts = worksheet119.ChartObjects
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        '  chartPage.SeriesCollection.NewSeries()
        '  chartPage.SeriesCollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        ' chartPage.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))

        chartRange = worksheet119.Range("c3", "g" & (x - 1))
        ' chartPage.ChartObjects(1).CHART.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))
        'chartPage.ChartObjects(1).chart.seriescollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        '  chartPage.SeriesCollection(1).Series.AxisX = worksheet11.Range("A8", "A" & (X - 1))
        ' t_Series = chartPage.SeriesCollection.NewSeries
        ' t_Series.Name = "Q1"
        '   sh = "Weekly Down Time Analysis"
        ' t_Series.Values = "='Weekly Down Time Analysis'!$A$8:$E$21" '& chartRange
        ' t_Series.XValues = "='Weekly Down Time Analysis'!$A$9:$A$21"
        ' chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$B$8:$E$21"))
        'chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$A$8:$A$21"))
        chartPage.SetSourceData(Source:=chartRange)
        chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns

        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        chartPage.HasTitle = True

        chartPage.ChartTitle.Text = ("Light - Medium -Dark shade % Analysis")


        xlCharts = worksheet119.ChartObjects
        _Chartlocation = _Chartlocation + 300
        rh = rh + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet119.Range("h4", "h" & (x - 1))
        chartRange1 = worksheet119.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Non-Biopolish"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(146, 208, 80)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(146, 208, 80)
        chartPage.HasTitle = True
        ' chartPage.ChartTitle.Text = ("White & Mal")


        chartRange = worksheet119.Range("i4", "i" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Biopolish"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 91, 91)

        chartRange = worksheet119.Range("j4", "j" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Viscose"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        t_Series.Border.Color = RGB(141, 180, 227)
        chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(141, 180, 227)


        chartPage.HasTitle = False
        'chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked



    End Function

    Function Avarage_SDTimeDaily_WJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Average STD time(WJ) - Daily"

        worksheet11.Columns("A").ColumnWidth = 3
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 8
        worksheet11.Columns("F").ColumnWidth = 8
        worksheet11.Columns("G").ColumnWidth = 8
        worksheet11.Columns("H").ColumnWidth = 8
        worksheet11.Columns("I").ColumnWidth = 8
        worksheet11.Columns("J").ColumnWidth = 1
        worksheet11.Columns("k").ColumnWidth = 8
        worksheet11.Columns("l").ColumnWidth = 8
        worksheet11.Columns("M").ColumnWidth = 8
        worksheet11.Columns("N").ColumnWidth = 8
        worksheet11.Columns("O").ColumnWidth = 8
        worksheet11.Columns("P").ColumnWidth = 8
        worksheet11.Columns("Q").ColumnWidth = 8
        worksheet11.Columns("R").ColumnWidth = 8

        worksheet11.Columns("S").ColumnWidth = 8
        worksheet11.Columns("T").ColumnWidth = 8



        worksheet11.Range("B3:B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q3:Q3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R3:R3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S3:S3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(3, 2) = "Water Jet machine (ECO 02 - ITM 23) Average Standard Time(Daily) "
        worksheet11.Rows(3).Font.Bold = True
        worksheet11.Rows(3).Font.size = 14


        worksheet11.Range("B3:T3").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells(4, 2), worksheet11.Cells(4, 20)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B4, T4").Interior.Color = RGB(255, 255, 255)

        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J4:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K4:K4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L4:L4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M4:M4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N4:N4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O4:O4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P4:P4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q4:Q4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R4:R4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S4:S4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T4:T4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 3) = "Total average STD time"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Rows(5).rowheight = 20.25
        worksheet11.Range("C5:D5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C5, D5").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(5, 5) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("D5:O5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 16) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("P5:T5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K5:K5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L5:L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M5:M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N5:N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P5:P5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q5:Q5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R5:R5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S5:S5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 2) = "Date"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Range(worksheet11.Cells(6, 2), worksheet11.Cells(6, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
      
        worksheet11.Range(worksheet11.Cells(6, 3), worksheet11.Cells(6, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C6, C6").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 4), worksheet11.Cells(6, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 4).WrapText = True
        worksheet11.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(6, 5) = "Cotton"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("e6:i6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 5), worksheet11.Cells(6, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 9), worksheet11.Cells(6, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("i6:i6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 10) = " Bio-polish"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("j6:o6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("p6:p6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 16) = "Viscose"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("p6:t6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("t6:t6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J6:J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K6:K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L6:L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M6:M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N6:N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O6:O6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P6:P6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q6:Q6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R6:R6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S6:S6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T6:T6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 3) = "hrs/ batch"
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 10

        worksheet11.Range("c7:c7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C7, c7").Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(7, 4) = "hrs/ batch"
        worksheet11.Range("d7:d7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 5) = "Light"
        worksheet11.Range("e7:e7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 5), worksheet11.Cells(7, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 6) = "Medium"
        worksheet11.Range("f7:f7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 7) = "Dark"
        worksheet11.Range("g7:g7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 7), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 8) = "Extra Dark"
        worksheet11.Range("h7:h7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 9) = "Avg"
        worksheet11.Range("i7:i7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 9), worksheet11.Cells(7, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 11) = "Light"
        worksheet11.Range("k7:k7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 11), worksheet11.Cells(7, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 12) = "Medium"
        worksheet11.Range("l7:l7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 12), worksheet11.Cells(7, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 13) = "Dark"
        worksheet11.Range("m7:m7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 13), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 14) = "Extra Dark"
        worksheet11.Range("n7:n7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 15) = "Avg"
        worksheet11.Range("o7:o7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 15), worksheet11.Cells(7, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter



        worksheet11.Cells(7, 16) = "Light"
        worksheet11.Range("p7:p7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 16), worksheet11.Cells(7, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 17) = "Medium"
        worksheet11.Range("q7:q7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 17), worksheet11.Cells(7, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 18) = "Dark"
        worksheet11.Range("r7:r7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 18), worksheet11.Cells(7, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 19) = "Extra Dark"
        worksheet11.Range("s7:s7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 19), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 20) = "Avg"
        worksheet11.Range("t7:t7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 20), worksheet11.Cells(7, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Range("B7:B7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C7:C7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D7:D7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E7:E7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F7:F7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G7:G7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H7:H7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I7:I7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J7:J7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K7:K7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L7:L7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M7:M7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N7:N7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O7:O7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P7:P7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q7:Q7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R7:R7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S7:S7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("c7:c7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d7:d7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("e7:e7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("f7:f7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("g7:g7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("h7:h7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("i7:i7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j7:j7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k7:k7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("l7:l7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("m7:m7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("n7:n7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("o7:o7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("p7:p7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("q7:r7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("s7:s7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-daysInFeb)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        worksheet11.Range("B5:B7").Interior.Color = RGB(255, 255, 255)

        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 8
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"


            'COLOUR
            Dim _STD As Double
            Dim _Count As Integer

            _STD = 0
            _Count = 0
            SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                'range1 = worksheet11.Cells(x, Y)
                'range1.Font.Color = RGB(255, 0, 0)
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1

            '========================================= WHITE & MAL
            _STD = 0
            _Count = 0

            Dim F As Integer
            F = 0

            SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL IN ('MARL & Yarn dye','White') group by M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow1 As DataRow In T03.Tables(0).Rows
                'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                'range1 = worksheet11.Cells(x, Y)
                'range1.Font.Color = RGB(255, 0, 0)
                _STD = _STD + T03.Tables(0).Rows(F)("STD")
                '_STD = _STD / 60
                '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                _Count = _Count + T03.Tables(0).Rows(F)("CCount")
                F = F + 1
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / _Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=============================================================================BIO POLISH
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 2
            '-----------------------------------------------------------------------------
            'BIO POLISH
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '----------------------------------------------------------------
            'VISCOSE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            ' Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            x = x + 1
            i = i + 1
        Next

        x = x + 5



        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 2) = "Water Jet   No. of batches   details(Daily)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 14


        worksheet11.Range("B" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells((x + 1), 2), worksheet11.Cells((x + 1), 21)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x, "T" & x).Interior.Color = RGB(255, 255, 255)

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & (x - 1) & ":u" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'x = x + 1
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "No. of  batches"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Rows(x).rowheight = 20.25
        worksheet11.Range("C" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":D" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(x, 5) = "No. of batches (Colour)- Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("D" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "No. of batches (Colour)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 2) = "Date"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 4), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 4).WrapText = True
        worksheet11.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("E" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j" & x & ":j" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 11) = " Bio-polish"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range("k" & x & ":k" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "Viscose"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        x = x + 1
        worksheet11.Cells(x, 3) = "hrs/ batch"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("C" & x & ":C" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("c" & x & ":c" & x).Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(x, 4) = "hrs/ batch"
        worksheet11.Range("D" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Light"
        worksheet11.Range("E" & x & ":E" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 6) = "Medium"
        worksheet11.Range("F" & x & ":F" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 7) = "Dark"
        worksheet11.Range("G" & x & ":G" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 7), worksheet11.Cells(x, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 8) = "Extra Dark"
        worksheet11.Range("H" & x & ":H" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 8), worksheet11.Cells(x, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 9) = "Total"
        worksheet11.Range("I" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 11) = "Light"
        worksheet11.Range("K" & x & ":K" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 12) = "Medium"
        worksheet11.Range("L" & x & ":L" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 12), worksheet11.Cells(x, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 13) = "Dark"
        worksheet11.Range("M" & x & ":M" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 13), worksheet11.Cells(x, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 14) = "Extra Dark"
        worksheet11.Range("N" & x & ":N" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 14), worksheet11.Cells(x, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 15) = "Total"
        worksheet11.Range("O" & x & ":O" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 15), worksheet11.Cells(x, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 16) = "%"
        worksheet11.Range("p" & x & ":p" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 16), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(x, 16)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet11.Cells(x, 17) = "Light"
        worksheet11.Range("q" & x & ":q" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 18) = "Medium"
        worksheet11.Range("R" & x & ":R" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 18), worksheet11.Cells(x, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 19) = "Dark"
        worksheet11.Range("S" & x & ":S" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 19), worksheet11.Cells(x, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 20) = "Extra Dark"
        worksheet11.Range("T" & x & ":T" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 20), worksheet11.Cells(x, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 21) = "Total"
        worksheet11.Range("U" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 21), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
             "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0

        ' Dim Y As Integer
        Y = 2
        x = x + 1
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Y = Y + 1

            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"


            'COLOUR
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
            Else
                worksheet11.Cells(x, Y) = "0"
            End If

            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            'WHITE
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL in ('White','MARL & Yarn dye') group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count

            End If

            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            '---------------------------------------------------------------------------------
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
             "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
             " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(e" & x & ":h" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 2

            '-----------------------------------------------------------------------
            Dim N_COUNT1 As Integer

            N_COUNT1 = 0
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)
                N_COUNT1 = T03.Tables(0).Rows.Count
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(K" & x & ":N" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Dim n_count As Integer


            ' N_COUNT1 = 0
            n_count = 0
            n_count = (worksheet11.Range("C" & x).Value.ToString)
            If n_count > 0 Then
                worksheet11.Cells(x, Y) = N_COUNT1 / n_count
            Else
                worksheet11.Cells(x, Y) = "0"
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1





            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(Q" & x & ":T" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

    End Function

    Function Avarage_SDTimeDaily_AF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Average STD time(AF) - Daily"

        worksheet11.Columns("A").ColumnWidth = 3
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 8
        worksheet11.Columns("F").ColumnWidth = 8
        worksheet11.Columns("G").ColumnWidth = 8
        worksheet11.Columns("H").ColumnWidth = 8
        worksheet11.Columns("I").ColumnWidth = 8
        worksheet11.Columns("J").ColumnWidth = 1
        worksheet11.Columns("k").ColumnWidth = 8
        worksheet11.Columns("l").ColumnWidth = 8
        worksheet11.Columns("M").ColumnWidth = 8
        worksheet11.Columns("N").ColumnWidth = 8
        worksheet11.Columns("O").ColumnWidth = 8
        worksheet11.Columns("P").ColumnWidth = 8
        worksheet11.Columns("Q").ColumnWidth = 8
        worksheet11.Columns("R").ColumnWidth = 8

        worksheet11.Columns("S").ColumnWidth = 8
        worksheet11.Columns("T").ColumnWidth = 8



        worksheet11.Range("B3:B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q3:Q3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R3:R3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S3:S3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(3, 2) = "Air Flow machine (LR 01 - LR 09) Average Standard Time(Daily) "
        worksheet11.Rows(3).Font.Bold = True
        worksheet11.Rows(3).Font.size = 14


        worksheet11.Range("B3:T3").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells(4, 2), worksheet11.Cells(4, 20)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B4, T4").Interior.Color = RGB(255, 255, 255)

        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J4:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K4:K4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L4:L4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M4:M4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N4:N4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O4:O4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P4:P4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q4:Q4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R4:R4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S4:S4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T4:T4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 3) = "Total average STD time"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Rows(5).rowheight = 20.25
        worksheet11.Range("C5:D5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C5, D5").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(5, 5) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("D5:O5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 16) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("P5:T5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K5:K5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L5:L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M5:M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N5:N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P5:P5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q5:Q5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R5:R5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S5:S5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 2) = "Date"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Range(worksheet11.Cells(6, 2), worksheet11.Cells(6, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 3), worksheet11.Cells(6, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C6, C6").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 4), worksheet11.Cells(6, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 4).WrapText = True
        worksheet11.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(6, 5) = "Cotton"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("e6:i6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 5), worksheet11.Cells(6, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 9), worksheet11.Cells(6, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("i6:i6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 10) = " Bio-polish"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("j6:o6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("p6:p6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 16) = "Viscose"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("p6:t6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("t6:t6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J6:J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K6:K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L6:L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M6:M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N6:N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O6:O6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P6:P6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q6:Q6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R6:R6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S6:S6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T6:T6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 3) = "hrs/ batch"
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 10

        worksheet11.Range("c7:c7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C7, c7").Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(7, 4) = "hrs/ batch"
        worksheet11.Range("d7:d7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 5) = "Light"
        worksheet11.Range("e7:e7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 5), worksheet11.Cells(7, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 6) = "Medium"
        worksheet11.Range("f7:f7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 7) = "Dark"
        worksheet11.Range("g7:g7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 7), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 8) = "Extra Dark"
        worksheet11.Range("h7:h7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 9) = "Avg"
        worksheet11.Range("i7:i7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 9), worksheet11.Cells(7, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 11) = "Light"
        worksheet11.Range("k7:k7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 11), worksheet11.Cells(7, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 12) = "Medium"
        worksheet11.Range("l7:l7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 12), worksheet11.Cells(7, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 13) = "Dark"
        worksheet11.Range("m7:m7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 13), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 14) = "Extra Dark"
        worksheet11.Range("n7:n7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 15) = "Avg"
        worksheet11.Range("o7:o7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 15), worksheet11.Cells(7, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter



        worksheet11.Cells(7, 16) = "Light"
        worksheet11.Range("p7:p7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 16), worksheet11.Cells(7, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 17) = "Medium"
        worksheet11.Range("q7:q7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 17), worksheet11.Cells(7, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 18) = "Dark"
        worksheet11.Range("r7:r7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 18), worksheet11.Cells(7, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 19) = "Extra Dark"
        worksheet11.Range("s7:s7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 19), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 20) = "Avg"
        worksheet11.Range("t7:t7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 20), worksheet11.Cells(7, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Range("B7:B7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C7:C7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D7:D7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E7:E7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F7:F7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G7:G7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H7:H7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I7:I7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J7:J7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K7:K7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L7:L7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M7:M7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N7:N7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O7:O7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P7:P7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q7:Q7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R7:R7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S7:S7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("c7:c7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d7:d7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("e7:e7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("f7:f7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("g7:g7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("h7:h7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("i7:i7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j7:j7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k7:k7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("l7:l7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("m7:m7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("n7:n7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("o7:o7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("p7:p7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("q7:r7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("s7:s7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-daysInFeb)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        worksheet11.Range("B5:B7").Interior.Color = RGB(255, 255, 255)

        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 8
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"


            'COLOUR
            Dim _STD As Double
            Dim _Count As Integer

            _STD = 0
            _Count = 0
            SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                'range1 = worksheet11.Cells(x, Y)
                'range1.Font.Color = RGB(255, 0, 0)
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1

            '========================================= WHITE & MAL
            _STD = 0
            _Count = 0
            SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL IN ('MARL & Yarn dye','White') group by M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                'range1 = worksheet11.Cells(x, Y)
                'range1.Font.Color = RGB(255, 0, 0)
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=============================================================================BIO POLISH
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 2
            '-----------------------------------------------------------------------------
            'BIO POLISH
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '----------------------------------------------------------------
            'VISCOSE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                 "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                   " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                _STD = T03.Tables(0).Rows(0)("STD")
                _STD = _STD / 60
                _STD = _STD / T03.Tables(0).Rows(0)("CCount")

            End If
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            ' Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            x = x + 1
            i = i + 1
        Next

        x = x + 5



        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 2) = "Air Flor   No. of batches   details(Daily)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 14


        worksheet11.Range("B" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells((x + 1), 2), worksheet11.Cells((x + 1), 21)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x, "T" & x).Interior.Color = RGB(255, 255, 255)

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & (x - 1) & ":u" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'x = x + 1
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "No. of  batches"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Rows(x).rowheight = 20.25
        worksheet11.Range("C" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":D" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(x, 5) = "No. of batches (Colour)- Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("D" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "No. of batches (Colour)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 2) = "Date"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 4), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 4).WrapText = True
        worksheet11.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("E" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j" & x & ":j" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 11) = " Bio-polish"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range("k" & x & ":k" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "Viscose"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        x = x + 1
        worksheet11.Cells(x, 3) = "hrs/ batch"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("C" & x & ":C" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("c" & x & ":c" & x).Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(x, 4) = "hrs/ batch"
        worksheet11.Range("D" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Light"
        worksheet11.Range("E" & x & ":E" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 6) = "Medium"
        worksheet11.Range("F" & x & ":F" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 7) = "Dark"
        worksheet11.Range("G" & x & ":G" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 7), worksheet11.Cells(x, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 8) = "Extra Dark"
        worksheet11.Range("H" & x & ":H" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 8), worksheet11.Cells(x, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 9) = "Total"
        worksheet11.Range("I" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 11) = "Light"
        worksheet11.Range("K" & x & ":K" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 12) = "Medium"
        worksheet11.Range("L" & x & ":L" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 12), worksheet11.Cells(x, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 13) = "Dark"
        worksheet11.Range("M" & x & ":M" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 13), worksheet11.Cells(x, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 14) = "Extra Dark"
        worksheet11.Range("N" & x & ":N" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 14), worksheet11.Cells(x, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 15) = "Total"
        worksheet11.Range("O" & x & ":O" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 15), worksheet11.Cells(x, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 16) = "%"
        worksheet11.Range("p" & x & ":p" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 16), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(x, 16)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet11.Cells(x, 17) = "Light"
        worksheet11.Range("q" & x & ":q" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 18) = "Medium"
        worksheet11.Range("R" & x & ":R" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 18), worksheet11.Cells(x, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 19) = "Dark"
        worksheet11.Range("S" & x & ":S" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 19), worksheet11.Cells(x, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 20) = "Extra Dark"
        worksheet11.Range("T" & x & ":T" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 20), worksheet11.Cells(x, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 21) = "Total"
        worksheet11.Range("U" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 21), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
             "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0

        ' Dim Y As Integer
        Y = 2
        x = x + 1
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Y = Y + 1

            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            x_date1 = x_date1 & " " & "7:30AM"


            'COLOUR
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
            End If

            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            'WHITE
            SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08CL in ('White','MARL & Yarn dye') group by M04Lotno,M08CL  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count

            End If

            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            '---------------------------------------------------------------------------------
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
             "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
             " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
  "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
  " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
               "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
               " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(e" & x & ":h" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 2

            '-----------------------------------------------------------------------
            Dim N_COUNT1 As Integer

            N_COUNT1 = 0
            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                '  range1 = worksheet11.Cells(x, 5)
                ' range1.Font.Color = RGB(0, 0, 255)
                N_COUNT1 = T03.Tables(0).Rows.Count
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(K" & x & ":N" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Dim n_count As Integer


            ' N_COUNT1 = 0
            n_count = 0
            n_count = (worksheet11.Range("C" & x).Value.ToString)
            worksheet11.Cells(x, Y) = N_COUNT1 / n_count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1





            SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
            T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(T03) Then
                worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

    End Function

    Function Avarage_SDTimeWeekly_WJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Average STD time(WJ) - Weekly"

        worksheet11.Columns("A").ColumnWidth = 3
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 8
        worksheet11.Columns("F").ColumnWidth = 8
        worksheet11.Columns("G").ColumnWidth = 8
        worksheet11.Columns("H").ColumnWidth = 8
        worksheet11.Columns("I").ColumnWidth = 8
        worksheet11.Columns("J").ColumnWidth = 1
        worksheet11.Columns("k").ColumnWidth = 8
        worksheet11.Columns("l").ColumnWidth = 8
        worksheet11.Columns("M").ColumnWidth = 8
        worksheet11.Columns("N").ColumnWidth = 8
        worksheet11.Columns("O").ColumnWidth = 8
        worksheet11.Columns("P").ColumnWidth = 8
        worksheet11.Columns("Q").ColumnWidth = 8
        worksheet11.Columns("R").ColumnWidth = 8

        worksheet11.Columns("S").ColumnWidth = 8
        worksheet11.Columns("T").ColumnWidth = 8



        worksheet11.Range("B3:B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q3:Q3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R3:R3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S3:S3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(3, 2) = "Water Jet machine (ECO 02 - ITM 23) Average Standard Time(Weekly) "
        worksheet11.Rows(3).Font.Bold = True
        worksheet11.Rows(3).Font.size = 14


        worksheet11.Range("B3:T3").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells(4, 2), worksheet11.Cells(4, 20)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B4, T4").Interior.Color = RGB(255, 255, 255)

        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J4:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K4:K4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L4:L4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M4:M4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N4:N4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O4:O4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P4:P4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q4:Q4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R4:R4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S4:S4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T4:T4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 3) = "Total average STD time"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Rows(5).rowheight = 20.25
        worksheet11.Range("C5:D5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C5, D5").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(5, 5) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("D5:O5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 16) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("P5:T5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K5:K5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L5:L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M5:M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N5:N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P5:P5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q5:Q5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R5:R5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S5:S5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 2) = "Date"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Range(worksheet11.Cells(6, 2), worksheet11.Cells(6, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 3), worksheet11.Cells(6, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C6, C6").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 4), worksheet11.Cells(6, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 4).WrapText = True
        worksheet11.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(6, 5) = "Cotton"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("e6:i6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 5), worksheet11.Cells(6, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 9), worksheet11.Cells(6, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("i6:i6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 10) = " Bio-polish"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("j6:o6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("p6:p6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 16) = "Viscose"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("p6:t6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("t6:t6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J6:J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K6:K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L6:L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M6:M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N6:N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O6:O6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P6:P6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q6:Q6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R6:R6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S6:S6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T6:T6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 3) = "hrs/ batch"
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 10

        worksheet11.Range("c7:c7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C7, c7").Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(7, 4) = "hrs/ batch"
        worksheet11.Range("d7:d7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 5) = "Light"
        worksheet11.Range("e7:e7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 5), worksheet11.Cells(7, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 6) = "Medium"
        worksheet11.Range("f7:f7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 7) = "Dark"
        worksheet11.Range("g7:g7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 7), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 8) = "Extra Dark"
        worksheet11.Range("h7:h7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 9) = "Avg"
        worksheet11.Range("i7:i7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 9), worksheet11.Cells(7, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 11) = "Light"
        worksheet11.Range("k7:k7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 11), worksheet11.Cells(7, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 12) = "Medium"
        worksheet11.Range("l7:l7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 12), worksheet11.Cells(7, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 13) = "Dark"
        worksheet11.Range("m7:m7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 13), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 14) = "Extra Dark"
        worksheet11.Range("n7:n7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 15) = "Avg"
        worksheet11.Range("o7:o7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 15), worksheet11.Cells(7, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter



        worksheet11.Cells(7, 16) = "Light"
        worksheet11.Range("p7:p7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 16), worksheet11.Cells(7, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 17) = "Medium"
        worksheet11.Range("q7:q7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 17), worksheet11.Cells(7, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 18) = "Dark"
        worksheet11.Range("r7:r7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 18), worksheet11.Cells(7, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 19) = "Extra Dark"
        worksheet11.Range("s7:s7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 19), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 20) = "Avg"
        worksheet11.Range("t7:t7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 20), worksheet11.Cells(7, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Range("B7:B7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C7:C7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D7:D7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E7:E7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F7:F7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G7:G7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H7:H7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I7:I7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J7:J7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K7:K7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L7:L7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M7:M7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N7:N7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O7:O7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P7:P7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q7:Q7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R7:R7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S7:S7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("c7:c7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d7:d7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("e7:e7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("f7:f7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("g7:g7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("h7:h7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("i7:i7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j7:j7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k7:k7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("l7:l7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("m7:m7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("n7:n7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("o7:o7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("p7:p7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("q7:r7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("s7:s7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        worksheet11.Range("B5:B7").Interior.Color = RGB(255, 255, 255)

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '      "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
            "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 8
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            ' x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            'x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"

            'Dim datDatum As Date
            'Dim intWkNo As Integer

            'Dim yX As Short
            'Dim w As Short
            'Dim d As Short
            'Dim sDate As Date
            'yX = T01.Tables(0).Rows(i)("EYEAR")
            'w = T01.Tables(0).Rows(i)("m04week")
            'sDate = CDate("01/01/" & yX)

            'intWkNo = Weekday(sDate, vbSunday)

            'If intWkNo = 1 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Sunday)
            'ElseIf intWkNo = 2 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Monday)
            'ElseIf intWkNo = 3 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Tuesday)
            'ElseIf intWkNo = 4 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Wednesday)
            'ElseIf intWkNo = 5 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Thursday)
            'ElseIf intWkNo = 6 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Friday)
            'ElseIf intWkNo = 7 Then
            '    d = 7 - Weekday(sDate, FirstDayOfWeek.Saturday)
            'End If
            'sDate = DateAdd(Microsoft.VisualBasic.DateInterval.WeekOfYear, w - 1, CDate("01/" & d & "/" & yX))

            'datDatum = CDate(sDate).AddDays(-6)
            'sDate = CDate(sDate).AddDays(+1)
            ''COLOR

            'datDatum = datDatum & " " & "7:30AM"
            'sDate = sDate & " " & "7:30AM"
            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer
          
            Dim Y_Date As Date
            Dim _STD As Double
            Dim _Count As Integer

            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"



                'COLOUR
               

                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")

                End If

            
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next


          
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If

            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1

            '========================================= WHITE & MAL

            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                Dim F As Integer
                F = 0
                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL IN ('MARL & Yarn dye','White') group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(F)("STD")
                    ' _STD = _STD / 60
                    CL_Count = CL_Count + T03.Tables(0).Rows(F)("CCount")
                    F = F + 1
                Next
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=============================================================================BIO POLISH
            _STD = 0
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '   _STD = _STD / 60
                    '  _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 2
            '-----------------------------------------------------------------------------
            'BIO POLISH
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '----------------------------------------------------------------
            'VISCOSE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            ' Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            x = x + 1
            i = i + 1
        Next

            x = x + 5



            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 2) = "Water Jet   No. of batches   details(Weekly)"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 14


            worksheet11.Range("B" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range(worksheet11.Cells((x + 1), 2), worksheet11.Cells((x + 1), 21)).Merge()
            '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("B" & x, "T" & x).Interior.Color = RGB(255, 255, 255)

            x = x + 1
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & (x - 1) & ":u" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            'x = x + 1
            'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(x, 3) = "No. of  batches"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10
            worksheet11.Rows(x).rowheight = 20.25
            worksheet11.Range("C" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("C" & x & ":D" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Cells(x, 5) = "No. of batches (Colour)- Cotton"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range("D" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(x, 17) = "No. of batches (Colour)"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



            'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            x = x + 1
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Cells(x, 2) = "Date"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10
            worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(x, 3) = "color"
            'worksheet11.Rows(6).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("C" & x & ":C" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(x, 4) = "white,Yarn &Marl"
            'worksheet11.Rows(6).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range(worksheet11.Cells(x, 4), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Cells(x, 4).WrapText = True
            worksheet11.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 5) = "Cotton"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range("E" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 9)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("j" & x & ":j" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(x, 11) = " Bio-polish"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10
            worksheet11.Range("k" & x & ":k" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("k" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Cells(x, 17) = "Viscose"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            x = x + 1
            worksheet11.Cells(x, 3) = "hrs/ batch"
            worksheet11.Rows(x).Font.Bold = True
            worksheet11.Rows(x).Font.size = 10

            worksheet11.Range("C" & x & ":C" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet11.Range("c" & x & ":c" & x).Interior.Color = RGB(255, 102, 0)


            worksheet11.Cells(x, 4) = "hrs/ batch"
            worksheet11.Range("D" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 5) = "Light"
            worksheet11.Range("E" & x & ":E" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 6) = "Medium"
            worksheet11.Range("F" & x & ":F" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 7) = "Dark"
            worksheet11.Range("G" & x & ":G" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 7), worksheet11.Cells(x, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 8) = "Extra Dark"
            worksheet11.Range("H" & x & ":H" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 8), worksheet11.Cells(x, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 9) = "Total"
            worksheet11.Range("I" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 11) = "Light"
            worksheet11.Range("K" & x & ":K" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 12) = "Medium"
            worksheet11.Range("L" & x & ":L" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 12), worksheet11.Cells(x, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 13) = "Dark"
            worksheet11.Range("M" & x & ":M" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 13), worksheet11.Cells(x, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 14) = "Extra Dark"
            worksheet11.Range("N" & x & ":N" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 14), worksheet11.Cells(x, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 15) = "Total"
            worksheet11.Range("O" & x & ":O" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 15), worksheet11.Cells(x, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 16) = "%"
            worksheet11.Range("p" & x & ":p" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 16), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, 16)
            range1.Font.Color = RGB(0, 0, 255)

            worksheet11.Cells(x, 17) = "Light"
            worksheet11.Range("q" & x & ":q" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 18) = "Medium"
            worksheet11.Range("R" & x & ":R" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 18), worksheet11.Cells(x, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(x, 19) = "Dark"
            worksheet11.Range("S" & x & ":S" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 19), worksheet11.Cells(x, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 20) = "Extra Dark"
            worksheet11.Range("T" & x & ":T" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 20), worksheet11.Cells(x, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


            worksheet11.Cells(x, 21) = "Total"
            worksheet11.Range("U" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
            'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
            worksheet11.Range(worksheet11.Cells(x, 21), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
            '     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

            SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
            T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            i = 0

            ' Dim Y As Integer
            Y = 2
            x = x + 1
            For Each DTRow3 As DataRow In T01.Tables(0).Rows
                Y = 2
                worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
                ' worksheet1.Rows(8).Font.Bold = True
                '  worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
                worksheet11.Rows(x).Font.size = 10
                Y = Y + 1

                Dim StartdateofYear As Date
                Dim Dateofweek As Integer
                Dim WeekStartdate As Date
                Dim WeekEnddate As Date

                StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

                Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
                WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
                Dim thisCulture = Globalization.CultureInfo.CurrentCulture
                Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
                Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

                If dayName = "Sunday" Then
                    WeekStartdate = CDate(WeekStartdate).AddDays(+1)
                ElseIf dayName = "Tuesday" Then
                    WeekStartdate = CDate(WeekStartdate).AddDays(-1)
                ElseIf dayName = "Wednesday" Then
                    WeekStartdate = CDate(WeekStartdate).AddDays(-2)
                ElseIf dayName = "Thuesday" Then
                    WeekStartdate = CDate(WeekStartdate).AddDays(-3)
                ElseIf dayName = "Friday" Then
                    WeekStartdate = CDate(WeekStartdate).AddDays(-4)
                ElseIf dayName = "Saturday" Then
                    WeekStartdate = CDate(WeekStartdate).AddDays(-5)
                End If
                WeekEnddate = CDate(WeekStartdate).AddDays(+7)
                If WeekEnddate > txtTodate.Value Then
                    WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
                End If
                ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
                ' WeekStartdate = WeekStartdate & " " & "7:30AM"
                'WeekEnddate = WeekEnddate & " " & "7:30AM"


                'COLOUR
                Dim F1 As Integer
                Dim CL_Count As Integer
                Dim X_date As Date
                Dim X_date1 As Date
                Dim Y_Date As Date

                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"


                    'COLOUR
                    SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                          "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                          " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        '  worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                'WHITE
                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                Dim F As Integer
                F = 0
                SQL = "select M04Lotno,count(M08CL) as M08CL  from M04Lot " & _
                        "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                        " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08CL in ('White','MARL & Yarn dye') group by M04Lotno,M08CL  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    CL_Count = CL_Count + T03.Tables(0).Rows(F)("M08CL")
                    F = F + 1
                Next
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1
                '---------------------------------------------------------------------------------
                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                     "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                     " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        '  range1 = worksheet11.Cells(x, 5)
                        ' range1.Font.Color = RGB(0, 0, 255)

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        '  range1 = worksheet11.Cells(x, 5)
                        ' range1.Font.Color = RGB(0, 0, 255)

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1


                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
          "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
          " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        '  range1 = worksheet11.Cells(x, 5)
                        ' range1.Font.Color = RGB(0, 0, 255)

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                       "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
                       " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        '  range1 = worksheet11.Cells(x, 5)
                        ' range1.Font.Color = RGB(0, 0, 255)

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                worksheet11.Cells(x, Y) = "=SUM(e" & x & ":h" & x & ")"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 2

                '-----------------------------------------------------------------------
                Dim N_COUNT1 As Integer

                N_COUNT1 = 0

                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        '  range1 = worksheet11.Cells(x, 5)
                        ' range1.Font.Color = RGB(0, 0, 255)
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1


                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1


                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next

                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                Y_Date = WeekStartdate
                CL_Count = 0
                For F1 = 1 To 7
                    X_date = Y_Date
                    X_date1 = CDate(Y_Date).AddDays(+1)
                    X_date = X_date & " " & "7:30AM"
                    X_date1 = X_date1 & " " & "7:30AM"
                    SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        CL_Count = CL_Count + T03.Tables(0).Rows.Count
                        N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
                worksheet11.Cells(x, Y) = CL_Count
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                worksheet11.Cells(x, Y) = "=SUM(K" & x & ":N" & x & ")"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
                Y = Y + 1

                Dim n_count As Integer


                ' N_COUNT1 = 0
                n_count = 0
            n_count = (worksheet11.Range("C" & x).Value.ToString)
            If N_COUNT1 > 0 Then
                worksheet11.Cells(x, Y) = N_COUNT1 / n_count
            Else
                worksheet11.Cells(x, Y) = "0"
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1



            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"

                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

    End Function

    Function Avarage_SDTimeMonthly_WJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Average STD time(WJ) - Monthly"

        worksheet11.Columns("A").ColumnWidth = 3
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 8
        worksheet11.Columns("F").ColumnWidth = 8
        worksheet11.Columns("G").ColumnWidth = 8
        worksheet11.Columns("H").ColumnWidth = 8
        worksheet11.Columns("I").ColumnWidth = 8
        worksheet11.Columns("J").ColumnWidth = 1
        worksheet11.Columns("k").ColumnWidth = 8
        worksheet11.Columns("l").ColumnWidth = 8
        worksheet11.Columns("M").ColumnWidth = 8
        worksheet11.Columns("N").ColumnWidth = 8
        worksheet11.Columns("O").ColumnWidth = 8
        worksheet11.Columns("P").ColumnWidth = 8
        worksheet11.Columns("Q").ColumnWidth = 8
        worksheet11.Columns("R").ColumnWidth = 8

        worksheet11.Columns("S").ColumnWidth = 8
        worksheet11.Columns("T").ColumnWidth = 8



        worksheet11.Range("B3:B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q3:Q3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R3:R3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S3:S3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(3, 2) = "Water Jet machine (ECO 02 - ITM 23) Average Standard Time(Monthly) "
        worksheet11.Rows(3).Font.Bold = True
        worksheet11.Rows(3).Font.size = 14


        worksheet11.Range("B3:T3").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells(4, 2), worksheet11.Cells(4, 20)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B4, T4").Interior.Color = RGB(255, 255, 255)

        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J4:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K4:K4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L4:L4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M4:M4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N4:N4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O4:O4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P4:P4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q4:Q4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R4:R4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S4:S4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T4:T4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 3) = "Total average STD time"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Rows(5).rowheight = 20.25
        worksheet11.Range("C5:D5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C5, D5").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(5, 5) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("D5:O5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 16) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("P5:T5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K5:K5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L5:L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M5:M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N5:N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P5:P5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q5:Q5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R5:R5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S5:S5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 2) = "Date"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Range(worksheet11.Cells(6, 2), worksheet11.Cells(6, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 3), worksheet11.Cells(6, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C6, C6").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 4), worksheet11.Cells(6, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 4).WrapText = True
        worksheet11.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(6, 5) = "Cotton"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("e6:i6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 5), worksheet11.Cells(6, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 9), worksheet11.Cells(6, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("i6:i6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 10) = " Bio-polish"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("j6:o6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("p6:p6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 16) = "Viscose"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("p6:t6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("t6:t6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J6:J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K6:K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L6:L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M6:M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N6:N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O6:O6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P6:P6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q6:Q6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R6:R6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S6:S6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T6:T6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 3) = "hrs/ batch"
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 10

        worksheet11.Range("c7:c7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C7, c7").Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(7, 4) = "hrs/ batch"
        worksheet11.Range("d7:d7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 5) = "Light"
        worksheet11.Range("e7:e7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 5), worksheet11.Cells(7, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 6) = "Medium"
        worksheet11.Range("f7:f7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 7) = "Dark"
        worksheet11.Range("g7:g7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 7), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 8) = "Extra Dark"
        worksheet11.Range("h7:h7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 9) = "Avg"
        worksheet11.Range("i7:i7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 9), worksheet11.Cells(7, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 11) = "Light"
        worksheet11.Range("k7:k7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 11), worksheet11.Cells(7, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 12) = "Medium"
        worksheet11.Range("l7:l7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 12), worksheet11.Cells(7, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 13) = "Dark"
        worksheet11.Range("m7:m7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 13), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 14) = "Extra Dark"
        worksheet11.Range("n7:n7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 15) = "Avg"
        worksheet11.Range("o7:o7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 15), worksheet11.Cells(7, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter



        worksheet11.Cells(7, 16) = "Light"
        worksheet11.Range("p7:p7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 16), worksheet11.Cells(7, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 17) = "Medium"
        worksheet11.Range("q7:q7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 17), worksheet11.Cells(7, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 18) = "Dark"
        worksheet11.Range("r7:r7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 18), worksheet11.Cells(7, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 19) = "Extra Dark"
        worksheet11.Range("s7:s7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 19), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 20) = "Avg"
        worksheet11.Range("t7:t7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 20), worksheet11.Cells(7, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Range("B7:B7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C7:C7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D7:D7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E7:E7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F7:F7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G7:G7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H7:H7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I7:I7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J7:J7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K7:K7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L7:L7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M7:M7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N7:N7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O7:O7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P7:P7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q7:Q7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R7:R7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S7:S7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("c7:c7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d7:d7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("e7:e7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("f7:f7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("g7:g7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("h7:h7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("i7:i7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j7:j7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k7:k7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("l7:l7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("m7:m7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("n7:n7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("o7:o7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("p7:p7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("q7:r7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("s7:s7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        worksheet11.Range("B5:B7").Interior.Color = RGB(255, 255, 255)

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '      "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT month(m04Etime) as [Ddate],year(m04Etime) as [Eyear] FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY month(m04Etime),year(m04Etime) order by year(m04Etime),month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 8
        Dim L_DateofMonth As Integer
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("ddate") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            ' x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            'x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

          
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer

            Dim Y_Date As Date
            Dim _STD As Double
            Dim _Count As Integer

            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"



                'COLOUR


                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1

            '========================================= WHITE & MAL

            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            Dim F As Integer
            F = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL IN ('MARL & Yarn dye','White') group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                F = 0
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(F)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(F)("CCount")

                    F = F + 1
                Next
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=============================================================================BIO POLISH
            _STD = 0
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 2
            '-----------------------------------------------------------------------------
            'BIO POLISH
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '----------------------------------------------------------------
            'VISCOSE
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            ' Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            x = x + 1
            i = i + 1
        Next

        x = x + 5



        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 2) = "Water Jet   No. of batches   details(Monthly)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 14


        worksheet11.Range("B" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells((x + 1), 2), worksheet11.Cells((x + 1), 21)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x, "T" & x).Interior.Color = RGB(255, 255, 255)

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & (x - 1) & ":u" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'x = x + 1
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "No. of  batches"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Rows(x).rowheight = 20.25
        worksheet11.Range("C" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":D" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(x, 5) = "No. of batches (Colour)- Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("D" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "No. of batches (Colour)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 2) = "Date"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 4), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 4).WrapText = True
        worksheet11.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("E" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j" & x & ":j" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 11) = " Bio-polish"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range("k" & x & ":k" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "Viscose"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        x = x + 1
        worksheet11.Cells(x, 3) = "hrs/ batch"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("C" & x & ":C" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("c" & x & ":c" & x).Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(x, 4) = "hrs/ batch"
        worksheet11.Range("D" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Light"
        worksheet11.Range("E" & x & ":E" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 6) = "Medium"
        worksheet11.Range("F" & x & ":F" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 7) = "Dark"
        worksheet11.Range("G" & x & ":G" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 7), worksheet11.Cells(x, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 8) = "Extra Dark"
        worksheet11.Range("H" & x & ":H" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 8), worksheet11.Cells(x, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 9) = "Total"
        worksheet11.Range("I" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 11) = "Light"
        worksheet11.Range("K" & x & ":K" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 12) = "Medium"
        worksheet11.Range("L" & x & ":L" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 12), worksheet11.Cells(x, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 13) = "Dark"
        worksheet11.Range("M" & x & ":M" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 13), worksheet11.Cells(x, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 14) = "Extra Dark"
        worksheet11.Range("N" & x & ":N" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 14), worksheet11.Cells(x, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 15) = "Total"
        worksheet11.Range("O" & x & ":O" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 15), worksheet11.Cells(x, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 16) = "%"
        worksheet11.Range("p" & x & ":p" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 16), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(x, 16)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet11.Cells(x, 17) = "Light"
        worksheet11.Range("q" & x & ":q" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 18) = "Medium"
        worksheet11.Range("R" & x & ":R" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 18), worksheet11.Cells(x, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 19) = "Dark"
        worksheet11.Range("S" & x & ":S" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 19), worksheet11.Cells(x, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 20) = "Extra Dark"
        worksheet11.Range("T" & x & ":T" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 20), worksheet11.Cells(x, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 21) = "Total"
        worksheet11.Range("U" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 21), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT month(m04Etime) as [Ddate],year(m04Etime) as [Eyear] FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY month(m04Etime),year(m04Etime) order by year(m04Etime),month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0

        ' Dim Y As Integer
        Y = 2
        x = x + 1
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            ' worksheet1.Rows(8).Font.Bold = True
            '  worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
           
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("ddate") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

           


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer
            Dim X_date As Date
            Dim X_date1 As Date
            Dim Y_Date As Date

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"


                'COLOUR
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    '  worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            'WHITE
            Y_Date = aDate
            CL_Count = 0
            Dim F As Integer
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                F = 0
                SQL = "select M04Lotno,count(M08CL) as M08CL  from M04Lot " & _
                    "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                    " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08CL in ('White','MARL & Yarn dye') group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    CL_Count = CL_Count + T03.Tables(0).Rows(F)("M08CL")

                    F = F + 1
                Next
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            '---------------------------------------------------------------------------------
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(e" & x & ":h" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 2

            '-----------------------------------------------------------------------
            Dim N_COUNT1 As Integer

            N_COUNT1 = 0

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(K" & x & ":N" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Dim n_count As Integer


            ' N_COUNT1 = 0
            n_count = 0
            n_count = (worksheet11.Range("C" & x).Value.ToString)
            If N_COUNT1 > 0 Then
                worksheet11.Cells(x, Y) = N_COUNT1 / n_count
            Else
                worksheet11.Cells(x, Y) = "0"
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1



            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"

                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='01' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

    End Function

    Function Avarage_SDTimeWeekly_AF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Average STD time(AF) - Weekly"

        worksheet11.Columns("A").ColumnWidth = 3
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 8
        worksheet11.Columns("F").ColumnWidth = 8
        worksheet11.Columns("G").ColumnWidth = 8
        worksheet11.Columns("H").ColumnWidth = 8
        worksheet11.Columns("I").ColumnWidth = 8
        worksheet11.Columns("J").ColumnWidth = 1
        worksheet11.Columns("k").ColumnWidth = 8
        worksheet11.Columns("l").ColumnWidth = 8
        worksheet11.Columns("M").ColumnWidth = 8
        worksheet11.Columns("N").ColumnWidth = 8
        worksheet11.Columns("O").ColumnWidth = 8
        worksheet11.Columns("P").ColumnWidth = 8
        worksheet11.Columns("Q").ColumnWidth = 8
        worksheet11.Columns("R").ColumnWidth = 8

        worksheet11.Columns("S").ColumnWidth = 8
        worksheet11.Columns("T").ColumnWidth = 8



        worksheet11.Range("B3:B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q3:Q3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R3:R3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S3:S3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(3, 2) = "Air Flow machine (LR 01 - LR 09) Average Standard Time(Weekly) "
        worksheet11.Rows(3).Font.Bold = True
        worksheet11.Rows(3).Font.size = 14


        worksheet11.Range("B3:T3").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells(4, 2), worksheet11.Cells(4, 20)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B4, T4").Interior.Color = RGB(255, 255, 255)

        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J4:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K4:K4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L4:L4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M4:M4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N4:N4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O4:O4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P4:P4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q4:Q4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R4:R4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S4:S4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T4:T4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 3) = "Total average STD time"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Rows(5).rowheight = 20.25
        worksheet11.Range("C5:D5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C5, D5").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(5, 5) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("D5:O5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 16) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("P5:T5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K5:K5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L5:L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M5:M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N5:N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P5:P5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q5:Q5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R5:R5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S5:S5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 2) = "Date"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Range(worksheet11.Cells(6, 2), worksheet11.Cells(6, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 3), worksheet11.Cells(6, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C6, C6").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 4), worksheet11.Cells(6, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 4).WrapText = True
        worksheet11.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(6, 5) = "Cotton"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("e6:i6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 5), worksheet11.Cells(6, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 9), worksheet11.Cells(6, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("i6:i6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 10) = " Bio-polish"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("j6:o6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("p6:p6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 16) = "Viscose"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("p6:t6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("t6:t6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J6:J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K6:K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L6:L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M6:M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N6:N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O6:O6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P6:P6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q6:Q6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R6:R6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S6:S6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T6:T6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 3) = "hrs/ batch"
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 10

        worksheet11.Range("c7:c7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C7, c7").Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(7, 4) = "hrs/ batch"
        worksheet11.Range("d7:d7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 5) = "Light"
        worksheet11.Range("e7:e7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 5), worksheet11.Cells(7, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 6) = "Medium"
        worksheet11.Range("f7:f7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 7) = "Dark"
        worksheet11.Range("g7:g7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 7), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 8) = "Extra Dark"
        worksheet11.Range("h7:h7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 9) = "Avg"
        worksheet11.Range("i7:i7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 9), worksheet11.Cells(7, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 11) = "Light"
        worksheet11.Range("k7:k7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 11), worksheet11.Cells(7, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 12) = "Medium"
        worksheet11.Range("l7:l7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 12), worksheet11.Cells(7, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 13) = "Dark"
        worksheet11.Range("m7:m7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 13), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 14) = "Extra Dark"
        worksheet11.Range("n7:n7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 15) = "Avg"
        worksheet11.Range("o7:o7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 15), worksheet11.Cells(7, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter



        worksheet11.Cells(7, 16) = "Light"
        worksheet11.Range("p7:p7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 16), worksheet11.Cells(7, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 17) = "Medium"
        worksheet11.Range("q7:q7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 17), worksheet11.Cells(7, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 18) = "Dark"
        worksheet11.Range("r7:r7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 18), worksheet11.Cells(7, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 19) = "Extra Dark"
        worksheet11.Range("s7:s7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 19), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 20) = "Avg"
        worksheet11.Range("t7:t7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 20), worksheet11.Cells(7, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Range("B7:B7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C7:C7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D7:D7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E7:E7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F7:F7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G7:G7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H7:H7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I7:I7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J7:J7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K7:K7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L7:L7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M7:M7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N7:N7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O7:O7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P7:P7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q7:Q7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R7:R7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S7:S7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("c7:c7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d7:d7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("e7:e7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("f7:f7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("g7:g7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("h7:h7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("i7:i7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j7:j7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k7:k7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("l7:l7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("m7:m7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("n7:n7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("o7:o7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("p7:p7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("q7:r7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("s7:s7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        worksheet11.Range("B5:B7").Interior.Color = RGB(255, 255, 255)

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '      "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
            "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 8
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            ' x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            'x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer

            Dim Y_Date As Date
            Dim _STD As Double
            Dim _Count As Integer

            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"



                'COLOUR


                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1

            '========================================= WHITE & MAL

            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL IN ('MARL & Yarn dye','White') group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=============================================================================BIO POLISH
            _STD = 0
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then

                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 2
            '-----------------------------------------------------------------------------
            'BIO POLISH
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then

                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '  _STD = _STD / 60
                    ' _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '----------------------------------------------------------------
            'VISCOSE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '-------------------------------------------------------------------------------MEDIUM
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '===================================================================DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '==========================================================================EXTRA DARK
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1
            '=====================================================================AVARAGE
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
            '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            ' Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            x = x + 1
            i = i + 1
        Next

        x = x + 5



        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 2) = "Air Flow No. of batches   details(Weekly)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 14


        worksheet11.Range("B" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells((x + 1), 2), worksheet11.Cells((x + 1), 21)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x, "T" & x).Interior.Color = RGB(255, 255, 255)

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & (x - 1) & ":u" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'x = x + 1
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "No. of  batches"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Rows(x).rowheight = 20.25
        worksheet11.Range("C" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":D" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(x, 5) = "No. of batches (Colour)- Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("D" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "No. of batches (Colour)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 2) = "Date"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 4), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 4).WrapText = True
        worksheet11.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("E" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j" & x & ":j" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 11) = " Bio-polish"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range("k" & x & ":k" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "Viscose"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        x = x + 1
        worksheet11.Cells(x, 3) = "hrs/ batch"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("C" & x & ":C" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("c" & x & ":c" & x).Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(x, 4) = "hrs/ batch"
        worksheet11.Range("D" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Light"
        worksheet11.Range("E" & x & ":E" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 6) = "Medium"
        worksheet11.Range("F" & x & ":F" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 7) = "Dark"
        worksheet11.Range("G" & x & ":G" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 7), worksheet11.Cells(x, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 8) = "Extra Dark"
        worksheet11.Range("H" & x & ":H" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 8), worksheet11.Cells(x, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 9) = "Total"
        worksheet11.Range("I" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 11) = "Light"
        worksheet11.Range("K" & x & ":K" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 12) = "Medium"
        worksheet11.Range("L" & x & ":L" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 12), worksheet11.Cells(x, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 13) = "Dark"
        worksheet11.Range("M" & x & ":M" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 13), worksheet11.Cells(x, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 14) = "Extra Dark"
        worksheet11.Range("N" & x & ":N" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 14), worksheet11.Cells(x, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 15) = "Total"
        worksheet11.Range("O" & x & ":O" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 15), worksheet11.Cells(x, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 16) = "%"
        worksheet11.Range("p" & x & ":p" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 16), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(x, 16)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet11.Cells(x, 17) = "Light"
        worksheet11.Range("q" & x & ":q" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 18) = "Medium"
        worksheet11.Range("R" & x & ":R" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 18), worksheet11.Cells(x, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 19) = "Dark"
        worksheet11.Range("S" & x & ":S" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 19), worksheet11.Cells(x, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 20) = "Extra Dark"
        worksheet11.Range("T" & x & ":T" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 20), worksheet11.Cells(x, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 21) = "Total"
        worksheet11.Range("U" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 21), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
            "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0

        ' Dim Y As Integer
        Y = 2
        x = x + 1
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            '  worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Y = Y + 1

            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer
            Dim X_date As Date
            Dim X_date1 As Date
            Dim Y_Date As Date

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"


                'COLOUR
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    '  worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            'WHITE
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                    "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                    " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08CL in ('White','MARL & Yarn dye') group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            '---------------------------------------------------------------------------------
            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(e" & x & ":h" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 2

            '-----------------------------------------------------------------------
            Dim N_COUNT1 As Integer

            N_COUNT1 = 0

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(K" & x & ":N" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Dim n_count As Integer


            ' N_COUNT1 = 0
            n_count = 0
            n_count = (worksheet11.Range("C" & x).Value.ToString)
            If N_COUNT1 > 0 Then
                worksheet11.Cells(x, Y) = N_COUNT1 / n_count
            Else
                worksheet11.Cells(x, Y) = "0"
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1



            Y_Date = WeekStartdate
            CL_Count = 0
            For F1 = 1 To 7
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"

                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

    End Function

    Function Avarage_SDTimeMonthly_AF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Average STD time(AF) - Monthly"

        worksheet11.Columns("A").ColumnWidth = 3
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 8
        worksheet11.Columns("F").ColumnWidth = 8
        worksheet11.Columns("G").ColumnWidth = 8
        worksheet11.Columns("H").ColumnWidth = 8
        worksheet11.Columns("I").ColumnWidth = 8
        worksheet11.Columns("J").ColumnWidth = 1
        worksheet11.Columns("k").ColumnWidth = 8
        worksheet11.Columns("l").ColumnWidth = 8
        worksheet11.Columns("M").ColumnWidth = 8
        worksheet11.Columns("N").ColumnWidth = 8
        worksheet11.Columns("O").ColumnWidth = 8
        worksheet11.Columns("P").ColumnWidth = 8
        worksheet11.Columns("Q").ColumnWidth = 8
        worksheet11.Columns("R").ColumnWidth = 8

        worksheet11.Columns("S").ColumnWidth = 8
        worksheet11.Columns("T").ColumnWidth = 8



        worksheet11.Range("B3:B4").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J3:J3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K3:K3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L3:L3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M3:M3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N3:N3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O3:O3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P3:P3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q3:Q3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R3:R3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S3:S3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T3:T4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(3, 2) = "Air Flow machine (LR 01 - LR 09) Average Standard Time(Monthly) "
        worksheet11.Rows(3).Font.Bold = True
        worksheet11.Rows(3).Font.size = 14


        worksheet11.Range("B3:T3").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells(4, 2), worksheet11.Cells(4, 20)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B4, T4").Interior.Color = RGB(255, 255, 255)

        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J4:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K4:K4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L4:L4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M4:M4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N4:N4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O4:O4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P4:P4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q4:Q4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R4:R4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S4:S4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T4:T4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 3) = "Total average STD time"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Rows(5).rowheight = 20.25
        worksheet11.Range("C5:D5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 3), worksheet11.Cells(5, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C5, D5").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(5, 5) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("D5:O5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 5), worksheet11.Cells(5, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(5, 16) = "AVG  STD Time -hrs / batch (Cotton)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10

        worksheet11.Range("P5:T5").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(5, 16), worksheet11.Cells(5, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K5:K5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L5:L5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M5:M5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N5:N5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O5:O5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P5:P5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q5:Q5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R5:R5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S5:S5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T5:T5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("J5:J4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 2) = "Date"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10
        worksheet11.Range(worksheet11.Cells(6, 2), worksheet11.Cells(6, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 3), worksheet11.Cells(6, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C6, C6").Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range(worksheet11.Cells(6, 4), worksheet11.Cells(6, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d6:d6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(6, 4).WrapText = True
        worksheet11.Cells(6, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(6, 5) = "Cotton"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("e6:i6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 5), worksheet11.Cells(6, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 9), worksheet11.Cells(6, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("i6:i6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 10) = " Bio-polish"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("j6:o6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 10), worksheet11.Cells(6, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("p6:p6").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(6, 16) = "Viscose"
        worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(6).Font.size = 10

        worksheet11.Range("p6:t6").VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("t6:t6").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J6:J6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K6:K6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L6:L6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M6:M6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N6:N6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O6:O6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P6:P6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q6:Q6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R6:R6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S6:S6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T6:T6").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b7:b7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(7, 3) = "hrs/ batch"
        worksheet11.Rows(7).Font.Bold = True
        worksheet11.Rows(7).Font.size = 10

        worksheet11.Range("c7:c7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 3), worksheet11.Cells(7, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C7, c7").Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(7, 4) = "hrs/ batch"
        worksheet11.Range("d7:d7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 5) = "Light"
        worksheet11.Range("e7:e7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 5), worksheet11.Cells(7, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 6) = "Medium"
        worksheet11.Range("f7:f7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 7) = "Dark"
        worksheet11.Range("g7:g7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 7), worksheet11.Cells(7, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 8) = "Extra Dark"
        worksheet11.Range("h7:h7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 8), worksheet11.Cells(7, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 9) = "Avg"
        worksheet11.Range("i7:i7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 9), worksheet11.Cells(7, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 11) = "Light"
        worksheet11.Range("k7:k7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 11), worksheet11.Cells(7, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 12) = "Medium"
        worksheet11.Range("l7:l7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 12), worksheet11.Cells(7, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 13) = "Dark"
        worksheet11.Range("m7:m7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 13), worksheet11.Cells(7, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 14) = "Extra Dark"
        worksheet11.Range("n7:n7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 14), worksheet11.Cells(7, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 15) = "Avg"
        worksheet11.Range("o7:o7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 15), worksheet11.Cells(7, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter



        worksheet11.Cells(7, 16) = "Light"
        worksheet11.Range("p7:p7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 16), worksheet11.Cells(7, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 17) = "Medium"
        worksheet11.Range("q7:q7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 17), worksheet11.Cells(7, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(7, 18) = "Dark"
        worksheet11.Range("r7:r7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 18), worksheet11.Cells(7, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 19) = "Extra Dark"
        worksheet11.Range("s7:s7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 19), worksheet11.Cells(7, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(7, 20) = "Avg"
        worksheet11.Range("t7:t7").VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 20), worksheet11.Cells(7, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Range("B7:B7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C7:C7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D7:D7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E7:E7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F7:F7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G7:G7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H7:H7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I7:I7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J7:J7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K7:K7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L7:L7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M7:M7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N7:N7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O7:O7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P7:P7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q7:Q7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R7:R7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S7:S7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("c7:c7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("d7:d7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("e7:e7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("f7:f7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("g7:g7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("h7:h7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("i7:i7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j7:j7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k7:k7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("l7:l7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("m7:m7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("n7:n7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("o7:o7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("p7:p7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("q7:r7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("s7:s7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("T7:T7").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        worksheet11.Range("B5:B7").Interior.Color = RGB(255, 255, 255)

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '      "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT month(m04Etime) as [Ddate],year(m04Etime) as [Eyear] FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY month(m04Etime),year(m04Etime) order by year(m04Etime),month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        ' Dim Y As Integer
        Y = 2
        x = 8
        Dim L_DateofMonth As Integer
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("ddate") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            Y = Y + 1
            Dim x_date As Date
            Dim x_date1 As Date
            Dim z As Integer
            Dim M1 As Integer


            ' x_date1 = CDate(T01.Tables(0).Rows(i)("ddate")).AddDays(+1)
            'x_date = T01.Tables(0).Rows(i)("ddate") & " " & "7:30AM"
            'x_date1 = x_date1 & " " & "7:30AM"
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")


            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer

            Dim Y_Date As Date
            Dim _STD As Double
            Dim _Count As Integer

            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"



                'COLOUR


                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                worksheet11.Cells(x, Y) = _STD
            End If
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            Y = Y + 1

            '========================================= WHITE & MAL

            _STD = 0
            _Count = 0
            Y_Date = aDate
            CL_Count = 0
            Dim F As Integer
            For F1 = 1 To L_DateofMonth
                x_date = Y_Date
                x_date1 = CDate(Y_Date).AddDays(+1)
                x_date = x_date & " " & "7:30AM"
                x_date1 = x_date1 & " " & "7:30AM"
                F = 0
                SQL = "select sum(M04STD) as STD,count(M08CL) as CCount  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & x_date & "' and '" & x_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL IN ('MARL & Yarn dye','White') group by M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    'worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    'range1 = worksheet11.Cells(x, Y)
                    'range1.Font.Color = RGB(255, 0, 0)
                    _STD = _STD + T03.Tables(0).Rows(F)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")l
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    F = F + 1
                Next
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '=============================================================================BIO POLISH
                _STD = 0
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")

                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")

                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '-------------------------------------------------------------------------------MEDIUM
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count

                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '===================================================================DARK
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '==========================================================================EXTRA DARK
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '=====================================================================AVARAGE
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 2
                '-----------------------------------------------------------------------------
                'BIO POLISH
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '-------------------------------------------------------------------------------MEDIUM
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '===================================================================DARK
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '==========================================================================EXTRA DARK
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '=====================================================================AVARAGE
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '----------------------------------------------------------------
                'VISCOSE
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Light' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '-------------------------------------------------------------------------------MEDIUM
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Medium' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '===================================================================DARK
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Dark' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '==========================================================================EXTRA DARK
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName='Extra Dark' " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE'  GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                Y = Y + 1
                '=====================================================================AVARAGE
                _STD = 0
                _Count = 0
                Y_Date = aDate
                CL_Count = 0
                For F1 = 1 To L_DateofMonth
                    x_date = Y_Date
                    x_date1 = CDate(Y_Date).AddDays(+1)
                    x_date = x_date & " " & "7:30AM"
                    x_date1 = x_date1 & " " & "7:30AM"
                    SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                         " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                         "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                           " AND M04eTIME BETWEEN '" & x_date & "' AND '" & x_date1 & "' AND M09TYPE='VISCOSE' GROUP BY M08CL"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T03) Then
                        _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    '_STD = _STD / T03.Tables(0).Rows(0)("CCount")
                    CL_Count = CL_Count + T03.Tables(0).Rows(0)("CCount")
                    End If
                    Y_Date = CDate(Y_Date).AddDays(+1)
                Next
            If _STD > 0 Then
                _STD = _STD / 60
                _STD = _STD / CL_Count
                worksheet11.Cells(x, Y) = _STD
            End If
                '  worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                ' Y = Y + 1

                worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


                x = x + 1
                i = i + 1
            Next

        x = x + 5



        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 2) = "Air flow   No. of batches   details(Monthly)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 14


        worksheet11.Range("B" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range(worksheet11.Cells((x + 1), 2), worksheet11.Cells((x + 1), 21)).Merge()
        '  worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(2, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x, "T" & x).Interior.Color = RGB(255, 255, 255)

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & (x - 1) & ":B" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & (x - 1) & ":u" & (x - 1)).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'x = x + 1
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        'worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "No. of  batches"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Rows(x).rowheight = 20.25
        worksheet11.Range("C" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":D" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Cells(x, 5) = "No. of batches (Colour)- Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("D" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "No. of batches (Colour)"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous



        'worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        x = x + 1
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 2) = "Date"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range(worksheet11.Cells(x, 2), worksheet11.Cells(x, 2)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 3) = "color"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Interior.Color = RGB(255, 102, 0)
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 4) = "white,Yarn &Marl"
        'worksheet11.Rows(6).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range(worksheet11.Cells(x, 4), worksheet11.Cells(x, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(x, 4).WrapText = True
        worksheet11.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Cotton"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("E" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 9)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("j" & x & ":j" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 11) = " Bio-polish"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10
        worksheet11.Range("k" & x & ":k" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("k" & x & ":P" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Cells(x, 17) = "Viscose"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("Q" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


        x = x + 1
        worksheet11.Cells(x, 3) = "hrs/ batch"
        worksheet11.Rows(x).Font.Bold = True
        worksheet11.Rows(x).Font.size = 10

        worksheet11.Range("C" & x & ":C" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 3), worksheet11.Cells(x, 3)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        worksheet11.Range("c" & x & ":c" & x).Interior.Color = RGB(255, 102, 0)


        worksheet11.Cells(x, 4) = "hrs/ batch"
        worksheet11.Range("D" & x & ":D" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 4), worksheet11.Cells(7, 4)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 5) = "Light"
        worksheet11.Range("E" & x & ":E" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 5), worksheet11.Cells(x, 5)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 6) = "Medium"
        worksheet11.Range("F" & x & ":F" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(7, 6), worksheet11.Cells(7, 6)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 7) = "Dark"
        worksheet11.Range("G" & x & ":G" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 7), worksheet11.Cells(x, 7)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 8) = "Extra Dark"
        worksheet11.Range("H" & x & ":H" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 8), worksheet11.Cells(x, 8)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 9) = "Total"
        worksheet11.Range("I" & x & ":I" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 9), worksheet11.Cells(x, 9)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 11) = "Light"
        worksheet11.Range("K" & x & ":K" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 11), worksheet11.Cells(x, 11)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 12) = "Medium"
        worksheet11.Range("L" & x & ":L" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 12), worksheet11.Cells(x, 12)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 13) = "Dark"
        worksheet11.Range("M" & x & ":M" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 13), worksheet11.Cells(x, 13)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 14) = "Extra Dark"
        worksheet11.Range("N" & x & ":N" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 14), worksheet11.Cells(x, 14)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 15) = "Total"
        worksheet11.Range("O" & x & ":O" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 15), worksheet11.Cells(x, 15)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 16) = "%"
        worksheet11.Range("p" & x & ":p" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 16), worksheet11.Cells(x, 16)).HorizontalAlignment = XlHAlign.xlHAlignCenter
        range1 = worksheet11.Cells(x, 16)
        range1.Font.Color = RGB(0, 0, 255)

        worksheet11.Cells(x, 17) = "Light"
        worksheet11.Range("q" & x & ":q" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 17), worksheet11.Cells(x, 17)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 18) = "Medium"
        worksheet11.Range("R" & x & ":R" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 18), worksheet11.Cells(x, 18)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(x, 19) = "Dark"
        worksheet11.Range("S" & x & ":S" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 19), worksheet11.Cells(x, 19)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 20) = "Extra Dark"
        worksheet11.Range("T" & x & ":T" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 20), worksheet11.Cells(x, 20)).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(x, 21) = "Total"
        worksheet11.Range("U" & x & ":U" & x).VerticalAlignment = XlVAlign.xlVAlignCenter
        'worksheet11.Range(worksheet11.Cells(6, 16), worksheet11.Cells(6, 20)).Merge()
        worksheet11.Range(worksheet11.Cells(x, 21), worksheet11.Cells(x, 21)).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("b" & x & ":b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("U" & x & ":U" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        'SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '     "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"

        SQL = "SELECT month(m04Etime) as [Ddate],year(m04Etime) as [Eyear] FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY month(m04Etime),year(m04Etime) order by year(m04Etime),month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0

        ' Dim Y As Integer
        Y = 2
        x = x + 1
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 2
            worksheet11.Cells(x, Y) = MonthName(T01.Tables(0).Rows(i)("ddate"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            ' worksheet1.Rows(8).Font.Bold = True
            '  worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("ddate") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date




            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer
            Dim X_date As Date
            Dim X_date1 As Date
            Dim Y_Date As Date

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"


                'COLOUR
                SQL = "select M04Lotno,count(M08CL)  from M04Lot " & _
                      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04Batchwt>0 and M04ProgrameType='N' and M08CL='Colour' group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    '  worksheet11.Cells(x, Y) = T03.Tables(0).Rows.Count
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Range("c" & x & ":" & "c" & x).Interior.Color = RGB(255, 102, 0)
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            'WHITE
            Y_Date = aDate
            Dim F As Integer
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08CL) as M08CL from M04Lot " & _
                    "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code" & _
                    " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08CL in ('White','MARL & Yarn dye') group by M04Lotno,M08CL  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                F = 0
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    CL_Count = CL_Count + T03.Tables(0).Rows(F)("M08CL")
                    F = F + 1
                Next
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            '---------------------------------------------------------------------------------
            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                 "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
                 " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
      "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
      " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
                   "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality)" & _
                   " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(e" & x & ":h" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 2

            '-----------------------------------------------------------------------
            Dim N_COUNT1 As Integer

            N_COUNT1 = 0

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    '  range1 = worksheet11.Cells(x, 5)
                    ' range1.Font.Color = RGB(0, 0, 255)
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count
                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
            "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
            " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Cells(x, Y) = "=SUM(K" & x & ":N" & x & ")"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Dim n_count As Integer


            ' N_COUNT1 = 0
            n_count = 0
            n_count = (worksheet11.Range("C" & x).Value.ToString)
            If N_COUNT1 > 0 Then
                worksheet11.Cells(x, Y) = N_COUNT1 / n_count
            Else
                worksheet11.Cells(x, Y) = "0"
            End If
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0%"
            range1.Font.Color = RGB(0, 0, 255)
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Light' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Medium' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next
            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1


            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"
                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Dark' AND M09TYPE='VISCOSE'  group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1



            Y_Date = aDate
            CL_Count = 0
            For F1 = 1 To L_DateofMonth
                X_date = Y_Date
                X_date1 = CDate(Y_Date).AddDays(+1)
                X_date = X_date & " " & "7:30AM"
                X_date1 = X_date1 & " " & "7:30AM"

                SQL = "select M04Lotno,count(M08SubName)  from M04Lot " & _
           "inner join M08Sub_Shade on M08Code=M04Shade_Type INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) " & _
           " INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code where T03TYPE='02' and M04Batchwt>0 and M04ETime between '" & X_date & "' and '" & X_date1 & "' and M04ProgrameType='N' and M08SubName='Extra Dark' AND M09TYPE='VISCOSE' group by M04Lotno,M08SubName  "
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    CL_Count = CL_Count + T03.Tables(0).Rows.Count
                    N_COUNT1 = N_COUNT1 + T03.Tables(0).Rows.Count

                End If
                Y_Date = CDate(Y_Date).AddDays(+1)
            Next

            worksheet11.Cells(x, Y) = CL_Count
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1

            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeLeft).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("J" & x & ":J" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("K" & x & ":K" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("L" & x & ":L" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("M" & x & ":M" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("N" & x & ":N" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("O" & x & ":O" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("P" & x & ":P" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("Q" & x & ":Q" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("R" & x & ":R" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("S" & x & ":S" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("T" & x & ":T" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("u" & x & ":u" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            x = x + 1
            i = i + 1
        Next

    End Function
    Function Avg_LaneWtAF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Weekly Loading per lane(AF) "

        worksheet11.Columns("A").ColumnWidth = 12
        worksheet11.Columns("B").ColumnWidth = 12
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 13
        worksheet11.Columns("F").ColumnWidth = 13
        worksheet11.Columns("G").ColumnWidth = 10
        worksheet11.Columns("H").ColumnWidth = 10
        worksheet11.Columns("I").ColumnWidth = 10
        'worksheet11.Columns("J").ColumnWidth = 13


        worksheet11.Cells(2, 1) = "Weekly Average lane weight of  Air flow machine (Kg)  "
        worksheet11.Rows(2).Font.Bold = True
        worksheet11.Rows(2).Font.size = 14

        worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(2, 9)).Merge()

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(3, 2) = "Air Flow machine  "
        worksheet11.Rows(3).Font.Bold = True

        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 9)).Merge()
        worksheet11.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A5:A5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("A6:A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4, A5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("B4, B5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("C4, C5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("D4, D5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("d4, d5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("f4, f5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("g4, g5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("h4, i4").Interior.Color = RGB(149, 179, 215)
        worksheet11.Range("h5, i5").Interior.Color = RGB(149, 179, 215)


        worksheet11.Cells(4, 2) = "Production  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 3) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 3) = "batches"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 4) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 4) = "Lane"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 5) = "cotton  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 5) = "(Lane weight)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(4, 6) = "viscose   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 6) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 7) = "Avg   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 7) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 8) = "Conv. Factor   "
        worksheet11.Range(worksheet11.Cells(4, 8), worksheet11.Cells(4, 9)).Merge()
        worksheet11.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 8) = "Cotton"
        worksheet11.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 9) = "Visscose"
        worksheet11.Cells(5, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        Dim M1 As Integer
        Dim M2 As Integer

        ' Dim Y As Integer
        Y = 1
        x = 6
        M1 = 4
        M2 = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 1
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Y = Y + 1
            '-------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='White & Marl Weekly'!C" & M1
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M1 = M1 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='Shade Distribution Weekly'!b" & M2
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M2 = M2 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            'NO OF LANE
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer

            Dim Y_Date As Date
            Dim _STD As Double
            Dim _Count As Integer
            Dim X_date As Date
            Dim X_date1 As Date
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"




            SQL = "SELECT SUM(T03LANE)AS LANE FROM M04LOT INNER JOIN T03MACHINE ON M04MACHINE_NO=T03Code WHERE M04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND T03TYPE='02'  AND M04pROGRAMETYPE='N' group by T03TYPE"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                worksheet11.Cells(x, Y) = dsUser.Tables(0).Rows(0)("LANE")
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Else
                worksheet11.Cells(x, Y) = "0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            Y = Y + 1
            '-------------------------------------------------------------------------
            Dim n_Taken As Double
            Dim n_Lane As Integer
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose' group by T03TYPE"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose' group by T03TYPE"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If
            '------------------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = n_Taken / n_Lane
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            '------------------------------------------------------------------------------------------
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose' group by T03TYPE"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose' group by T03TYPE"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If
            '------------------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = n_Taken / n_Lane
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            Y = Y + 1
            worksheet11.Cells(x, Y) = "=(b" & x & "/d" & x & ")"
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Y = Y + 1
            '-------------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                  " inner join m09quality on m09code=M04Quality " & _
                  "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                  "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose' group by T03TYPE"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            worksheet11.Cells(x, Y) = n_Taken / n_Lane
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0.0"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
            worksheet11.Range("h" & x, "h" & x).Interior.Color = RGB(253, 233, 217)
            Y = Y + 1

            '-----------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                " inner join m09quality on m09code=M04Quality " & _
                "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose' group by T03TYPE"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then
                worksheet11.Cells(x, Y) = "0"
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("i" & x, "i" & x).Interior.Color = RGB(155, 187, 89)
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("i" & x, "i" & x).Interior.Color = RGB(155, 187, 89)
            End If
            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '----------------------------------------------------------------------------------------------------------
            x = x + 1
            i = i + 1
        Next
        '-------------------------------------------------------------------------
        'chart
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim _Chartlocation As Integer
        Dim rh As Double

        _Chartlocation = (x * 10) + 80

        rh = (x - 3) * 12.75

        rh = rh + 18.75 + 20
        ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        '  chartPage.SeriesCollection.NewSeries()
        '  chartPage.SeriesCollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        ' chartPage.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))

        '   chartRange = worksheet11.Range("A4", "e" & (x - 1))
        ' chartPage.ChartObjects(1).CHART.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))
        'chartPage.ChartObjects(1).chart.seriescollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        '  chartPage.SeriesCollection(1).Series.AxisX = worksheet11.Range("A8", "A" & (X - 1))
        ' t_Series = chartPage.SeriesCollection.NewSeries
        ' t_Series.Name = "Q1"
        '   sh = "Weekly Down Time Analysis"
        ' t_Series.Values = "='Weekly Down Time Analysis'!$A$8:$E$21" '& chartRange
        ' t_Series.XValues = "='Weekly Down Time Analysis'!$A$9:$A$21"
        ' chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$B$8:$E$21"))
        'chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$A$8:$A$21"))
        'chartPage.SetSourceData(Source:=chartRange)
        'chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns

        'chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)
        'chartPage.HasTitle = True

        'chartPage.ChartTitle.Text = ("Average Lane weight  of Air flow machine (Kg)")


        xlCharts = worksheet11.ChartObjects
        '  _Chartlocation = _Chartlocation + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet11.Range("f4", "f" & (x - 1))
        chartRange1 = worksheet11.Range("a6", "a" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Viscose (Lane weight)"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(146, 208, 80)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Average Lane weight  of Air flow machine (Kg)")


        chartRange = worksheet11.Range("g6", "g" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "AVG (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)



        chartRange = worksheet11.Range("e6", "e" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Cotton (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)


        ' chartPage.HasTitle = True
        'chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine

    End Function
    Function Avg_LaneWtAFMonthly()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Monthly Loading per lane(AF) "

        worksheet11.Columns("A").ColumnWidth = 12
        worksheet11.Columns("B").ColumnWidth = 12
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 13
        worksheet11.Columns("F").ColumnWidth = 13
        worksheet11.Columns("G").ColumnWidth = 10
        worksheet11.Columns("H").ColumnWidth = 10
        worksheet11.Columns("I").ColumnWidth = 10
        'worksheet11.Columns("J").ColumnWidth = 13


        worksheet11.Cells(2, 1) = "Monthly Average lane weight of  Air flow machine (Kg)  "
        worksheet11.Rows(2).Font.Bold = True
        worksheet11.Rows(2).Font.size = 14

        worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(2, 9)).Merge()

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(3, 2) = "Air Flow machine  "
        worksheet11.Rows(3).Font.Bold = True

        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 9)).Merge()
        worksheet11.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A5:A5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("A6:A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4, A5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("B4, B5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("C4, C5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("D4, D5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("d4, d5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("f4, f5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("g4, g5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("h4, i4").Interior.Color = RGB(149, 179, 215)
        worksheet11.Range("h5, i5").Interior.Color = RGB(149, 179, 215)


        worksheet11.Cells(4, 2) = "Production  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 3) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 3) = "batches"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 4) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 4) = "Lane"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 5) = "cotton  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 5) = "(Lane weight)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(4, 6) = "viscose   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 6) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 7) = "Avg   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 7) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 8) = "Conv. Factor   "
        worksheet11.Range(worksheet11.Cells(4, 8), worksheet11.Cells(4, 9)).Merge()
        worksheet11.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 8) = "Cotton"
        worksheet11.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 9) = "Visscose"
        worksheet11.Cells(5, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"

        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='N' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' group by year(m04Etime), Month(m04Etime)  order by year(m04Etime), Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        Dim M1 As Integer
        Dim M2 As Integer
        Dim L_DateofMonth As Integer

        ' Dim Y As Integer
        Y = 1
        x = 6
        M1 = 4
        M2 = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 1
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            ' N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet11.Cells(x, 1) = MonthName(T01.Tables(0).Rows(i)("T01month"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
            '-------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='White & Marl Monthly'!C" & M1
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M1 = M1 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='Shade Distribution Monthly'!b" & M2
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M2 = M2 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            'NO OF LANE
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate = StartdateofYear
            WeekEnddate = CDate(WeekStartdate).AddDays(+L_DateofMonth)
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"




            SQL = "SELECT SUM(T03LANE)AS LANE FROM M04LOT INNER JOIN T03MACHINE ON M04MACHINE_NO=T03Code WHERE M04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND T03TYPE='02'  AND M04pROGRAMETYPE='N'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                worksheet11.Cells(x, Y) = dsUser.Tables(0).Rows(0)("LANE")
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Else
                worksheet11.Cells(x, Y) = "0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            Y = Y + 1
            '-------------------------------------------------------------------------
            Dim n_Taken As Double
            Dim n_Lane As Integer
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose'  group by T03TYPE "
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose' group by T03TYPE "
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If
            '------------------------------------------------------------------------------------------
            If n_Taken = 0 Then
                worksheet11.Cells(x, Y) = "0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            Else

                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            End If
            Y = Y + 1
            '------------------------------------------------------------------------------------------
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose' group by T03TYPE "
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose' group by T03TYPE"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
            End If
            '------------------------------------------------------------------------------------------
            If n_Taken = 0 Then
            Else

                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            End If
            Y = Y + 1
            worksheet11.Cells(x, Y) = "=(b" & x & "/d" & x & ")"
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Y = Y + 1
            '-------------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                  " inner join m09quality on m09code=M04Quality " & _
                  "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                  "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose' group by T03TYPE "
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype<>'Viscose'  "
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then
                worksheet11.Cells(x, Y) = "0"
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("h" & x, "h" & x).Interior.Color = RGB(253, 233, 217)
            Else

                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("h" & x, "h" & x).Interior.Color = RGB(253, 233, 217)
            End If
            Y = Y + 1

            '-----------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                " inner join m09quality on m09code=M04Quality " & _
                "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose' group by T03TYPE"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('02') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then

                worksheet11.Cells(x, Y) = "0"
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("i" & x, "i" & x).Interior.Color = RGB(155, 187, 89)
            Else

                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("i" & x, "i" & x).Interior.Color = RGB(155, 187, 89)
            End If
            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '----------------------------------------------------------------------------------------------------------
            x = x + 1
            i = i + 1
        Next
        '-------------------------------------------------------------------------
        'chart
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim _Chartlocation As Integer
        Dim rh As Double

        _Chartlocation = (x * 10) + 80

        rh = (x - 3) * 12.75
        rh = rh + 18.75 + 20

        ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        '  chartPage.SeriesCollection.NewSeries()
        '  chartPage.SeriesCollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        ' chartPage.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))

        '   chartRange = worksheet11.Range("A4", "e" & (x - 1))
        ' chartPage.ChartObjects(1).CHART.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))
        'chartPage.ChartObjects(1).chart.seriescollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        '  chartPage.SeriesCollection(1).Series.AxisX = worksheet11.Range("A8", "A" & (X - 1))
        ' t_Series = chartPage.SeriesCollection.NewSeries
        ' t_Series.Name = "Q1"
        '   sh = "Weekly Down Time Analysis"
        ' t_Series.Values = "='Weekly Down Time Analysis'!$A$8:$E$21" '& chartRange
        ' t_Series.XValues = "='Weekly Down Time Analysis'!$A$9:$A$21"
        ' chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$B$8:$E$21"))
        'chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$A$8:$A$21"))
        'chartPage.SetSourceData(Source:=chartRange)
        'chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns

        'chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)
        'chartPage.HasTitle = True

        'chartPage.ChartTitle.Text = ("Average Lane weight  of Air flow machine (Kg)")


        xlCharts = worksheet11.ChartObjects
        '_Chartlocation = _Chartlocation + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet11.Range("f4", "f" & (x - 1))
        chartRange1 = worksheet11.Range("a6", "a" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Viscose (Lane weight)"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(146, 208, 80)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Average Lane weight  of Air flow machine (Kg)")


        chartRange = worksheet11.Range("g6", "g" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "AVG (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)



        chartRange = worksheet11.Range("e6", "e" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Cotton (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)


        ' chartPage.HasTitle = True
        'chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine

    End Function

    Function Avg_LaneWtWJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Weekly Loading per lane(WJ) "

        worksheet11.Columns("A").ColumnWidth = 12
        worksheet11.Columns("B").ColumnWidth = 12
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 13
        worksheet11.Columns("F").ColumnWidth = 13
        worksheet11.Columns("G").ColumnWidth = 10
        worksheet11.Columns("H").ColumnWidth = 10
        worksheet11.Columns("I").ColumnWidth = 10
        'worksheet11.Columns("J").ColumnWidth = 13


        worksheet11.Cells(2, 1) = "Weekly Average lane weight of  Water Jet machine (Kg)  "
        worksheet11.Rows(2).Font.Bold = True
        worksheet11.Rows(2).Font.size = 14

        worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(2, 9)).Merge()

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(3, 2) = "Water Jet machine  "
        worksheet11.Rows(3).Font.Bold = True

        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 9)).Merge()
        worksheet11.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A5:A5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("A6:A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4, A5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("B4, B5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("C4, C5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("D4, D5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("d4, d5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("f4, f5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("g4, g5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("h4, i4").Interior.Color = RGB(149, 179, 215)
        worksheet11.Range("h5, i5").Interior.Color = RGB(149, 179, 215)


        worksheet11.Cells(4, 2) = "Production  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 3) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 3) = "batches"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 4) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 4) = "Lane"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 5) = "cotton  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 5) = "(Lane weight)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(4, 6) = "viscose   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 6) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 7) = "Avg   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 7) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 8) = "Conv. Factor   "
        worksheet11.Range(worksheet11.Cells(4, 8), worksheet11.Cells(4, 9)).Merge()
        worksheet11.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 8) = "Cotton"
        worksheet11.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 9) = "Visscose"
        worksheet11.Cells(5, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


        Dim daysInFeb As Integer = System.DateTime.DaysInMonth(Microsoft.VisualBasic.Year(txtFromDate.Text), Microsoft.VisualBasic.Month(txtFromDate.Text))
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType='N' GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        Dim M1 As Integer
        Dim M2 As Integer

        ' Dim Y As Integer
        Y = 1
        x = 6
        M1 = 4
        M2 = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 1
            worksheet11.Cells(x, Y) = T01.Tables(0).Rows(i)("Ddate")
            ' worksheet1.Rows(8).Font.Bold = True
            ' worksheet11.Cells(x, Y).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Rows(x).Font.size = 10
            Y = Y + 1
            '-------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='White & Marl Weekly'!B" & M1
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M1 = M1 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='Shade Distribution Weekly'!K" & M2
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M2 = M2 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            'NO OF LANE
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If
            ' MsgBox(DatePart(DateInterval.Weekday, T01.Tables(0).Rows(i)("M04Week")))
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"


            'COLOUR
            Dim F1 As Integer
            Dim CL_Count As Integer

            Dim Y_Date As Date
            Dim _STD As Double
            Dim _Count As Integer
            Dim X_date As Date
            Dim X_date1 As Date
            _STD = 0
            _Count = 0
            Y_Date = WeekStartdate
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"




            SQL = "SELECT SUM(T03LANE)AS LANE FROM M04LOT INNER JOIN T03MACHINE ON M04MACHINE_NO=T03Code WHERE M04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND T03TYPE='01'  AND M04pROGRAMETYPE='N'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                worksheet11.Cells(x, Y) = dsUser.Tables(0).Rows(0)("LANE")
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Else
                worksheet11.Cells(x, Y) = "0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            Y = Y + 1
            '-------------------------------------------------------------------------
            Dim n_Taken As Double
            Dim n_Lane As Integer
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If
            '------------------------------------------------------------------------------------------
            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            End If
            Y = Y + 1
            '------------------------------------------------------------------------------------------
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else

                    n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If
            '------------------------------------------------------------------------------------------
            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            End If
            Y = Y + 1
            worksheet11.Cells(x, Y) = "=(b" & x & "/d" & x & ")"
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Y = Y + 1
            '-------------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                  " inner join m09quality on m09code=M04Quality " & _
                  "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                  "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M09MKG")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
                End If
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("h" & x, "h" & x).Interior.Color = RGB(253, 233, 217)
            End If
            Y = Y + 1

            '-----------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                " inner join m09quality on m09code=M04Quality " & _
                "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M09MKG")) Then
                Else

                    n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
                End If
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("i" & x, "i" & x).Interior.Color = RGB(155, 187, 89)
            End If
            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '----------------------------------------------------------------------------------------------------------
            x = x + 1
            i = i + 1
        Next
        '-------------------------------------------------------------------------
        'chart
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim _Chartlocation As Integer
        Dim rh As Double

        _Chartlocation = (x * 10) + 80


        rh = (x - 3) * 12.75
        rh = rh + 18.75 + 15
        ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        '  chartPage.SeriesCollection.NewSeries()
        '  chartPage.SeriesCollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        ' chartPage.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))

        '   chartRange = worksheet11.Range("A4", "e" & (x - 1))
        ' chartPage.ChartObjects(1).CHART.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))
        'chartPage.ChartObjects(1).chart.seriescollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        '  chartPage.SeriesCollection(1).Series.AxisX = worksheet11.Range("A8", "A" & (X - 1))
        ' t_Series = chartPage.SeriesCollection.NewSeries
        ' t_Series.Name = "Q1"
        '   sh = "Weekly Down Time Analysis"
        ' t_Series.Values = "='Weekly Down Time Analysis'!$A$8:$E$21" '& chartRange
        ' t_Series.XValues = "='Weekly Down Time Analysis'!$A$9:$A$21"
        ' chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$B$8:$E$21"))
        'chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$A$8:$A$21"))
        'chartPage.SetSourceData(Source:=chartRange)
        'chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns

        'chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)
        'chartPage.HasTitle = True

        'chartPage.ChartTitle.Text = ("Average Lane weight  of Air flow machine (Kg)")


        xlCharts = worksheet11.ChartObjects
        '_Chartlocation = _Chartlocation + 300
        rh = rh + 5
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet11.Range("f4", "f" & (x - 1))
        chartRange1 = worksheet11.Range("a6", "a" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Viscose (Lane weight)"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(146, 208, 80)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Average Lane weight  of Water Jet machine (Kg)")


        chartRange = worksheet11.Range("g6", "g" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "AVG (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE6
        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)



        chartRange = worksheet11.Range("e6", "e" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Cotton (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)


        ' chartPage.HasTitle = True
        'chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine

    End Function

    Function Avg_LaneWJMonthly()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Monthly Loading per lane(WJ) "

        worksheet11.Columns("A").ColumnWidth = 12
        worksheet11.Columns("B").ColumnWidth = 12
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 13
        worksheet11.Columns("F").ColumnWidth = 13
        worksheet11.Columns("G").ColumnWidth = 10
        worksheet11.Columns("H").ColumnWidth = 10
        worksheet11.Columns("I").ColumnWidth = 10
        'worksheet11.Columns("J").ColumnWidth = 13


        worksheet11.Cells(2, 1) = "Monthly Average lane weight of  Water Jet machine (Kg)  "
        worksheet11.Rows(2).Font.Bold = True
        worksheet11.Rows(2).Font.size = 14

        worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(2, 9)).Merge()

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Cells(3, 2) = "Water Jet machine  "
        worksheet11.Rows(3).Font.Bold = True

        worksheet11.Range(worksheet11.Cells(3, 2), worksheet11.Cells(3, 9)).Merge()
        worksheet11.Cells(3, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B3:B3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C3:C3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D3:D3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E3:E3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F3:F3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G3:G3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H3:H3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I3:I3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B4:B4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C4:C4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D4:D4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E4:E4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F4:F4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G4:G4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        ' worksheet11.Range("H4:H4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I4:I4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A5:A5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B5:B5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C5:C5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D5:D5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E5:E5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F5:F5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G5:G5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H5:H5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I5:I5").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


        worksheet11.Range("A6:A6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("B6:B6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("C6:C6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("D6:D6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("E6:E6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("F6:F6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("G6:G6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("H6:H6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("I6:I6").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

        worksheet11.Range("A4, A5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("B4, B5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("C4, C5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("D4, D5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("d4, d5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("e4, e5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("f4, f5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("g4, g5").Interior.Color = RGB(255, 255, 255)
        worksheet11.Range("h4, i4").Interior.Color = RGB(149, 179, 215)
        worksheet11.Range("h5, i5").Interior.Color = RGB(149, 179, 215)


        worksheet11.Cells(4, 2) = "Production  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 3) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 3) = "batches"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 4) = "No of  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 4) = "Lane"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 5) = "cotton  "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 5) = "(Lane weight)"
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


        worksheet11.Cells(4, 6) = "viscose   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 6) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 7) = "Avg   "
        worksheet11.Rows(4).Font.Bold = True
        worksheet11.Rows(4).Font.size = 10
        worksheet11.Cells(4, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 7) = "(Lane weight) "
        worksheet11.Rows(5).Font.Bold = True
        worksheet11.Rows(5).Font.size = 10
        worksheet11.Cells(5, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(4, 8) = "Conv. Factor   "
        worksheet11.Range(worksheet11.Cells(4, 8), worksheet11.Cells(4, 9)).Merge()
        worksheet11.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 8) = "Cotton"
        worksheet11.Cells(5, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

        worksheet11.Cells(5, 9) = "Visscose"
        worksheet11.Cells(5, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"

        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
              "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='N' AND T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' group by year(m04Etime), Month(m04Etime)  order by year(m04Etime), Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        i = 0
        Dim x As Integer
        Dim M1 As Integer
        Dim M2 As Integer
        Dim L_DateofMonth As Integer

        ' Dim Y As Integer
        Y = 1
        x = 6
        M1 = 4
        M2 = 4
        For Each DTRow3 As DataRow In T01.Tables(0).Rows
            Y = 1
            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            ' N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet11.Cells(x, 1) = MonthName(T01.Tables(0).Rows(i)("T01month"), True) & "-" & T01.Tables(0).Rows(i)("EYear")
            worksheet11.Rows(x).Font.size = 10

            Y = Y + 1
            '-------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='White & Marl Monthly'!B" & M1
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M1 = M1 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            worksheet11.Cells(x, Y) = "='Shade Distribution Monthly'!K" & M2
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            M2 = M2 + 1
            Y = Y + 1
            '--------------------------------------------------------------------------------
            'NO OF LANE
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate = StartdateofYear
            WeekEnddate = CDate(WeekStartdate).AddDays(+L_DateofMonth)
            WeekStartdate = WeekStartdate & " " & "7:30AM"
            WeekEnddate = WeekEnddate & " " & "7:30AM"




            SQL = "SELECT SUM(T03LANE)AS LANE FROM M04LOT INNER JOIN T03MACHINE ON M04MACHINE_NO=T03Code WHERE M04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' AND T03TYPE='01'  AND M04pROGRAMETYPE='N'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                worksheet11.Cells(x, Y) = dsUser.Tables(0).Rows(0)("LANE")
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Else
                worksheet11.Cells(x, Y) = "0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            Y = Y + 1
            '-------------------------------------------------------------------------
            Dim n_Taken As Double
            Dim n_Lane As Integer
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If
            '------------------------------------------------------------------------------------------
            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            End If
            Y = Y + 1
            '------------------------------------------------------------------------------------------
            SQL = "SELECT SUM(M04Batchwt) AS M04Batchwt FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Taken = 0
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If

            n_Lane = 0
            SQL = "SELECT SUM(T03Lane) AS M04Batchwt FROM M04Lot " & _
                   "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                   "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' AND '" & WeekEnddate & "' " & _
                   "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M04Batchwt")) Then
                Else
                    n_Lane = dsUser.Tables(0).Rows(0)("M04Batchwt")
                End If
            End If
            '------------------------------------------------------------------------------------------
            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0"
            End If
            Y = Y + 1
            worksheet11.Cells(x, Y) = "=(b" & x & "/d" & x & ")"
            range1 = worksheet11.Cells(x, Y)
            range1.NumberFormat = "0"
            worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Y = Y + 1
            '-------------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                  "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                  " inner join m09quality on m09code=M04Quality " & _
                  "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                  "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M09MKG")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
                End If
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype<>'Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("h" & x, "h" & x).Interior.Color = RGB(253, 233, 217)
            End If
            Y = Y + 1

            '-----------------------------------------------------------------------------------------
            SQL = "SELECT sum(M09MKG) AS M09MKG FROM M04Lot " & _
                "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                " inner join m09quality on m09code=M04Quality " & _
                "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            n_Taken = 0
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            If isValidDataset(dsUser) Then
                If IsDBNull(dsUser.Tables(0).Rows(0)("M09MKG")) Then
                Else
                    n_Taken = dsUser.Tables(0).Rows(0)("M09MKG")
                End If
            End If
            '---------------------------------------------------------
            n_Lane = 0
            SQL = "SELECT (M09MKG) AS M09MKG FROM M04Lot " & _
                 "INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                 " inner join m09quality on m09code=M04Quality " & _
                 "WHERE m04ETIME BETWEEN '" & WeekStartdate & "' and '" & WeekEnddate & " ' " & _
                 "AND M04ProgrameType='N' AND T03TYPE IN ('01') and m04Qtype='Viscose'"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            n_Lane = dsUser.Tables(0).Rows.Count

            If n_Taken = 0 Then
            Else
                worksheet11.Cells(x, Y) = n_Taken / n_Lane
                range1 = worksheet11.Cells(x, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(x, Y).HorizontalAlignment = XlHAlign.xlHAlignRight
                worksheet11.Range("i" & x, "i" & x).Interior.Color = RGB(155, 187, 89)
            End If

            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("A" & x & ":A" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("B" & x & ":B" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("C" & x & ":C" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("D" & x & ":D" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("E" & x & ":E" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("F" & x & ":F" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("G" & x & ":G" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("H" & x & ":H" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("I" & x & ":I" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '----------------------------------------------------------------------------------------------------------
            x = x + 1
            i = i + 1
        Next
        '-------------------------------------------------------------------------
        'chart
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        Dim _Chartlocation As Integer
        Dim rh As Double
        _Chartlocation = (x * 10) + 80


        rh = (x - 2) * 12.75
        rh = rh + 18.75
        ' chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlColumnStacked
        '  chartPage.SeriesCollection.NewSeries()
        '  chartPage.SeriesCollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        ' chartPage.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))

        '   chartRange = worksheet11.Range("A4", "e" & (x - 1))
        ' chartPage.ChartObjects(1).CHART.SeriesCollection(1).XValues = worksheet11.Range("A8", "A" & (X - 1))
        'chartPage.ChartObjects(1).chart.seriescollection(1).Values = worksheet11.Range("B8", "E" & (X - 1))
        '  chartPage.SeriesCollection(1).Series.AxisX = worksheet11.Range("A8", "A" & (X - 1))
        ' t_Series = chartPage.SeriesCollection.NewSeries
        ' t_Series.Name = "Q1"
        '   sh = "Weekly Down Time Analysis"
        ' t_Series.Values = "='Weekly Down Time Analysis'!$A$8:$E$21" '& chartRange
        ' t_Series.XValues = "='Weekly Down Time Analysis'!$A$9:$A$21"
        ' chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$B$8:$E$21"))
        'chartPage.SetSourceData(Source:=worksheet11.Range("'Weekly Down Time Analysis'!$A$8:$A$21"))
        'chartPage.SetSourceData(Source:=chartRange)
        'chartPage.PlotBy = Microsoft.Office.Interop.Excel.XlRowCol.xlColumns

        'chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        'chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)
        'chartPage.HasTitle = True

        'chartPage.ChartTitle.Text = ("Average Lane weight  of Air flow machine (Kg)")

        rh = rh + 8
        xlCharts = worksheet11.ChartObjects
        '_Chartlocation = _Chartlocation + 300
        myChart = xlCharts.Add(7, rh, 905, 300)
        chartPage = myChart.Chart
        chartRange = worksheet11.Range("f4", "f" & (x - 1))
        chartRange1 = worksheet11.Range("a6", "a" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Viscose (Lane weight)"
            t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(146, 208, 80)
        ' chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
        chartPage.HasTitle = True
        chartPage.ChartTitle.Text = ("Average Lane weight  of Water Jet machine (Kg)")


        chartRange = worksheet11.Range("g6", "g" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "AVG (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)



        chartRange = worksheet11.Range("e6", "e" & (x - 1))
        ' chartRange1 = worksheet118.Range("C4", "C" & (x - 1))
        t_SerCol = chartPage.SeriesCollection
        t_Series = t_SerCol.NewSeries
        With t_Series
            .Name = "Cotton (Lane weight)"
            ' t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
            t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

        End With
        't_Series.Border.Color = RGB(255, 91, 91)
        'chartPage.Refresh()
        chartPage.SeriesCollection(1).Interior.Color = RGB(155, 187, 89)


        ' chartPage.HasTitle = True
        'chartPage.ChartTitle.Text = ("White & Mal")
        chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine

    End Function

    Function Batch_perDayAF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches Per Day - Daily (AF)"

        worksheet11.Columns("A").ColumnWidth = 24
        worksheet11.Columns("B").ColumnWidth = 10
        worksheet11.Columns("C").ColumnWidth = 10
        worksheet11.Columns("D").ColumnWidth = 10
        worksheet11.Columns("E").ColumnWidth = 10
        worksheet11.Columns("F").ColumnWidth = 10
        worksheet11.Columns("G").ColumnWidth = 10
        worksheet11.Columns("H").ColumnWidth = 10
        worksheet11.Columns("I").ColumnWidth = 20
        'worksheet11.Columns("J").ColumnWidth = 13

        n_Date = txtFromDate.Value
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & N_Date1 & "' and '" & n_Date & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        If isValidDataset(T01) Then
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If


            worksheet11.Cells(2, 1) = "Week   " & T01.Tables(0).Rows(0)("M04Week") & "   Air flow  batches per machine per day (colours)  "
            worksheet11.Rows(2).Font.Bold = True
            worksheet11.Rows(2).Font.size = 14

            worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(1, 9)).Merge()
            worksheet11.Cells(1, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(3, 1) = ""
            worksheet11.Rows(3).Font.Bold = True
            worksheet11.Rows(3).Font.size = 12
            worksheet11.Cells(3, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Dim X As Integer
            Dim x_Date As Date

            X = 2
            x_Date = WeekStartdate
            For i = 1 To 7
                worksheet11.Cells(3, X) = x_Date
                worksheet11.Cells(3, X).EntireColumn.NumberFormat = "dd-MMM"
                worksheet11.Cells(3, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                x_Date = CDate(x_Date).AddDays(+1)
                X = X + 1
            Next

            worksheet11.Cells(3, X) = "No. of batches/daily"


            '------------------------------------------------------------------------------------------
            worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b3:b3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c3:c3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d3:d3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e3:e3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f3:f3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g3:g3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h3:h3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i3:i3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b3:b3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c3:c3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d3:d3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e3:e3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f3:f3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g3:g3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h3:h3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i3:i3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b3:b3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c3:c3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d3:d3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e3:e3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f3:f3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g3:g3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h3:h3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i3:i3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            '---------------------------------------------------------------------------------------------------------
            'worksheet11.Range("A3, A3").Interior.Color = RGB(215, 228, 188)
            'worksheet11.Range("b3, b3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("c3, c3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("d3, d3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("e3, e3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("f3, f3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("g3, g3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("h3, h3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("i3, i3").Interior.Color = RGB(219, 238, 243)

            X = 4

            Dim Y1 As Integer
            Dim Z As Integer
            Dim X_Date1 As Date

            i = 0
            SQL = "SELECT T03Code,T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE T03TYPE IN ('02') and " & _
           " M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType in ('N','R','S') " & _
          "group by T03Name,T03code"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In dsUser.Tables(0).Rows
                worksheet11.Cells(X, 1) = dsUser.Tables(0).Rows(i)("T03Name")
                x_Date = WeekStartdate
                Y1 = 2
                Y = 2
                For Y1 = 1 To 7
                    X_Date1 = CDate(x_Date).AddDays(+1)
                    If Y1 = 1 Then
                        ' x_Date = x_Date & " " & "7:30 AM"
                        x_Date = x_Date & " " & "7:30AM"
                        X_Date1 = X_Date1 & " " & "7:30AM"
                    End If
                    SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE T03TYPE IN ('02') and " & _
           " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S') and  T03code='" & dsUser.Tables(0).Rows(i)("T03code") & "'  and M04Batchwt>0 " & _
          "group by T03code"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T04) Then
                        range1 = worksheet11.Cells(X, Y)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X, Y) = T04.Tables(0).Rows(0)("T03Name")
                    End If
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    x_Date = X_Date1
                    Y = Y + 1

                Next

                worksheet11.Range("I" & (X)).Formula = "=SUM(b" & X & ":H" & X & ")"
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                X = X + 1
                i = i + 1
            Next
            worksheet11.Cells(X, 1) = "Total"
            worksheet11.Rows(X).Font.Bold = True
            Y = 2
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0"

            worksheet11.Cells(X, 2) = "=SUM(b4:b" & (X - 1) & ")"
            worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 3)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 3) = "=SUM(c4:c" & (X - 1) & ")"
            worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 4)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 4) = "=SUM(d4:d" & (X - 1) & ")"
            worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 5)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 5) = "=SUM(e4:e" & (X - 1) & ")"
            worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 6)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 6) = "=SUM(f4:f" & (X - 1) & ")"
            worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 7)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 7) = "=SUM(g4:g" & (X - 1) & ")"
            worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 8)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 8) = "=SUM(h4:h" & (X - 1) & ")"
            worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter



            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '--------------------------------------------------------------------------------------------------------------------------
            X = X + 1
            worksheet11.Cells(X, 1) = "No. of batches (with out no work)"
            worksheet11.Cells(X, 1).WrapText = True

            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0.0"
            '----------------------------------------------------------------------------------------
            worksheet11.Cells(X + 1, 1) = "No work  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            ' range1 = worksheet11.Cells(X, 2)
            'range1.NumberFormat = "0%"

            i = 0
            Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            y1 = 2
            For i = 1 To 7
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next
                x_Date = X_Date1
                N_TOTALHR = 9 * 24 * 60
                n_per = n_per / N_TOTALHR

                Dim B1 As Double
                Dim B2 As Double
                B2 = 0
                B1 = 1 - n_per
                If i = 1 Then
                    worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 1 & ":B" & X - 1 & ")"
                    worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                    worksheet11.Cells(X + 1, 2) = n_per
                   
                    range1 = worksheet11.Cells(X + 1, 2)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 2 Then
                    worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 1 & ":c" & X - 1 & ") "
                    worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, 3)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, 3) = n_per

                    range1 = worksheet11.Cells(X + 1, 3)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 3 Then
                    worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 1 & ":D" & X - 1 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, 4)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 4 Then
                    worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 1 & ":E" & X - 1 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 5 Then
                    worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 1 & ":F" & X - 1 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 6 Then
                    worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 1 & ":G" & X - 1 & ")"
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 7 Then
                    worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 1 & ":H" & X - 1 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                ' B1 = 1 - B1
                B1 = 9 * B1
                B2 = B2 / B1
                'B2 = worksheet11.Cells(X, 2)
                range1 = worksheet11.Cells(X, Y1)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y1) = B2
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            range1 = worksheet11.Cells(X, 9)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 9) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
            worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X + 1, 9)
            range1.NumberFormat = "0%"
            worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
            worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Dim _Count As Double
            Dim _nCount As Integer
            _Count = 0
            _Count = (worksheet11.Cells(X, 9).Value.ToString)

            _nCount = 0
            Y = 2
            For i = 1 To 7
                If (worksheet11.Cells(X, Y).Value.ToString) = 0 Then

                Else
                    _nCount = _nCount + 1
                End If
                Y = Y + 1
            Next
            _Count = _Count / _nCount
            Y = 0
            n_per = 0

            'x_Date = WeekStartdate
            'For i = 1 To 7
            '    X_Date1 = CDate(x_Date).AddDays(+1)
            '    If i = 1 Then
            '        ' x_Date = x_Date & " " & "7:30 AM"
            '        x_Date = x_Date & " " & "7:30AM"
            '        X_Date1 = X_Date1 & " " & "7:30AM"
            '    End If
            '    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
            '    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '    Y = 0
            '    For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
            '        Y = Y + 1
            '    Next
            '    x_Date = X_Date1
            'Next
            'x_Date = X_Date1
            'N_TOTALHR = 9 * 27 * 60 * _nCount
            'n_per = n_per / N_TOTALHR
            worksheet11.Cells(X, 9) = _Count
            worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            _Count = (worksheet11.Cells(X, 9).Value.ToString)
            n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
            _Count = _Count / (9 * (1 - n_per))

            worksheet11.Cells(X, 9) = _Count
            worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(X, 9)
            range1.NumberFormat = "0.0"




            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            X = X + 1

            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            X = X + 1
            '---------------------------------------------------------------------------------------
            worksheet11.Cells(X, 1) = "No. of batches(with out No work + M/main)"
            worksheet11.Cells(X, 1).WrapText = True

            worksheet11.Cells(X + 1, 1) = " No work + M/main  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            i = 0
            ' Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To 7
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('No Work','PM','MainM') and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                    Y = Y + 1
                Next
                x_Date = X_Date1
                N_TOTALHR = 9 * 24 * 60
                n_per = n_per / N_TOTALHR

                Dim B1 As Double
                Dim B2 As Double
                B2 = 0
                B1 = 1 - n_per
                If i = 1 Then
                    worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 3 & ":B" & X - 3 & ")"
                    worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, 2)
                    range1.NumberFormat = "0"
                    worksheet11.Cells(X + 1, 2) = n_per

                    range1 = worksheet11.Cells(X + 1, 2)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 2 Then
                    worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 3 & ":c" & X - 3 & ") "
                    worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, 3)
                    range1.NumberFormat = "0"

                    worksheet11.Cells(X + 1, 3) = n_per

                    range1 = worksheet11.Cells(X + 1, 3)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 3 Then
                    worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 3 & ":D" & X - 3 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, 4)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 4 Then
                    worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 3 & ":E" & X - 3 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 5 Then
                    worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 3 & ":F" & X - 3 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 6 Then
                    worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 3 & ":G" & X - 3 & ")"
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                ElseIf i = 7 Then
                    worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 3 & ":H" & X - 3 & ") "
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = n_per

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                ' B1 = 1 - B1
                B1 = 9 * B1
                B2 = B2 / B1
                'B2 = worksheet11.Cells(X, 2)
                range1 = worksheet11.Cells(X, Y1)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y1) = B2
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            'range1 = worksheet11.Cells(X, 9)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 9) = "=SUM(b" & (X - 3) & ":h" & (X - 3) & ")"
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X, 9)
            range1.NumberFormat = "0"
            worksheet11.Cells(X, 9) = "=SUM(b" & (X - 3) & ":h" & (X - 3) & ")"
            worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            range1 = worksheet11.Cells(X + 1, 9)
            range1.NumberFormat = "0%"
            worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
            worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter



            _Count = 0
            _Count = (worksheet11.Cells(X, 9).Value.ToString)

            Dim MC_Count As Integer
            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To 7
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0


                Dim H1 As Integer
                ' MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0

            worksheet11.Cells(X, 9) = _Count
            worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            _Count = (worksheet11.Cells(X, 9).Value.ToString)
            n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
            _Count = _Count / (MC_Count * (1 - n_per))

            worksheet11.Cells(X, 9) = _Count
            worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            range1 = worksheet11.Cells(X, 9)
            range1.NumberFormat = "0.0"

            '_Count = 0
            '_Count = (worksheet11.Cells(X, 9).Value.ToString)

            '_nCount = 0
            'Y = 2
            'For i = 1 To 7
            '    If (worksheet11.Cells(X, Y).Value.ToString) = 0 Then

            '    Else
            '        _nCount = _nCount + 1
            '    End If
            '    Y = Y + 1
            'Next
            '_Count = _Count / _nCount
            'Y = 0
            'n_per = 0

            ''x_Date = WeekStartdate
            ''For i = 1 To 7
            ''    X_Date1 = CDate(x_Date).AddDays(+1)
            ''    If i = 1 Then
            ''        ' x_Date = x_Date & " " & "7:30 AM"
            ''        x_Date = x_Date & " " & "7:30AM"
            ''        X_Date1 = X_Date1 & " " & "7:30AM"
            ''    End If
            ''    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
            ''    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            ''    Y = 0
            ''    For Each DTRow4 As DataRow In T03.Tables(0).Rows
            ''        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
            ''        Y = Y + 1
            ''    Next
            ''    x_Date = X_Date1
            ''Next
            ''x_Date = X_Date1
            ''N_TOTALHR = 9 * 27 * 60 * _nCount
            ''n_per = n_per / N_TOTALHR
            'worksheet11.Cells(X, 9) = _Count
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '_Count = (worksheet11.Cells(X, 9).Value.ToString)
            'n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
            '_Count = _Count / (9 * (1 - n_per))

            'worksheet11.Cells(X, 9) = _Count
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'range1 = worksheet11.Cells(X, 9)
            'range1.NumberFormat = "0.0"



            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(146, 208, 80)

            X = X + 1

            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            X = X + 3
            worksheet11.Cells(X, 1) = "Non bio-polish batches per day  without delay "
            worksheet11.Cells(X, 1).WrapText = True

            Dim _STD As Double

            _STD = 0
            x_Date = WeekStartdate
            Y = 2
            For i = 1 To 7

                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                If _STD > 0 Then
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y) = 24 / _STD
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If

                x_Date = X_Date1
                Y = Y + 1
            Next
            '--------------------------------------------------------------------------------------


            ' X = X + 1
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(234, 241, 221)

            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(234, 241, 221)

            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDot
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(194, 214, 154)


            X = X + 1

            worksheet11.Cells(X, 1) = "Non bio-polish Batches per day                           "
            worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(0, 0, 255)

            Dim n_Taken As Double
            Dim n_Count As Integer
            Dim M1 As Integer

            Y = 2
            x_Date = WeekStartdate
            For i = 1 To 7
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_Date & "' and '" & X_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                n_Count = 0
                n_Taken = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                N_TOTALHR = 9 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 9
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 0, 255)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                Y = Y + 1
                x_Date = X_Date1
            Next



            ' worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

            ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

            ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

            ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

            '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

            ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

            ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(215, 228, 188)

            ' worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(215, 228, 188)

            X = X + 1
            worksheet11.Cells(X, 1) = "Bio-polish Batches per day                        "
            worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(255, 0, 0)

           

            Y = 2
            x_Date = WeekStartdate
            For i = 1 To 7
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_Date & "' and '" & X_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                n_Count = 0
                n_Taken = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                N_TOTALHR = 9 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 9
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(255, 0, 0)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                Y = Y + 1
                x_Date = X_Date1
            Next



            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

            ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

            ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

            ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

            '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

            ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

            ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
            worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(194, 214, 154)

            ' worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(194, 214, 154)






            Dim chartPage As Microsoft.Office.Interop.Excel.Chart
            Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
            Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
            Dim chartRange As Microsoft.Office.Interop.Excel.Range
            Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
            Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


            Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
            Dim t_Series As Microsoft.Office.Interop.Excel.Series
            Dim z1 As Integer
            Dim sh As Worksheet
            xlCharts = worksheet11.ChartObjects

            Dim _Chartlocation As Integer

            _Chartlocation = (X + 25) * 10

            myChart = xlCharts.Add(10, _Chartlocation, 905, 300)
            chartPage = myChart.Chart
            Dim _CH As Integer
            '_CH = 7
            'For _CH = 7 To x - 1
            chartRange = worksheet11.Range("b16", "H16")
            chartRange1 = worksheet11.Range("b3", "h3")
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of Baches per day (All)"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            chartRange = worksheet11.Range("b21", "H21")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            chartRange = worksheet11.Range("b22", "H22")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If




    End Function

    Function Batch_perWeekAF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer
        Dim _cOUNT As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches per day -Weekly  (AF)"

        worksheet11.Columns("A").ColumnWidth = 45
        'worksheet11.Columns("B").ColumnWidth = 10
        'worksheet11.Columns("C").ColumnWidth = 10
        'worksheet11.Columns("D").ColumnWidth = 10
        'worksheet11.Columns("E").ColumnWidth = 10
        'worksheet11.Columns("F").ColumnWidth = 10
        'worksheet11.Columns("G").ColumnWidth = 10
        'worksheet11.Columns("H").ColumnWidth = 10
        'worksheet11.Columns("I").ColumnWidth = 20
        ''worksheet11.Columns("J").ColumnWidth = 13

        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"


        Dim X As Integer
        X = 2
        i = 0
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows



            worksheet11.Cells(3, X) = T01.Tables(0).Rows(i)("ddate")
            'worksheet11.Cells(3, X).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Cells(3, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet11.Range(3, X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            X = X + 1
            i = i + 1
        Next
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Interior.Color = RGB(165, 165, 165)
        Dim _String As String
     
        _String = "B3:B3"
        Dim a As String
        a = 66

        For i = 1 To T01.Tables(0).Rows.Count
          
            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "3" & ":A" & Chr(a - 26) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                Else
                    '  _String = "B" & Chr(a - 52) & "3" & ":B" & Chr(a - 52) & "3"
                    If i + 1 = 27 Then
                        _String = "AA3:Aa3"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab3:Ab3"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac3:Ac3"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad3:Ad3"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae3:Ae3"
                    ElseIf i + 1 = 32 Then
                        _String = "Af3:Af3"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag3:Ag3"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah3:Ah3"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai3:Ai3"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj3:Aj3"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak3:Ak3"
                    ElseIf i + 1 = 38 Then
                        _String = "AL3:AL3"
                    ElseIf i + 1 = 39 Then
                        _String = "AM3:AM3"
                    ElseIf i + 1 = 40 Then
                        _String = "AN3:AN3"
                    ElseIf i + 1 = 41 Then
                        _String = "AO3:AO3"
                    ElseIf i + 1 = 42 Then
                        _String = "AP3:AP3"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ3:AQ3"
                    ElseIf i + 1 = 44 Then
                        _String = "AR3:AR3"
                    ElseIf i + 1 = 45 Then
                        _String = "AS3:AS3"
                    ElseIf i + 1 = 46 Then
                        _String = "AT3:AT3"
                    ElseIf i + 1 = 47 Then
                        _String = "AU3:AV3"
                    ElseIf i + 1 = 48 Then
                        _String = "AV3:AV3"
                    ElseIf i + 1 = 49 Then
                        _String = "AW3:AW3"
                    ElseIf i + 1 = 50 Then
                        _String = "AX3:AX3"
                    ElseIf i + 1 = 51 Then
                        _String = "AY3:AY3"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ3:AZ3"




                    End If
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "3" & ":" & Chr(a) & "3"
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                a = a + 1
            End If




        Next
        worksheet11.Cells(4, 1) = "No of batches per day  without any delay                                           (Non bio-polish batches)"
        worksheet11.Cells(4, 1).WrapText = True
        '  worksheet11.Rows(4).rowheight = 20.25


        'NO OF BATCHES
        Dim _STD As Double
        Dim x_DATE As Date
        Dim X_DATE1 As Date

        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        Dim y2 As Integer

        X = 4
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _COUNT = 0
            For y2 = 1 To L_DateofMonth

                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                x_DATE = X_DATE1

            Next
            ' _STD = _STD / 60
            _STD = _STD / _COUNT
            _STD = _STD / 60
            If _STD > 0 Then
                worksheet11.Cells(X, Y) = _STD
                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y) = 24 / _STD
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If

            Y = Y + 1
            i = i + 1
        Next
        '--------------------------------------------------------------------------------------
        _String = "A4:A4"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "4" & ":A" & Chr(a - 26) & "4"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                Else
                    ' _String = "B" & Chr(a - 52) & "4" & ":B" & Chr(a - 52) & "4"
                    If i + 1 = 27 Then
                        _String = "AA4:Aa4"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab4:Ab4"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac4:Ac4"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad4:Ad4"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae4:Ae4"
                    ElseIf i + 1 = 32 Then
                        _String = "Af4:Af4"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag5:Ag4"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah4:Ah4"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai4:Ai4"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj4:Aj4"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak4:Ak4"
                    ElseIf i + 1 = 38 Then
                        _String = "AL4:AL4"
                    ElseIf i + 1 = 39 Then
                        _String = "AM4:AM4"
                    ElseIf i + 1 = 40 Then
                        _String = "AN4:AN4"
                    ElseIf i + 1 = 41 Then
                        _String = "AO4:AO4"
                    ElseIf i + 1 = 42 Then
                        _String = "AP4:AP4"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ4:AQ4"
                    ElseIf i + 1 = 44 Then
                        _String = "AR4:AR4"
                    ElseIf i + 1 = 45 Then
                        _String = "AS4:AS4"
                    ElseIf i + 1 = 46 Then
                        _String = "AT4:AT4"
                    ElseIf i + 1 = 47 Then
                        _String = "AU4:AV4"
                    ElseIf i + 1 = 48 Then
                        _String = "AV4:AV4"
                    ElseIf i + 1 = 49 Then
                        _String = "AW4:AW4"
                    ElseIf i + 1 = 50 Then
                        _String = "AX4:AX4"
                    ElseIf i + 1 = 51 Then
                        _String = "AY4:AY4"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ4:AZ4"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "4" & ":" & Chr(a) & "4"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                a = a + 1
            End If




        Next

        '------------------------------------------------------------------------------------------
        worksheet11.Cells(5, 1) = "Non Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(5).rowheight = 30.25
        'NON BIO POLISH


        Dim N_TOTALHR As Integer


        Dim n_Taken As Double
        Dim n_Count As Integer
        Dim M1 As Integer

        Y = 2
        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 5
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If

            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If

                M1 = 0
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)


                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                'n_Taken = n_Taken / 60
                'n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                'n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                'N_TOTALHR = 9 * 24 * 60
                'n_per = n_per / N_TOTALHR
                'n_per = n_per * 216
                'n_per = n_per / 9
                ''-----------------------------------------------------
                ''Fabric
                'n_Taken = n_Taken + n_per
                'n_Taken = 24 - n_Taken

                '_STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                ' Y = Y + 1
                x_DATE = X_DATE1
            Next

            n_Taken = n_Taken / 60
            n_Taken = n_Taken / 9

            N_TOTALHR = 9 * 24 * 60
            n_per = n_per / N_TOTALHR
            n_per = n_per * 216
            n_per = n_per / 9
            n_per = n_per / 7
            n_Taken = n_Taken / 7
            '-----------------------------------------------------
            'Fabric
            n_Taken = n_Taken + n_per
            n_Taken = 24 - n_Taken


            _STD = _STD / 60
            _STD = _STD / _cOUNT

            If _STD > 0 Then
                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True
            End If

            range1 = worksheet11.Cells(X, Y)
            range1.NumberFormat = "0.0"
            range1.Font.Color = RGB(0, 0, 255)
            worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Y = Y + 1
            i = i + 1

        Next

      

        _String = "A5:A5"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "5" & ":A" & Chr(a - 26) & "5"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                Else
                    ' _String = "B" & Chr(a - 52) & "5" & ":B" & Chr(a - 52) & "5"
                    If i + 1 = 27 Then
                        _String = "AA5:Aa5"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab5:Ab5"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac5:Ac5"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad5:Ad5"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae5:Ae5"
                    ElseIf i + 1 = 32 Then
                        _String = "Af5:Af5"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag5:Ag5"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah5:Ah5"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai5:Ai5"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj5:Aj5"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak5:Ak5"
                    ElseIf i + 1 = 38 Then
                        _String = "AL5:AL5"
                    ElseIf i + 1 = 39 Then
                        _String = "AM5:AM5"
                    ElseIf i + 1 = 40 Then
                        _String = "AN5:AN5"
                    ElseIf i + 1 = 41 Then
                        _String = "AO5:AO5"
                    ElseIf i + 1 = 42 Then
                        _String = "AP5:AP5"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ5:AQ5"
                    ElseIf i + 1 = 44 Then
                        _String = "AR5:AR5"
                    ElseIf i + 1 = 45 Then
                        _String = "AS5:AS5"
                    ElseIf i + 1 = 46 Then
                        _String = "AT5:AT5"
                    ElseIf i + 1 = 47 Then
                        _String = "AU5:AV5"
                    ElseIf i + 1 = 48 Then
                        _String = "AV5:AV5"
                    ElseIf i + 1 = 49 Then
                        _String = "AW5:AW5"
                    ElseIf i + 1 = 50 Then
                        _String = "AX5:AX5"
                    ElseIf i + 1 = 51 Then
                        _String = "AY5:AY5"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ5:AZ5"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "5" & ":" & Chr(a) & "5"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                a = a + 1
            End If




        Next

        '-------------------------------------------------------------------------------------
        worksheet11.Cells(6, 1) = "Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(6).rowheight = 30.25
        'NON BIO POLISH


        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 6
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            x_DATE = WeekStartdate1
            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                '  n_Count = 0
                ' n_Taken = 0
                M1 = 0
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next

                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                '  n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1

                '  _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                'Y = Y + 1
                x_DATE = X_DATE1
            Next

            n_Taken = n_Taken / 60
            n_Taken = n_Taken / 9

            N_TOTALHR = 9 * 24 * 60
            n_per = n_per / N_TOTALHR
            n_per = n_per * 216
            n_per = n_per / 9
            n_Taken = n_Taken / 7
            n_per = n_per / 7
            '-----------------------------------------------------
            'Fabric
            n_Taken = n_Taken + n_per
            n_Taken = 24 - n_Taken

            _STD = _STD / 60
            _STD = _STD / _cOUNT

            If _STD > 0 Then
                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True

            End If
            range1 = worksheet11.Cells(X, Y)
            range1.NumberFormat = "0.0"
            range1.Font.Color = RGB(255, 0, 0)
            worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            i = i + 1
            Y = Y + 1
        Next

        _String = "A6:A6"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "6" & ":A" & Chr(a - 26) & "6"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                Else
                    '  _String = "B" & Chr(a - 52) & "6" & ":B" & Chr(a - 52) & "6"
                    If i + 1 = 27 Then
                        _String = "AA6:Aa6"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab6:Ab6"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac6:Ac6"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad6:Ad6"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae6:Ae6"
                    ElseIf i + 1 = 32 Then
                        _String = "Af6:Af6"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag6:Ag6"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah6:Ah6"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai6:Ai6"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj6:Aj6"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak6:Ak6"
                    ElseIf i + 1 = 38 Then
                        _String = "AL6:AL6"
                    ElseIf i + 1 = 39 Then
                        _String = "AM6:AM6"
                    ElseIf i + 1 = 40 Then
                        _String = "AN6:AN6"
                    ElseIf i + 1 = 41 Then
                        _String = "AO6:AO6"
                    ElseIf i + 1 = 42 Then
                        _String = "AP6:AP6"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ6:AQ6"
                    ElseIf i + 1 = 44 Then
                        _String = "AR6:AR6"
                    ElseIf i + 1 = 45 Then
                        _String = "AS6:AS6"
                    ElseIf i + 1 = 46 Then
                        _String = "AT6:AT6"
                    ElseIf i + 1 = 47 Then
                        _String = "AU6:AV6"
                    ElseIf i + 1 = 48 Then
                        _String = "AV6:AV6"
                    ElseIf i + 1 = 49 Then
                        _String = "AW6:AW6"
                    ElseIf i + 1 = 50 Then
                        _String = "AX6:AX6"
                    ElseIf i + 1 = 51 Then
                        _String = "AY6:AY6"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ6:AZ6"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "6" & ":" & Chr(a) & "6"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                a = a + 1
            End If

        Next
        '--------------------------------------------------------------------------
        'No of batches per day( Bio-polish + Non bio-polish)  
        Dim MC_Count As Integer
        Dim Y3 As Integer
        Y3 = 2
        i = 0
        Y = 2
        worksheet11.Cells(7, 1) = "No of batches per day( Bio-polish + Non bio-polish)  "
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(7).rowheight = 30.25
        '  Dim y1 As Integer
        ' Dim y2 As Integer
        Dim M_Total As Double
        X = 7
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0
            M_Total = 0
            x_DATE = WeekStartdate1
            MC_Count = 0
            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                M1 = 0
                M1 = 0
                Dim H1 As Integer

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
" M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
"group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    M_Total = M_Total + T04.Tables(0).Rows(H1)("T03Name")
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow1 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next

                '         SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                '         "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE T03TYPE IN ('02') and " & _
                ' " M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 " & _
                '"group by T03code"
                '         T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                '         MC_Count = MC_Count + T04.Tables(0).Rows.Count
                '         For Each DTRow1 As DataRow In T04.Tables(0).Rows

                '             M_Total = M_Total + T04.Tables(0).Rows(M1)("T03Name")
                '             M1 = M1 + 1
                '         Next

                '         '------------------------------------------------------------------------
                '         M1 = 0
                '         SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('No Work','PM','MainM') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                '         T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                '         For Each DTRow1 As DataRow In T03.Tables(0).Rows
                '             n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                '             M1 = M1 + 1
                '         Next
                x_DATE = X_DATE1

            Next

            '  N_TOTALHR = MC_Count * 24 * 60 '* MC_Count
            ' n_per = n_per / N_TOTALHR

            Dim B1 As Double
            Dim B2 As Double
            B2 = 0
            If MC_Count > 0 Then
                N_TOTALHR = MC_Count * 24 * 60 '* L_DateofMonth
                n_per = n_per / N_TOTALHR

             
                B2 = 0
                B1 = 1 - n_per
                B1 = MC_Count * B1
                ' M_Total = M_Total / L_DateofMonth
                B2 = M_Total / B1

                worksheet11.Cells(X, Y3) = B2
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y3)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 176, 80)
                worksheet11.Cells(X, Y3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            'B1 = 1 - n_per
            'B1 = MC_Count * B1
            'M_Total = M_Total / 7
            'B2 = M_Total / B1

            'worksheet11.Cells(X, Y) = B2
            '' worksheet11.Cells(X, 1).WrapText = True


            'range1 = worksheet11.Cells(X, Y)
            'range1.NumberFormat = "0.0"
            'range1.Font.Color = RGB(0, 176, 80)
            'worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            i = i + 1
            Y = Y + 1
            Y3 = Y3 + 1
        Next

        _String = "A7:A7"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "7" & ":A" & Chr(a - 26) & "7"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                Else
                    ' _String = "B" & Chr(a - 52) & "7" & ":B" & Chr(a - 52) & "7"
                    If i + 1 = 27 Then
                        _String = "AA7:Aa7"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab7:Ab7"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac7:Ac7"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad7:Ad7"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae7:Ae7"
                    ElseIf i + 1 = 32 Then
                        _String = "Af7:Af7"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag7:Ag7"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah7:Ah7"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai7:Ai7"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj7:Aj7"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak7:Ak7"
                    ElseIf i + 1 = 38 Then
                        _String = "AL7:AL7"
                    ElseIf i + 1 = 39 Then
                        _String = "AM7:AM7"
                    ElseIf i + 1 = 40 Then
                        _String = "AN7:AN7"
                    ElseIf i + 1 = 41 Then
                        _String = "AO7:AO7"
                    ElseIf i + 1 = 42 Then
                        _String = "AP7:AP7"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ7:AQ7"
                    ElseIf i + 1 = 44 Then
                        _String = "AR7:AR7"
                    ElseIf i + 1 = 45 Then
                        _String = "AS7:AS7"
                    ElseIf i + 1 = 46 Then
                        _String = "AT7:AT7"
                    ElseIf i + 1 = 47 Then
                        _String = "AU7:AV7"
                    ElseIf i + 1 = 48 Then
                        _String = "AV7:AV7"
                    ElseIf i + 1 = 49 Then
                        _String = "AW7:AW7"
                    ElseIf i + 1 = 50 Then
                        _String = "AX7:AX7"
                    ElseIf i + 1 = 51 Then
                        _String = "AY7:AY7"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ7:AZ7"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "7" & ":" & Chr(a) & "7"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                a = a + 1
            End If

        Next
        '-------------------------------------------------------------------------------------------------
        Dim r As Integer
        Dim rh As Double
        rh = 0
        'For r = 1 To X
        '    worksheet11.Range("B" & r).Select()
        '    MsgBox((worksheet11.Rows("1:" & r).RowHeight()))
        '    rh = rh + (worksheet11.Rows("1:" & r).RowHeight())

        'Next r
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet11.ChartObjects

        Dim _Chartlocation As Integer

        rh = (15 * 3) + (30.25 * 4)
        _Chartlocation = (X + 10) * 10

        myChart = xlCharts.Add(10, rh, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1

        i = 0
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
               "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        a = 66
        If isValidDataset(T01) Then
            For i = 1 To T01.Tables(0).Rows.Count

                If a > 90 Then

                    If (a - 25) > 90 Then
                        _String = Chr(a - 26)

                        a = a + 1
                    Else
                        If i = 26 Then
                            _String = "AA"
                        ElseIf i = 27 Then
                            _String = "AB"
                        ElseIf i = 28 Then
                            _String = "AC"
                        ElseIf i = 29 Then
                            _String = "AD"
                        ElseIf i = 30 Then
                            _String = "AE"
                        ElseIf i = 31 Then

                            _String = "AF"
                        ElseIf i = 32 Then
                            _String = "AG"
                        ElseIf i = 33 Then
                            _String = "AH"
                        ElseIf i = 34 Then
                            _String = "AI"
                        ElseIf i = 35 Then
                            _String = "AJ"
                        ElseIf i = 36 Then
                            _String = "AK"
                        ElseIf i = 37 Then
                            _String = "AL"
                        ElseIf i = 38 Then
                            _String = "AM"
                        ElseIf i = 39 Then
                            _String = "AN"
                        ElseIf i = 40 Then
                            _String = "AO"
                        ElseIf i = 41 Then
                            _String = "AP"
                        ElseIf i = 42 Then
                            _String = "AQ"
                        ElseIf i = 43 Then
                            _String = "AR"
                        ElseIf i = 44 Then
                            _String = "AS"
                        ElseIf i = 45 Then
                            _String = "AT"
                        ElseIf i = 46 Then
                            _String = "AU"
                        ElseIf i = 47 Then
                            _String = "AV"
                        ElseIf i = 48 Then
                            _String = "AW"
                        ElseIf i = 49 Then
                            _String = "AX"
                        ElseIf i = 50 Then
                            _String = "AY"
                        ElseIf i = 51 Then
                            _String = "AZ"
                        ElseIf i = 52 Then
                            _String = "BA"
                        ElseIf i = 53 Then
                            _String = "BB"
                        ElseIf i = 54 Then
                            _String = "BC"



                        End If
                        ' _String = "B" & Chr(a - 52)
                        a = a + 1
                    End If
                Else
                    _String = Chr(a)

                    a = a + 1
                End If

            Next

            chartRange = worksheet11.Range("B4", _String & "4")
            chartRange1 = worksheet11.Range("b3", _String & "3")
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day  without any delay "
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            chartRange = worksheet11.Range("b5", _String & "5")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non Bio -polish batches per day per machine "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            chartRange = worksheet11.Range("b6", _String & "6")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine


            chartRange = worksheet11.Range("b7", _String & "7")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day( Bio-polish + Non bio-polish)  "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 0, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If
    End Function


    Function Batch_perMonthAF()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer
        Dim _cOUNT As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches per day -Monthly  (AF)"

        worksheet11.Columns("A").ColumnWidth = 45
        'worksheet11.Columns("B").ColumnWidth = 10
        'worksheet11.Columns("C").ColumnWidth = 10
        'worksheet11.Columns("D").ColumnWidth = 10
        'worksheet11.Columns("E").ColumnWidth = 10
        'worksheet11.Columns("F").ColumnWidth = 10
        'worksheet11.Columns("G").ColumnWidth = 10
        'worksheet11.Columns("H").ColumnWidth = 10
        'worksheet11.Columns("I").ColumnWidth = 20
        ''worksheet11.Columns("J").ColumnWidth = 13

        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"


        Dim X As Integer
        Dim L_DateofMonth As Integer

        X = 2
        i = 0
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            ' N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet11.Cells(3, X) = MonthName(T01.Tables(0).Rows(i)("T01month"), True) & "-" & T01.Tables(0).Rows(i)("EYear")

            ' worksheet11.Cells(3, X) = T01.Tables(0).Rows(i)("ddate")
            'worksheet11.Cells(3, X).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Cells(3, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet11.Range(3, X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            X = X + 1
            i = i + 1
        Next
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Interior.Color = RGB(165, 165, 165)
        Dim _String As String

        _String = "B3:B3"
        Dim a As String
        a = 66

        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "3" & ":A" & Chr(a - 26) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "3" & ":B" & Chr(a - 52) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "3" & ":" & Chr(a) & "3"
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                a = a + 1
            End If




        Next
        worksheet11.Cells(4, 1) = "No of batches per day  without any delay                                           (Non bio-polish batches)"
        worksheet11.Cells(4, 1).WrapText = True
        '  worksheet11.Rows(4).rowheight = 20.25


        'NO OF BATCHES
        Dim _STD As Double
        Dim x_DATE As Date
        Dim X_DATE1 As Date

        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        Dim y2 As Integer

        X = 4
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime) , Month(m04Etime) order by year(m04Etime) , Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            WeekEnddate = CDate(WeekStartdate1).AddDays(+L_DateofMonth)
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            ' WeekEnddate = WeekEnddate & " " & "7:30AM"

       

            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            For y2 = 1 To L_DateofMonth

                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                x_DATE = X_DATE1

            Next
            ' _STD = _STD / 60
            _STD = _STD / _cOUNT
            _STD = _STD / 60
            If _STD > 0 Then
                worksheet11.Cells(X, Y) = _STD
                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y) = 24 / _STD
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Else
                _STD = 0
                worksheet11.Cells(X, Y) = ""
                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If

            Y = Y + 1
            i = i + 1
        Next
        '--------------------------------------------------------------------------------------
        _String = "A4:A4"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "4" & ":A" & Chr(a - 26) & "4"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "4" & ":B" & Chr(a - 52) & "4"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "4" & ":" & Chr(a) & "4"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                a = a + 1
            End If




        Next

        '------------------------------------------------------------------------------------------
        worksheet11.Cells(5, 1) = "Non Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(5).rowheight = 30.25
        'NON BIO POLISH


        Dim N_TOTALHR As Integer


        Dim n_Taken As Double
        Dim n_Count As Integer
        Dim M1 As Integer

        Y = 2
        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 5
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
         

            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If

                M1 = 0
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)


                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                'n_Taken = n_Taken / 60
                'n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                'n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                'N_TOTALHR = 9 * 24 * 60
                'n_per = n_per / N_TOTALHR
                'n_per = n_per * 216
                'n_per = n_per / 9
                ''-----------------------------------------------------
                ''Fabric
                'n_Taken = n_Taken + n_per
                'n_Taken = 24 - n_Taken

                '_STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                ' Y = Y + 1
                x_DATE = X_DATE1
            Next

            n_Taken = n_Taken / 60
            n_Taken = n_Taken / 9

            N_TOTALHR = 9 * 24 * 60
            n_per = n_per / N_TOTALHR
            n_per = n_per * 216
            n_per = n_per / 9
            n_per = n_per / L_DateofMonth
            n_Taken = n_Taken / L_DateofMonth
            '-----------------------------------------------------
            'Fabric
            n_Taken = n_Taken + n_per
            n_Taken = 24 - n_Taken


            _STD = _STD / 60
            _STD = _STD / _cOUNT

            If _STD > 0 Then
                worksheet11.Cells(X, Y) = n_Taken / _STD
            Else
                worksheet11.Cells(X, Y) = ""
            End If
            ' worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, Y)
            range1.NumberFormat = "0.0"
            range1.Font.Color = RGB(0, 0, 255)
            worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            Y = Y + 1
            i = i + 1

        Next



        _String = "A5:A5"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "5" & ":A" & Chr(a - 26) & "5"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "5" & ":B" & Chr(a - 52) & "5"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "5" & ":" & Chr(a) & "5"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                a = a + 1
            End If




        Next

        '-------------------------------------------------------------------------------------
        worksheet11.Cells(6, 1) = "Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(6).rowheight = 30.25
        'NON BIO POLISH


        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 6
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount  FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            WeekEnddate = CDate(WeekStartdate1).AddDays(+L_DateofMonth)
            'WeekStartdate1 = WeekStartdate & " " & "7:30AM"
            ' WeekEnddate = WeekEnddate & " " & "7:30AM"
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            x_DATE = WeekStartdate1
            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                '  n_Count = 0
                ' n_Taken = 0
                M1 = 0
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next

                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                '  n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1

                '  _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                'Y = Y + 1
                x_DATE = X_DATE1
            Next

            n_Taken = n_Taken / 60
            n_Taken = n_Taken / 9

            N_TOTALHR = 9 * 24 * 60
            n_per = n_per / N_TOTALHR
            n_per = n_per * 216
            n_per = n_per / 9
            n_Taken = n_Taken / L_DateofMonth
            n_per = n_per / L_DateofMonth
            '-----------------------------------------------------
            'Fabric
            n_Taken = n_Taken + n_per
            n_Taken = 24 - n_Taken

            _STD = _STD / 60
            _STD = _STD / _cOUNT

            If _STD > 0 Then
                worksheet11.Cells(X, Y) = n_Taken / _STD
            Else
                worksheet11.Cells(X, Y) = ""
                ' worksheet11.Cells(X, 1).WrapText = True
            End If

            range1 = worksheet11.Cells(X, Y)
            range1.NumberFormat = "0.0"
            range1.Font.Color = RGB(255, 0, 0)
            worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            i = i + 1
            Y = Y + 1
        Next

        _String = "A6:A6"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "6" & ":A" & Chr(a - 26) & "6"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "6" & ":B" & Chr(a - 52) & "6"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "6" & ":" & Chr(a) & "6"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                a = a + 1
            End If

        Next
        '--------------------------------------------------------------------------
        'No of batches per day( Bio-polish + Non bio-polish)  
        i = 0
        Y = 2
        worksheet11.Cells(7, 1) = "No of batches per day( Bio-polish + Non bio-polish)  "
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(7).rowheight = 30.25
        '  Dim y1 As Integer
        ' Dim y2 As Integer
        Dim M_Total As Double
        Dim Y3 As Integer
        Y3 = 2
        X = 7
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            WeekEnddate = CDate(WeekStartdate1).AddDays(+L_DateofMonth)
            'WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"

            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0
            M_Total = 0
            x_DATE = WeekStartdate1
            Dim MC_Count As Integer
            MC_Count = 0
            Dim H1 As Integer

            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                M1 = 0
                '         SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                '         "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE T03TYPE IN ('02') and " & _
                ' " M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 " & _
                '"group by T03code"
                '         T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                '         For Each DTRow1 As DataRow In T04.Tables(0).Rows

                '             M_Total = M_Total + T04.Tables(0).Rows(M1)("T03Name")
                '             M1 = M1 + 1
                '         Next

                '         '------------------------------------------------------------------------
                '         M1 = 0
                '         SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('No Work','PM','MainM') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                '         T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                '         For Each DTRow1 As DataRow In T03.Tables(0).Rows
                '             n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                '             M1 = M1 + 1
                '         Next

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
"  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
" M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
"group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    M_Total = M_Total + T04.Tables(0).Rows(H1)("T03Name")
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='02' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow1 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                x_DATE = X_DATE1

            Next

            'N_TOTALHR = 9 * 24 * 60 * L_DateofMonth
            'n_per = n_per / N_TOTALHR

            'Dim B1 As Double
            'Dim B2 As Double
            'B2 = 0
            'B1 = 1 - n_per
            'B1 = 9 * B1
            'M_Total = M_Total / L_DateofMonth
            'B2 = M_Total / B1

            'worksheet11.Cells(X, Y) = B2
            '' worksheet11.Cells(X, 1).WrapText = True


            'range1 = worksheet11.Cells(X, Y)
            'range1.NumberFormat = "0.0"
            'range1.Font.Color = RGB(0, 176, 80)
            'worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            If MC_Count > 0 Then
                N_TOTALHR = MC_Count * 24 * 60 '* L_DateofMonth
                n_per = n_per / N_TOTALHR

                Dim B1 As Double
                Dim B2 As Double
                B2 = 0
                B1 = 1 - n_per
                B1 = MC_Count * B1
                ' M_Total = M_Total / L_DateofMonth
                B2 = M_Total / B1

                worksheet11.Cells(X, Y3) = B2
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y3)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 176, 80)
                worksheet11.Cells(X, Y3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            i = i + 1
            Y3 = Y3 + 1
        Next

        _String = "A7:A7"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "7" & ":A" & Chr(a - 26) & "7"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "7" & ":B" & Chr(a - 52) & "7"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "7" & ":" & Chr(a) & "7"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                a = a + 1
            End If

        Next
        '-------------------------------------------------------------------------------------------------
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet11.ChartObjects

        Dim _Chartlocation As Integer

        _Chartlocation = (X + 10) * 10

        myChart = xlCharts.Add(10, _Chartlocation, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1

        i = 0
        'SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '       "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"


  
        ' X = 2
        i = 0
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        a = 66
        If isValidDataset(T01) Then
            For i = 1 To T01.Tables(0).Rows.Count

                If a > 90 Then

                    If (a - 25) > 90 Then
                        _String = Chr(a - 26)

                        a = a + 1
                    Else
                        _String = "B" & Chr(a - 52)
                        a = a + 1
                    End If
                Else
                    _String = Chr(a)

                    a = a + 1
                End If

            Next

            chartRange = worksheet11.Range("B4", _String & "4")
            chartRange1 = worksheet11.Range("b3", _String & "3")
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day  without any delay "
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            chartRange = worksheet11.Range("b5", _String & "5")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non Bio -polish batches per day per machine "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            chartRange = worksheet11.Range("b6", _String & "6")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine


            chartRange = worksheet11.Range("b7", _String & "7")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day( Bio-polish + Non bio-polish)  "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 0, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If
    End Function

    Function Batch_perDayWJ()
        Dim U_Count As Integer
        Dim MC_Count As Integer
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches Per Day - Daily (WJ)"

        'worksheet11.Columns("A").ColumnWidth = 24
        'worksheet11.Columns("B").ColumnWidth = 10
        'worksheet11.Columns("C").ColumnWidth = 10
        'worksheet11.Columns("D").ColumnWidth = 10
        'worksheet11.Columns("E").ColumnWidth = 10
        'worksheet11.Columns("F").ColumnWidth = 10
        'worksheet11.Columns("G").ColumnWidth = 10
        'worksheet11.Columns("H").ColumnWidth = 10
        'worksheet11.Columns("I").ColumnWidth = 20
        'worksheet11.Columns("J").ColumnWidth = 13

        n_Date = txtFromDate.Value
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & N_Date1 & "' and '" & n_Date & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        If isValidDataset(T01) Then
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If


            worksheet11.Cells(2, 1) = "Week   " & T01.Tables(0).Rows(0)("M04Week") & "   Water Jet  batches per machine per day (colours)  "
            worksheet11.Rows(2).Font.Bold = True
            worksheet11.Rows(2).Font.size = 14


            worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(1, 9)).Merge()
            worksheet11.Cells(1, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            worksheet11.Cells(3, 1) = "COLOUR"
            worksheet11.Rows(3).Font.Bold = True
            range1 = worksheet11.Cells(3, 1)
            range1.Font.Color = RGB(255, 0, 0)

            worksheet11.Cells(4, 1) = ""
            worksheet11.Rows(4).Font.Bold = True
            worksheet11.Rows(4).Font.size = 12
            worksheet11.Cells(4, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Dim X As Integer
            Dim x_Date As Date

            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate)
                L_DateofMonth = diff1.Days
                ' If L_DateofMonth = 1 Then
                'Else
                L_DateofMonth = L_DateofMonth + 1
                ' End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            ' worksheet11.Rows(2).Select()
            If L_DateofMonth = 7 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 10
                worksheet11.Columns("G").ColumnWidth = 10
                worksheet11.Columns("H").ColumnWidth = 10
                worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 10
                worksheet11.Columns("G").ColumnWidth = 10
                worksheet11.Columns("H").ColumnWidth = 20
                '  worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 10
                worksheet11.Columns("G").ColumnWidth = 20
                '  worksheet11.Columns("H").ColumnWidth = 10
                ' worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 20
                '  worksheet11.Columns("G").ColumnWidth = 10
                ' worksheet11.Columns("H").ColumnWidth = 10
                'worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 20
                'worksheet11.Columns("F").ColumnWidth = 10
                'worksheet11.Columns("G").ColumnWidth = 10
                'worksheet11.Columns("H").ColumnWidth = 10
                'worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 20
                'worksheet11.Columns("E").ColumnWidth = 10
                'worksheet11.Columns("F").ColumnWidth = 10
                'worksheet11.Columns("G").ColumnWidth = 10
                'worksheet11.Columns("H").ColumnWidth = 10
                'worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 20

            End If

            ' worksheet11.Rows(2).Font.size = 14
            Dim X_Date1 As Date
            X = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date '& '" " & "7:30AM"
                    X_Date1 = X_Date1 '& " " & "7:30AM"
                End If
                worksheet11.Cells(4, X) = x_Date
                worksheet11.Cells(4, X).EntireColumn.NumberFormat = "dd-MMM"
                worksheet11.Cells(4, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                x_Date = X_Date1
                X = X + 1
            Next

            worksheet11.Cells(4, X) = "No. of batches/daily"


            '------------------------------------------------------------------------------------------
            If L_DateofMonth = 7 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                ' worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                '   worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            End If

            worksheet11.Rows(4).Select()
            worksheet11.Application.ActiveWindow.FreezePanes = True
            '---------------------------------------------------------------------------------------------------------
            'worksheet11.Range("A3, A3").Interior.Color = RGB(215, 228, 188)
            'worksheet11.Range("b3, b3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("c3, c3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("d3, d3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("e3, e3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("f3, f3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("g3, g3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("h3, h3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("i3, i3").Interior.Color = RGB(219, 238, 243)

            X = 5

            Dim Y1 As Integer
            Dim Z As Integer
            'Dim X_Date1 As Date

            i = 0
            SQL = "SELECT T03Code,T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
           " M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType in ('N','R','S')  and m08CL='Colour'" & _
          "group by T03Name,T03code"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In dsUser.Tables(0).Rows
                worksheet11.Cells(X, 1) = dsUser.Tables(0).Rows(i)("T03Name")
                x_Date = WeekStartdate
                Y1 = 2
                Y = 2
                For Y1 = 1 To L_DateofMonth
                    X_Date1 = CDate(x_Date).AddDays(+1)
                    If Y1 = 1 Then
                        ' x_Date = x_Date & " " & "7:30 AM"
                        x_Date = x_Date & " " & "7:30AM"
                        X_Date1 = X_Date1 & " " & "7:30AM"
                    End If
                    SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
           " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S') and  T03code='" & dsUser.Tables(0).Rows(i)("T03code") & "'  and M04Batchwt>0 and m08CL='Colour' " & _
          "group by T03code"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T04) Then
                        range1 = worksheet11.Cells(X, Y)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X, Y) = T04.Tables(0).Rows(0)("T03Name")
                    Else
                        '  worksheet11.Cells(X, Y) = "0"
                    End If
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    x_Date = X_Date1
                    Y = Y + 1

                Next
                If L_DateofMonth = 7 Then
                    worksheet11.Range("I" & (X)).Formula = "=SUM(b" & X & ":H" & X & ")"
                ElseIf L_DateofMonth = 6 Then
                    worksheet11.Range("H" & (X)).Formula = "=SUM(b" & X & ":G" & X & ")"
                ElseIf L_DateofMonth = 5 Then
                    worksheet11.Range("G" & (X)).Formula = "=SUM(b" & X & ":F" & X & ")"
                ElseIf L_DateofMonth = 4 Then
                    worksheet11.Range("F" & (X)).Formula = "=SUM(b" & X & ":E" & X & ")"
                ElseIf L_DateofMonth = 3 Then
                    worksheet11.Range("E" & (X)).Formula = "=SUM(b" & X & ":D" & X & ")"
                ElseIf L_DateofMonth = 2 Then
                    worksheet11.Range("D" & (X)).Formula = "=SUM(b" & X & ":C" & X & ")"
                ElseIf L_DateofMonth = 1 Then
                    worksheet11.Range("C" & (X)).Formula = "=SUM(b" & X & ":b" & X & ")"
                End If
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                If L_DateofMonth = 7 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 6 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 5 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 4 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 3 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 2 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                ElseIf L_DateofMonth = 1 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                End If
                X = X + 1
                i = i + 1
            Next
            worksheet11.Cells(X, 1) = "Total"
            worksheet11.Rows(X).Font.Bold = True
            Y = 2
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0"
            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g5:g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(h5:h" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g5:g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            End If
            '--------------------------------------------------------------------------------------------------------------------------
            X = X + 1
            worksheet11.Cells(X, 1) = "No. of batches (with out no work)"
            worksheet11.Cells(X, 1).WrapText = True
            U_Count = X
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0.0"
            '----------------------------------------------------------------------------------------
            worksheet11.Cells(X + 1, 1) = "No work  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            ' range1 = worksheet11.Cells(X, 2)
            'range1.NumberFormat = "0%"

            i = 0
            Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                ' Dim MC_Count As Integer
                Dim H1 As Integer
                MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type,M05Name" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                x_Date = X_Date1
                If n_per > 0 Then
                    N_TOTALHR = MC_Count * 24 * 60
                    n_per = n_per / N_TOTALHR

                    Dim B1 As Double
                    Dim B2 As Double
                    B2 = 0
                    B1 = 1 - n_per
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 1 & ":B" & X - 1 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                        worksheet11.Cells(X + 1, 2) = n_per

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 1 & ":c" & X - 1 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, 3) = n_per

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 1 & ":D" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 1 & ":E" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 1 & ":F" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 1 & ":G" & X - 1 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 1 & ":H" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                    B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                    ' B1 = 1 - B1
                    B1 = MC_Count * B1
                    B2 = B2 / B1
                    'B2 = worksheet11.Cells(X, 2)
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1) = B2
                Else
                    worksheet11.Cells(X, Y1) = "0"
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"

                    worksheet11.Cells(X + 1, Y1) = "0"

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 9)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 1) & ":G" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 8)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 8) = "=AVERAGE(b" & (X + 1) & ":g" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 1) & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 7)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 7) = "=AVERAGE(b" & (X + 1) & ":f" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 1) & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 6)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 6) = "=AVERAGE(b" & (X + 1) & ":e" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 1) & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 5)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 5) = "=AVERAGE(b" & (X + 1) & ":d" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 1) & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 4)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 4) = "=AVERAGE(b" & (X + 1) & ":c" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 1) & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 3)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 3) = "=AVERAGE(b" & (X + 1) & ":b" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            Dim _Count As Double
            Dim _nCount As Integer
            _Count = 0
            If L_DateofMonth = 7 Then
                _Count = (worksheet11.Cells(X, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                _Count = (worksheet11.Cells(X, 8).Value.ToString)


            ElseIf L_DateofMonth = 5 Then
                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If
            _nCount = 0
            Y = 2
            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0
            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 4).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 4).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 3).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 3).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0.0"
            End If

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous




            End If
            X = X + 1
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous




            End If
            X = X + 1
            '---------------------------------------------------------------------------------------
            worksheet11.Cells(X, 1) = "No. of batches(with out No work + M/main)"
            worksheet11.Cells(X, 1).WrapText = True

            worksheet11.Cells(X + 1, 1) = " No work + M/main  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            i = 0
            ' Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2


            i = 0
            '  Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type,M05Name" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                Y = 0

                x_Date = X_Date1
                If n_per > 0 Then
                    N_TOTALHR = MC_Count * 24 * 60
                    n_per = n_per / N_TOTALHR

                    Dim B1 As Double
                    Dim B2 As Double
                    B2 = 0
                    B1 = 1 - n_per
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 3 & ":B" & X - 3 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 2)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X + 1, 2) = n_per

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 3 & ":c" & X - 3 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0"

                        worksheet11.Cells(X + 1, 3) = n_per

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 3 & ":D" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 3 & ":E" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 3 & ":F" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 3 & ":G" & X - 3 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 3 & ":H" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                    B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                    ' B1 = 1 - B1
                    B1 = MC_Count * B1
                    B2 = B2 / B1
                    'B2 = worksheet11.Cells(X, 2)
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1) = B2
                Else
                    worksheet11.Cells(X, Y1) = "0"
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter

                    worksheet11.Cells(X + 1, Y1) = "0"
                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 3) & ":h" & (X - 3) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 9)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 3) & ":g" & (X - 3) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 8)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 8) = "=AVERAGE(b" & (X + 1) & ":g" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 8).Value.ToString)
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 3) & ":f" & (X - 3) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 7)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 7) = "=AVERAGE(b" & (X + 1) & ":f" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 3) & ":e" & (X - 3) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 6)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 6) = "=AVERAGE(b" & (X + 1) & ":e" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 3) & ":d" & (X - 3) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 5)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 5) = "=AVERAGE(b" & (X + 1) & ":d" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 3) & ":c" & (X - 3) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 4)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 4) = "=AVERAGE(b" & (X + 1) & ":c" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 3) & ":b" & (X - 3) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 3)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 3) = "=AVERAGE(b" & (X + 1) & ":b" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If
            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 4).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 4).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 3).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 3).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0.0"
            End If

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(146, 208, 80)
            End If
            X = X + 1

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous




            End If

            X = X + 3
            '------------------------------------------------------------------------------
            'WHITE



            worksheet11.Cells(X, 1) = "WHITE"
            worksheet11.Rows(X).Font.Bold = True
            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(255, 0, 0)

            worksheet11.Cells(X + 1, 1) = ""
            worksheet11.Rows(X + 1).Font.Bold = True
            worksheet11.Rows(X + 1).Font.size = 12
            worksheet11.Cells(X + 1, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'Dim X As Integer
            'Dim x_Date As Date



            ' worksheet11.Rows(2).Font.size = 14
            Dim X1 As Integer
            X = X + 1
            X1 = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                worksheet11.Cells(X, X1) = x_Date
                worksheet11.Cells(X, X1).EntireROW.NumberFormat = "dd-MMM"
                worksheet11.Cells(X, X1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                x_Date = CDate(x_Date).AddDays(+1)
                X1 = X1 + 1
            Next

            worksheet11.Cells(X, X1) = "No. of batches/daily"

            '  X = X + 1
            '------------------------------------------------------------------------------------------
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            End If
            '---------------------------------------------------------------------------------------------------------


            X = X + 1
            X1 = X
            'Dim Y1 As Integer
            'Dim Z As Integer
            'Dim X_Date1 As Date

            i = 0
            SQL = "SELECT T03Code,T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
           " M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType in ('N','R','S')  and m08CL='White'" & _
          "group by T03Name,T03code"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In dsUser.Tables(0).Rows
                worksheet11.Cells(X, 1) = dsUser.Tables(0).Rows(i)("T03Name")
                x_Date = WeekStartdate
                Y1 = 2
                Y = 2
                For Y1 = 1 To L_DateofMonth
                    X_Date1 = CDate(x_Date).AddDays(+1)
                    If Y1 = 1 Then
                        ' x_Date = x_Date & " " & "7:30 AM"
                        x_Date = x_Date & " " & "7:30AM"
                        X_Date1 = X_Date1 & " " & "7:30AM"
                    End If
                    SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
           " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S') and  T03code='" & dsUser.Tables(0).Rows(i)("T03code") & "'  and M04Batchwt>0 and m08CL='White' " & _
          "group by T03code"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T04) Then
                        range1 = worksheet11.Cells(X, Y)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X, Y) = T04.Tables(0).Rows(0)("T03Name")
                    Else
                        worksheet11.Cells(X, Y) = "0"
                    End If
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    x_Date = X_Date1
                    Y = Y + 1

                Next
                If L_DateofMonth = 7 Then
                    worksheet11.Range("I" & (X)).Formula = "=SUM(b" & X & ":H" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 6 Then
                    worksheet11.Range("h" & (X)).Formula = "=SUM(b" & X & ":g" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 5 Then
                    worksheet11.Range("g" & (X)).Formula = "=SUM(b" & X & ":f" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 4 Then
                    worksheet11.Range("f" & (X)).Formula = "=SUM(b" & X & ":e" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 3 Then
                    worksheet11.Range("e" & (X)).Formula = "=SUM(b" & X & ":d" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 2 Then
                    worksheet11.Range("d" & (X)).Formula = "=SUM(b" & X & ":c" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 1 Then
                    worksheet11.Range("c" & (X)).Formula = "=SUM(b" & X & ":b" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                End If
                X = X + 1
                i = i + 1
            Next
            worksheet11.Cells(X, 1) = "Total"
            worksheet11.Rows(X).Font.Bold = True
            Y = 2
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0"

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f" & X1 & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g" & X1 & ":g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(h" & X1 & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f" & X1 & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g" & X1 & ":g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f" & X1 & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter


            End If
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            End If
            '--------------------------------------------------------------------------------------------------------------------------
            X = X + 1
            worksheet11.Cells(X, 1) = "No. of batches (with out no work)"
            worksheet11.Cells(X, 1).WrapText = True

            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0.0"
            '----------------------------------------------------------------------------------------
            worksheet11.Cells(X + 1, 1) = "No work  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            ' range1 = worksheet11.Cells(X, 2)
            'range1.NumberFormat = "0%"

            i = 0
            ' Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                Dim H1 As Integer
                MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='WHITE' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                x_Date = X_Date1
                If n_per > 0 Then
                    N_TOTALHR = MC_Count * 24 * 60
                    n_per = n_per / N_TOTALHR

                    Dim B1 As Double
                    Dim B2 As Double
                    B2 = 0
                    B1 = 1 - n_per
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 1 & ":B" & X - 1 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                        worksheet11.Cells(X + 1, 2) = n_per

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 1 & ":c" & X - 1 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, 3) = n_per

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 1 & ":D" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 1 & ":E" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 1 & ":F" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 1 & ":G" & X - 1 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 1 & ":H" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                    B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                    ' B1 = 1 - B1
                    B1 = MC_Count * B1
                    B2 = B2 / B1
                    'B2 = worksheet11.Cells(X, 2)
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1) = B2
                Else
                    worksheet11.Cells(X, Y1) = "0"

                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter

                    worksheet11.Cells(X + 1, Y1) = "0"

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 9)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 1) & ":g" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 8)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 8) = "=AVERAGE(b" & (X + 1) & ":g" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 8).Value.ToString)
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 1) & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 7)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 7) = "=AVERAGE(b" & (X + 1) & ":f" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 1) & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 6)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 6) = "=AVERAGE(b" & (X + 1) & ":e" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 5)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 5) = "=AVERAGE(b" & (X + 1) & ":d" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 1) & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 4)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 4) = "=AVERAGE(b" & (X + 1) & ":c" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 1) & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 3)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 3) = "=AVERAGE(b" & (X + 1) & ":b" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If

            _nCount = 0
            Y = 2

            Y = 0
            n_per = 0

            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='WHITE' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 4).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 4).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 3).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 3).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0.0"
            End If




            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 5 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            End If
            X = X + 1

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 5 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            End If

            X = X + 1
            '---------------------------------------------------------------------------------------
            worksheet11.Cells(X, 1) = "No. of batches(with out No work + M/main)"
            worksheet11.Cells(X, 1).WrapText = True

            worksheet11.Cells(X + 1, 1) = " No work + M/main  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            i = 0
            ' Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2


            i = 0
            '  Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                '  Dim MC_Count As Integer
                Dim H1 As Integer
                MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='WHITE' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                Y = 0

                x_Date = X_Date1
                If n_per > 0 Then
                    N_TOTALHR = MC_Count * 24 * 60
                    n_per = n_per / N_TOTALHR

                    Dim B1 As Double
                    Dim B2 As Double
                    B2 = 0
                    B1 = 1 - n_per
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 3 & ":B" & X - 3 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 2)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X + 1, 2) = n_per

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 3 & ":c" & X - 3 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0"

                        worksheet11.Cells(X + 1, 3) = n_per

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 3 & ":D" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 3 & ":E" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 3 & ":F" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 3 & ":G" & X - 3 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 3 & ":H" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                    B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                    ' B1 = 1 - B1
                    B1 = MC_Count * B1
                    B2 = B2 / B1
                    'B2 = worksheet11.Cells(X, 2)
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1) = B2
                Else
                    worksheet11.Cells(X, Y1) = "0"

                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter

                    worksheet11.Cells(X + 1, Y1) = "0"

                    range1 = worksheet11.Cells(X + 1, Y1)
                    range1.NumberFormat = "0%"
                    worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 3) & ":h" & (X - 3) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 9)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 3) & ":g" & (X - 3) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 8)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 8) = "=AVERAGE(b" & (X + 1) & ":g" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 8).Value.ToString)
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 3) & ":f" & (X - 3) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 7)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 7) = "=AVERAGE(b" & (X + 1) & ":f" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 3) & ":e" & (X - 3) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 6)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 6) = "=AVERAGE(b" & (X + 1) & ":e" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 3) & ":d" & (X - 3) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 5)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 5) = "=AVERAGE(b" & (X + 1) & ":d" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 3) & ":c" & (X - 3) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 4)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 4) = "=AVERAGE(b" & (X + 1) & ":c" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 3) & ":b" & (X - 3) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 3)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 3) = "=AVERAGE(b" & (X + 1) & ":b" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If
            _nCount = 0
            Y = 2

            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='WHITE' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"

            End If
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous




                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(146, 208, 80)
            End If
            X = X + 1

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 5 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 4 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous




            End If

            X = X + 3
            '------------------------------------------------------------------------------
            'YARN AND MAL
            worksheet11.Cells(X, 1) = "YARN & MAL"
            worksheet11.Rows(X).Font.Bold = True
            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(255, 0, 0)

            worksheet11.Cells(X + 1, 1) = ""
            worksheet11.Rows(X + 1).Font.Bold = True
            worksheet11.Rows(X + 1).Font.size = 12
            worksheet11.Cells(X + 1, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'Dim X As Integer
            'Dim x_Date As Date



            ' worksheet11.Rows(2).Font.size = 14
            ' Dim X1 As Integer
            X = X + 1
            X1 = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                worksheet11.Cells(X, X1) = x_Date
                worksheet11.Cells(X, X1).EntireROW.NumberFormat = "dd-MMM"
                worksheet11.Cells(X, X1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                x_Date = CDate(x_Date).AddDays(+1)
                X1 = X1 + 1
            Next

            worksheet11.Cells(X, X1) = "No. of batches/daily"

            '  X = X + 1
            '------------------------------------------------------------------------------------------
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous



                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":D" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                worksheet11.Range("A" & X & ":A" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            End If
            '---------------------------------------------------------------------------------------------------------


            X = X + 1
            X1 = X
            'Dim Y1 As Integer
            'Dim Z As Integer
            'Dim X_Date1 As Date
            WeekStartdate = WeekStartdate & " " & "7:30AM"

            WeekEnddate = CDate(WeekStartdate).AddDays(+6)
            '  WeekEnddate = WeekEnddate & " " & "7:30AM"

            i = 0
            SQL = "SELECT T03Code,T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
           " M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType in ('N','R','S')  and m08CL='MARL & Yarn dye'" & _
          "group by T03Name,T03code"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In dsUser.Tables(0).Rows
                worksheet11.Cells(X, 1) = dsUser.Tables(0).Rows(i)("T03Name")
                x_Date = WeekStartdate
                Y1 = 2
                Y = 2
                For Y1 = 1 To L_DateofMonth
                    X_Date1 = CDate(x_Date).AddDays(+1)
                    If Y1 = 1 Then
                        ' x_Date = x_Date & " " & "7:30 AM"
                        ' x_Date = x_Date & " " & "7:30AM"
                        'X_Date1 = X_Date1 & " " & "7:30AM"
                    End If
                    SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
           " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S') and  T03code='" & dsUser.Tables(0).Rows(i)("T03code") & "'  and M04Batchwt>0 and m08CL='MARL & Yarn dye' " & _
          "group by T03code"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T04) Then
                        range1 = worksheet11.Cells(X, Y)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X, Y) = T04.Tables(0).Rows(0)("T03Name")
                    End If
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    x_Date = X_Date1
                    Y = Y + 1

                Next

                If L_DateofMonth = 7 Then
                    worksheet11.Range("I" & (X)).Formula = "=SUM(b" & X & ":H" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 6 Then
                    worksheet11.Range("h" & (X)).Formula = "=SUM(b" & X & ":g" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 5 Then
                    worksheet11.Range("g" & (X)).Formula = "=SUM(b" & X & ":f" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 4 Then
                    worksheet11.Range("f" & (X)).Formula = "=SUM(b" & X & ":e" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 3 Then
                    worksheet11.Range("e" & (X)).Formula = "=SUM(b" & X & ":d" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                ElseIf L_DateofMonth = 2 Then
                    worksheet11.Range("d" & (X)).Formula = "=SUM(b" & X & ":c" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 1 Then
                    worksheet11.Range("c" & (X)).Formula = "=SUM(b" & X & ":b" & X & ")"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                End If
                X = X + 1
                i = i + 1
            Next
            worksheet11.Cells(X, 1) = "Total"
            worksheet11.Rows(X).Font.Bold = True
            Y = 2
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0"

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f" & X1 & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g" & X1 & ":g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(h" & X1 & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f" & X1 & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g" & X1 & ":g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f" & X1 & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e" & X1 & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d" & X1 & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c" & X1 & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 2) = "=SUM(b" & X1 & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter


            End If

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            End If
            '--------------------------------------------------------------------------------------------------------------------------
            X = X + 1
            worksheet11.Cells(X, 1) = "No. of batches "
            worksheet11.Cells(X, 1).WrapText = True

            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0.0"
            '----------------------------------------------------------------------------------------
            '       worksheet11.Cells(X + 1, 1) = "No work  %"
            '      worksheet11.Cells(X + 1, 1).WrapText = True

            ' range1 = worksheet11.Cells(X, 2)
            'range1.NumberFormat = "0%"

            i = 0
            ' Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    ' x_Date = x_Date & " " & "7:30AM"
                    'X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                Dim H1 As Integer
                ' MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='MARL & Yarn dye' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                If MC_Count > 0 Then
                    n_per = (worksheet11.Cells(X - 1, Y1).Value.ToString)
                    worksheet11.Cells(X, Y1) = n_per / MC_Count
                    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                End If
                x_Date = X_Date1
                'N_TOTALHR = MC_Count * 24 * 60
                'n_per = n_per / N_TOTALHR

                Dim B1 As Double
                Dim B2 As Double
                B2 = 0
                ' B1 = 1 - n_per
                'If i = 1 Then
                '    worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 1 & ":B" & X - 1 & ")"
                '    worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                '    'worksheet11.Cells(X + 1, 2) = n_per

                '    'range1 = worksheet11.Cells(X + 1, 2)
                '    'range1.NumberFormat = "0%"
                '    'worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'ElseIf i = 2 Then
                '    worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 1 & ":c" & X - 1 & ") "
                '    worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '    range1 = worksheet11.Cells(X, 3)
                '    range1.NumberFormat = "0.0"

                '    ' worksheet11.Cells(X + 1, 3) = n_per

                '    ' range1 = worksheet11.Cells(X + 1, 3)
                '    ' range1.NumberFormat = "0%"
                '    ' worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'ElseIf i = 3 Then
                '    worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 1 & ":D" & X - 1 & ") "
                '    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '    range1 = worksheet11.Cells(X, 4)
                '    range1.NumberFormat = "0.0"

                '    'worksheet11.Cells(X + 1, Y1) = n_per

                '    'range1 = worksheet11.Cells(X + 1, Y1)
                '    'range1.NumberFormat = "0%"
                '    'worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'ElseIf i = 4 Then
                '    worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 1 & ":E" & X - 1 & ") "
                '    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '    range1 = worksheet11.Cells(X, Y1)
                '    range1.NumberFormat = "0.0"

                '    'worksheet11.Cells(X + 1, Y1) = n_per

                '    '                    range1 = worksheet11.Cells(X + 1, Y1)
                '    '                   range1.NumberFormat = "0%"
                '    '                  worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'ElseIf i = 5 Then
                '    worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 1 & ":F" & X - 1 & ") "
                '    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '    range1 = worksheet11.Cells(X, Y1)
                '    range1.NumberFormat = "0.0"

                '    '                 worksheet11.Cells(X + 1, Y1) = n_per
                '    '
                '    'range1 = worksheet11.Cells(X + 1, Y1)
                '    'range1.NumberFormat = "0%"
                '    'worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'ElseIf i = 6 Then
                '    worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 1 & ":G" & X - 1 & ")"
                '    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '    range1 = worksheet11.Cells(X, Y1)
                '    range1.NumberFormat = "0.0"

                '    'worksheet11.Cells(X + 1, Y1) = n_per

                '    'range1 = worksheet11.Cells(X + 1, Y1)
                '    'range1.NumberFormat = "0%"
                '    'worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'ElseIf i = 7 Then
                '    worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 1 & ":H" & X - 1 & ") "
                '    worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                '    range1 = worksheet11.Cells(X, Y1)
                '    range1.NumberFormat = "0.0"

                '    'worksheet11.Cells(X + 1, Y1) = n_per

                '    'range1 = worksheet11.Cells(X + 1, Y1)
                '    'range1.NumberFormat = "0%"
                '    'worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'End If
                'B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                '' B1 = 1 - B1
                'B1 = MC_Count * B1
                'B2 = B2 / B1
                ''B2 = worksheet11.Cells(X, 2)
                'range1 = worksheet11.Cells(X, Y1)
                'range1.NumberFormat = "0.0"
                'worksheet11.Cells(X, Y1) = B2
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 9).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                'n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 1) & ":g" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 8).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 1) & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 7).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 1) & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 6).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 1) & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 5).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 1) & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 4).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 1) & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                'range1 = worksheet11.Cells(X + 1, 9)
                'range1.NumberFormat = "0%"
                'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 3).Value.ToString)

                _nCount = 0
                Y = 2



                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            MC_Count = 0
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    ' x_Date = x_Date & " " & "7:30AM"
                    'X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='MARL & Yarn dye' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count

                x_Date = X_Date1
            Next
            ' If n_per > 0 Then
            _Count = _Count / (MC_Count * (1 - n_per))

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0.0"
            End If

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            End If
            X = X + 1

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            End If

            X = X + 1
            '---------------------------------------------------------------------------------------

            ' X = X - 1


            'x_Date = WeekStartdate
            'For i = 1 To 7
            '    X_Date1 = CDate(x_Date).AddDays(+1)
            '    If i = 1 Then
            '        ' x_Date = x_Date & " " & "7:30 AM"
            '        x_Date = x_Date & " " & "7:30AM"
            '        X_Date1 = X_Date1 & " " & "7:30AM"
            '    End If
            '    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name='No Work' and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
            '    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
            '    Y = 0
            '    For Each DTRow4 As DataRow In T03.Tables(0).Rows
            '        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
            '        Y = Y + 1
            '    Next
            '    x_Date = X_Date1
            'Next
            'x_Date = X_Date1
            'N_TOTALHR = 9 * 27 * 60 * _nCount
            'n_per = n_per / N_TOTALHR


            X = X + 3

            worksheet11.Cells(X, 1) = "Non bio-polish batches per day  without delay "
            worksheet11.Cells(X, 1).WrapText = True

            Dim _STD As Double

            _STD = 0
            x_Date = WeekStartdate
            Y = 2
            For i = 1 To L_DateofMonth

                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    '   x_Date = x_Date & " " & "7:30AM"
                    ' X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                Else
                    _STD = 0
                End If
                If _STD > 0 Then
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y) = 24 / _STD
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If

                x_Date = X_Date1
                Y = Y + 1
            Next
            '--------------------------------------------------------------------------------------


            ' X = X + 1
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(234, 241, 221)
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

            End If
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDot
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(194, 214, 154)


            X = X + 1

            worksheet11.Cells(X, 1) = "Non bio-polish Batches per day                           "
            worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(0, 0, 255)

            Dim n_Taken As Double
            Dim n_Count As Integer
            Dim M1 As Integer

            Y = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    '   x_Date = x_Date & " " & "7:30AM"
                    '  X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01') and M04ETime between '" & x_Date & "' and '" & X_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                n_Count = 0
                n_Taken = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 18
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1

                N_TOTALHR = 18 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 18
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If

                If _STD > 0 Then
                    worksheet11.Cells(X, Y) = n_Taken / _STD
                    ' worksheet11.Cells(X, 1).WrapText = True


                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0.0"
                    range1.Font.Color = RGB(0, 0, 255)
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                Y = Y + 1
                x_Date = X_Date1
            Next


            If L_DateofMonth = 7 Then
                ' worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous







            End If
            X = X + 1
            worksheet11.Cells(X, 1) = "Bio-polish Batches per day                        "
            worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(255, 0, 0)



            Y = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    ' x_Date = x_Date & " " & "7:30AM"
                    'X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01') and M04ETime between '" & x_Date & "' and '" & X_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                n_Count = 0
                n_Taken = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 18
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                N_TOTALHR = 18 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 18
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                If _STD > 0 Then
                    worksheet11.Cells(X, Y) = n_Taken / _STD
                    ' worksheet11.Cells(X, 1).WrapText = True


                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0.0"
                    range1.Font.Color = RGB(255, 0, 0)
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If
                Y = Y + 1
                x_Date = X_Date1
            Next


            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(194, 214, 154)
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)



            End If


            Dim chartPage As Microsoft.Office.Interop.Excel.Chart
            Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
            Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
            Dim chartRange As Microsoft.Office.Interop.Excel.Range
            Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
            Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


            Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
            Dim t_Series As Microsoft.Office.Interop.Excel.Series
            Dim z1 As Integer
            Dim sh As Worksheet
            xlCharts = worksheet11.ChartObjects

            Dim _Chartlocation As Integer

            _Chartlocation = (X + 40) * 10

            myChart = xlCharts.Add(10, _Chartlocation, 905, 300)
            chartPage = myChart.Chart
            Dim _CH As Integer
            '_CH = 7
            'For _CH = 7 To x - 1
            If L_DateofMonth = 7 Then
                chartRange = worksheet11.Range("b" & U_Count, "H" & U_Count)
                chartRange1 = worksheet11.Range("b4", "h4")
            ElseIf L_DateofMonth = 6 Then
                chartRange = worksheet11.Range("b" & U_Count, "g" & U_Count)
                chartRange1 = worksheet11.Range("b4", "g4")
            ElseIf L_DateofMonth = 5 Then
                chartRange = worksheet11.Range("b" & U_Count, "f" & U_Count)
                chartRange1 = worksheet11.Range("b4", "f4")
            ElseIf L_DateofMonth = 4 Then
                chartRange = worksheet11.Range("b" & U_Count, "e" & U_Count)
                chartRange1 = worksheet11.Range("b4", "e4")
            ElseIf L_DateofMonth = 3 Then
                chartRange = worksheet11.Range("b" & U_Count, "d" & U_Count)
                chartRange1 = worksheet11.Range("b4", "d4")
            ElseIf L_DateofMonth = 2 Then
                chartRange = worksheet11.Range("b" & U_Count, "c" & U_Count)
                chartRange1 = worksheet11.Range("b4", "c4")
            ElseIf L_DateofMonth = 1 Then
                chartRange = worksheet11.Range("b" & U_Count, "b" & U_Count)
                chartRange1 = worksheet11.Range("b4", "b4")
            End If
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of Baches per day (All)"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            If L_DateofMonth = 7 Then
                chartRange = worksheet11.Range("b" & X, "H" & X)
            ElseIf L_DateofMonth = 6 Then
                chartRange = worksheet11.Range("b" & X, "g" & X)
            ElseIf L_DateofMonth = 5 Then
                chartRange = worksheet11.Range("b" & X, "f" & X)
            ElseIf L_DateofMonth = 4 Then
                chartRange = worksheet11.Range("b" & X, "e" & X)
            ElseIf L_DateofMonth = 3 Then
                chartRange = worksheet11.Range("b" & X, "d" & X)
            ElseIf L_DateofMonth = 2 Then
                chartRange = worksheet11.Range("b" & X, "c" & X)
            ElseIf L_DateofMonth = 1 Then
                chartRange = worksheet11.Range("b" & X, "b" & X)
            End If
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            If L_DateofMonth = 7 Then
                chartRange = worksheet11.Range("b" & X - 1, "H" & X - 1)
            ElseIf L_DateofMonth = 6 Then
                chartRange = worksheet11.Range("b" & X - 1, "g" & X - 1)
            ElseIf L_DateofMonth = 5 Then
                chartRange = worksheet11.Range("b" & X - 1, "f" & X - 1)
            ElseIf L_DateofMonth = 4 Then
                chartRange = worksheet11.Range("b" & X - 1, "e" & X - 1)
            ElseIf L_DateofMonth = 3 Then
                chartRange = worksheet11.Range("b" & X - 1, "d" & X - 1)
            ElseIf L_DateofMonth = 2 Then
                chartRange = worksheet11.Range("b" & X - 1, "c" & X - 1)
            ElseIf L_DateofMonth = 1 Then
                chartRange = worksheet11.Range("b" & X - 1, "b" & X - 1)
            End If
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If




    End Function

    Function Batch_perWeekWJ()
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer
        Dim _cOUNT As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches per day -Weekly  (WJ)"

        worksheet11.Columns("A").ColumnWidth = 45
        'worksheet11.Columns("B").ColumnWidth = 10
        'worksheet11.Columns("C").ColumnWidth = 10
        'worksheet11.Columns("D").ColumnWidth = 10
        'worksheet11.Columns("E").ColumnWidth = 10
        'worksheet11.Columns("F").ColumnWidth = 10
        'worksheet11.Columns("G").ColumnWidth = 10
        'worksheet11.Columns("H").ColumnWidth = 10
        'worksheet11.Columns("I").ColumnWidth = 20
        ''worksheet11.Columns("J").ColumnWidth = 13

        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"


        Dim X As Integer
        X = 2
        i = 0
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows



            worksheet11.Cells(3, X) = T01.Tables(0).Rows(i)("ddate")
            'worksheet11.Cells(3, X).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Cells(3, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet11.Range(3, X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            X = X + 1
            i = i + 1
        Next
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Interior.Color = RGB(165, 165, 165)
        Dim _String As String

        _String = "B3:B3"
        Dim a As String
        a = 66

        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "3" & ":A" & Chr(a - 26) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                Else
                    If i + 1 = 27 Then
                        _String = "AA3:Aa3"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab3:Ab3"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac3:Ac3"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad3:Ad3"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae3:Ae3"
                    ElseIf i + 1 = 32 Then
                        _String = "Af3:Af3"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag3:Ag3"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah3:Ah3"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai3:Ai3"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj3:Aj3"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak3:Ak3"
                    ElseIf i + 1 = 38 Then
                        _String = "AL3:AL3"
                    ElseIf i + 1 = 39 Then
                        _String = "AM3:AM3"
                    ElseIf i + 1 = 40 Then
                        _String = "AN3:AN3"
                    ElseIf i + 1 = 41 Then
                        _String = "AO3:AO3"
                    ElseIf i + 1 = 42 Then
                        _String = "AP3:AP3"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ3:AQ3"
                    ElseIf i + 1 = 44 Then
                        _String = "AR3:AR3"
                    ElseIf i + 1 = 45 Then
                        _String = "AS3:AS3"
                    ElseIf i + 1 = 46 Then
                        _String = "AT3:AT3"
                    ElseIf i + 1 = 47 Then
                        _String = "AU3:AV3"
                    ElseIf i + 1 = 48 Then
                        _String = "AV3:AV3"
                    ElseIf i + 1 = 49 Then
                        _String = "AW3:AW3"
                    ElseIf i + 1 = 50 Then
                        _String = "AX3:AX3"
                    ElseIf i + 1 = 51 Then
                        _String = "AY3:AY3"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ3:AZ3"




                    End If
                    '  _String = "A" & Chr(a - 52) & "3" & ":B" & Chr(a - 52) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "3" & ":" & Chr(a) & "3"
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                a = a + 1
            End If




        Next
        worksheet11.Cells(4, 1) = "No of batches per day  without any delay                                           (Non bio-polish batches)"
        worksheet11.Cells(4, 1).WrapText = True
        '  worksheet11.Rows(4).rowheight = 20.25


        'NO OF BATCHES
        Dim _STD As Double
        Dim x_DATE As Date
        Dim X_DATE1 As Date

        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        Dim y2 As Integer

        X = 4
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            For y2 = 1 To L_DateofMonth

                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                x_DATE = X_DATE1

            Next
            ' _STD = _STD / 60
            _STD = _STD / _cOUNT
            _STD = _STD / 60
            If _STD > 0 Then
                worksheet11.Cells(X, Y) = _STD
                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y) = 24 / _STD
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If

            Y = Y + 1
            i = i + 1
        Next
        '--------------------------------------------------------------------------------------
        _String = "A4:A4"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "4" & ":A" & Chr(a - 26) & "4"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                Else
                    If i + 1 = 27 Then
                        _String = "AA4:Aa4"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab4:Ab4"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac4:Ac4"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad4:Ad4"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae4:Ae4"
                    ElseIf i + 1 = 32 Then
                        _String = "Af4:Af4"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag5:Ag4"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah4:Ah4"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai4:Ai4"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj4:Aj4"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak4:Ak4"
                    ElseIf i + 1 = 38 Then
                        _String = "AL4:AL4"
                    ElseIf i + 1 = 39 Then
                        _String = "AM4:AM4"
                    ElseIf i + 1 = 40 Then
                        _String = "AN4:AN4"
                    ElseIf i + 1 = 41 Then
                        _String = "AO4:AO4"
                    ElseIf i + 1 = 42 Then
                        _String = "AP4:AP4"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ4:AQ4"
                    ElseIf i + 1 = 44 Then
                        _String = "AR4:AR4"
                    ElseIf i + 1 = 45 Then
                        _String = "AS4:AS4"
                    ElseIf i + 1 = 46 Then
                        _String = "AT4:AT4"
                    ElseIf i + 1 = 47 Then
                        _String = "AU4:AV4"
                    ElseIf i + 1 = 48 Then
                        _String = "AV4:AV4"
                    ElseIf i + 1 = 49 Then
                        _String = "AW4:AW4"
                    ElseIf i + 1 = 50 Then
                        _String = "AX4:AX4"
                    ElseIf i + 1 = 51 Then
                        _String = "AY4:AY4"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ4:AZ4"




                    End If
                    ' _String = "B" & Chr(a - 52) & "4" & ":B" & Chr(a - 52) & "4"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "4" & ":" & Chr(a) & "4"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                a = a + 1
            End If




        Next

        '------------------------------------------------------------------------------------------
        worksheet11.Cells(5, 1) = "Non Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(5).rowheight = 30.25
        'NON BIO POLISH


        Dim N_TOTALHR As Integer


        Dim n_Taken As Double
        Dim n_Count As Integer
        Dim M1 As Integer

        Y = 2
        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 5
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If

            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If

                M1 = 0
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)


                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                'n_Taken = n_Taken / 60
                'n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                'n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                'N_TOTALHR = 9 * 24 * 60
                'n_per = n_per / N_TOTALHR
                'n_per = n_per * 216
                'n_per = n_per / 9
                ''-----------------------------------------------------
                ''Fabric
                'n_Taken = n_Taken + n_per
                'n_Taken = 24 - n_Taken

                '_STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                ' Y = Y + 1
                x_DATE = X_DATE1
            Next

            If n_Taken > 0 Then
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 18

                N_TOTALHR = 18 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 18
                n_per = n_per / 7
                n_Taken = n_Taken / 7
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken


                _STD = _STD / 60
                _STD = _STD / _cOUNT

                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 0, 255)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter

            End If
            Y = Y + 1
            i = i + 1

        Next



        _String = "A5:A5"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "5" & ":A" & Chr(a - 26) & "5"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                Else
                    '  _String = "B" & Chr(a - 52) & "5" & ":B" & Chr(a - 52) & "5"
                    If i + 1 = 27 Then
                        _String = "AA5:Aa5"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab5:Ab5"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac5:Ac5"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad5:Ad5"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae5:Ae5"
                    ElseIf i + 1 = 32 Then
                        _String = "Af5:Af5"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag5:Ag5"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah5:Ah5"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai5:Ai5"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj5:Aj5"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak5:Ak5"
                    ElseIf i + 1 = 38 Then
                        _String = "AL5:AL5"
                    ElseIf i + 1 = 39 Then
                        _String = "AM5:AM5"
                    ElseIf i + 1 = 40 Then
                        _String = "AN5:AN5"
                    ElseIf i + 1 = 41 Then
                        _String = "AO5:AO5"
                    ElseIf i + 1 = 42 Then
                        _String = "AP5:AP5"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ5:AQ5"
                    ElseIf i + 1 = 44 Then
                        _String = "AR5:AR5"
                    ElseIf i + 1 = 45 Then
                        _String = "AS5:AS5"
                    ElseIf i + 1 = 46 Then
                        _String = "AT5:AT5"
                    ElseIf i + 1 = 47 Then
                        _String = "AU5:AV5"
                    ElseIf i + 1 = 48 Then
                        _String = "AV5:AV5"
                    ElseIf i + 1 = 49 Then
                        _String = "AW5:AW5"
                    ElseIf i + 1 = 50 Then
                        _String = "AX5:AX5"
                    ElseIf i + 1 = 51 Then
                        _String = "AY5:AY5"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ5:AZ5"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "5" & ":" & Chr(a) & "5"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                a = a + 1
            End If




        Next

        '-------------------------------------------------------------------------------------
        worksheet11.Cells(6, 1) = "Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(6).rowheight = 30.25
        'NON BIO POLISH


        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 6
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If

            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate1)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            x_DATE = WeekStartdate1
            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                '  n_Count = 0
                ' n_Taken = 0
                M1 = 0
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next

                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                '  n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1

                '  _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                'Y = Y + 1
                x_DATE = X_DATE1
            Next

            If n_Taken > 0 Then
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 18

                N_TOTALHR = 18 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 18
                n_Taken = n_Taken / 7
                n_per = n_per / 7
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = _STD / 60
                _STD = _STD / _cOUNT

                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(255, 0, 0)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            i = i + 1
            Y = Y + 1
        Next

        _String = "A6:A6"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "6" & ":A" & Chr(a - 26) & "6"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                Else
                    '   _String = "B" & Chr(a - 52) & "6" & ":B" & Chr(a - 52) & "6"
                    If i + 1 = 27 Then
                        _String = "AA6:Aa6"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab6:Ab6"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac6:Ac6"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad6:Ad6"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae6:Ae6"
                    ElseIf i + 1 = 32 Then
                        _String = "Af6:Af6"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag6:Ag6"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah6:Ah6"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai6:Ai6"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj6:Aj6"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak6:Ak6"
                    ElseIf i + 1 = 38 Then
                        _String = "AL6:AL6"
                    ElseIf i + 1 = 39 Then
                        _String = "AM6:AM6"
                    ElseIf i + 1 = 40 Then
                        _String = "AN6:AN6"
                    ElseIf i + 1 = 41 Then
                        _String = "AO6:AO6"
                    ElseIf i + 1 = 42 Then
                        _String = "AP6:AP6"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ6:AQ6"
                    ElseIf i + 1 = 44 Then
                        _String = "AR6:AR6"
                    ElseIf i + 1 = 45 Then
                        _String = "AS6:AS6"
                    ElseIf i + 1 = 46 Then
                        _String = "AT6:AT6"
                    ElseIf i + 1 = 47 Then
                        _String = "AU6:AV6"
                    ElseIf i + 1 = 48 Then
                        _String = "AV6:AV6"
                    ElseIf i + 1 = 49 Then
                        _String = "AW6:AW6"
                    ElseIf i + 1 = 50 Then
                        _String = "AX6:AX6"
                    ElseIf i + 1 = 51 Then
                        _String = "AY6:AY6"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ6:AZ6"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "6" & ":" & Chr(a) & "6"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                a = a + 1
            End If

        Next
        '--------------------------------------------------------------------------
        'No of batches per day( Bio-polish + Non bio-polish)  
        i = 0
        Y = 2
        worksheet11.Cells(7, 1) = "No of batches per day( Bio-polish + Non bio-polish)  "
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(7).rowheight = 30.25
        Dim MC_Count As Integer
        Dim H1 As Integer

        '  Dim y1 As Integer
        ' Dim y2 As Integer
        Dim M_Total As Double
        Dim Y3 As Integer
        X = 7
        Y3 = 2
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"

        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate1 As Date
            '  Dim _COUNT As Integer

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate1 = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate1)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate1 = CDate(WeekStartdate1).AddDays(-5)
            End If
            WeekEnddate1 = CDate(WeekStartdate1).AddDays(+7)
            If WeekEnddate1 > txtTodate.Value Then
                WeekEnddate1 = CDate(txtTodate.Value).AddDays(+1)
            End If

            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0
            M_Total = 0
            x_DATE = WeekStartdate1
            MC_Count = 0
            For y2 = 1 To 7
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                M1 = 0
                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
" M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
"group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    M_Total = M_Total + T04.Tables(0).Rows(H1)("T03Name")
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow1 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next

                '------------------------------------------------------------------------
                'M1 = 0
                'SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('No Work','PM','MainM') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                'For Each DTRow1 As DataRow In T03.Tables(0).Rows
                '    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                '    M1 = M1 + 1
                'Next
                x_DATE = X_DATE1

            Next

            If MC_Count > 0 Then
                N_TOTALHR = MC_Count * 24 * 60 '* L_DateofMonth
                n_per = n_per / N_TOTALHR

                Dim B1 As Double
                Dim B2 As Double
                B2 = 0
                B1 = 1 - n_per
                B1 = MC_Count * B1
                ' M_Total = M_Total / L_DateofMonth
                B2 = M_Total / B1

                worksheet11.Cells(X, Y3) = B2
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y3)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 176, 80)
                worksheet11.Cells(X, Y3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            i = i + 1
            Y3 = Y3 + 1
        Next

        _String = "A7:A7"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "7" & ":A" & Chr(a - 26) & "7"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                Else
                    ' _String = "B" & Chr(a - 52) & "7" & ":B" & Chr(a - 52) & "7"

                    If i + 1 = 27 Then
                        _String = "AA7:Aa7"
                    ElseIf i + 1 = 28 Then
                        _String = "Ab7:Ab7"
                    ElseIf i + 1 = 29 Then
                        _String = "Ac7:Ac7"
                    ElseIf i + 1 = 30 Then
                        _String = "Ad7:Ad7"
                    ElseIf i + 1 = 31 Then
                        _String = "Ae7:Ae7"
                    ElseIf i + 1 = 32 Then
                        _String = "Af7:Af7"
                    ElseIf i + 1 = 33 Then
                        _String = "Ag7:Ag7"
                    ElseIf i + 1 = 34 Then
                        _String = "Ah7:Ah7"
                    ElseIf i + 1 = 35 Then
                        _String = "Ai7:Ai7"
                    ElseIf i + 1 = 36 Then
                        _String = "Aj7:Aj7"
                    ElseIf i + 1 = 37 Then
                        _String = "Ak7:Ak7"
                    ElseIf i + 1 = 38 Then
                        _String = "AL7:AL7"
                    ElseIf i + 1 = 39 Then
                        _String = "AM7:AM7"
                    ElseIf i + 1 = 40 Then
                        _String = "AN7:AN7"
                    ElseIf i + 1 = 41 Then
                        _String = "AO7:AO7"
                    ElseIf i + 1 = 42 Then
                        _String = "AP7:AP7"
                    ElseIf i + 1 = 43 Then
                        _String = "AQ7:AQ7"
                    ElseIf i + 1 = 44 Then
                        _String = "AR7:AR7"
                    ElseIf i + 1 = 45 Then
                        _String = "AS7:AS7"
                    ElseIf i + 1 = 46 Then
                        _String = "AT7:AT7"
                    ElseIf i + 1 = 47 Then
                        _String = "AU7:AV7"
                    ElseIf i + 1 = 48 Then
                        _String = "AV7:AV7"
                    ElseIf i + 1 = 49 Then
                        _String = "AW7:AW7"
                    ElseIf i + 1 = 50 Then
                        _String = "AX7:AX7"
                    ElseIf i + 1 = 51 Then
                        _String = "AY7:AY7"
                    ElseIf i + 1 = 52 Then
                        _String = "AZ7:AZ7"




                    End If
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "7" & ":" & Chr(a) & "7"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                a = a + 1
            End If

        Next
        '-------------------------------------------------------------------------------------------------
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet11.ChartObjects

        Dim _Chartlocation As Integer

        _Chartlocation = (X + 10) * 10

        myChart = xlCharts.Add(10, _Chartlocation, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1

        i = 0
        '  SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
        '        "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"


        ' Dim X As Integer
        ' X = 2
        i = 0
        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)

        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        a = 66
        If isValidDataset(T01) Then
            For i = 1 To T01.Tables(0).Rows.Count

                If a > 90 Then

                    If (a - 25) > 90 Then
                        If i = 25 Then
                            _String = "AA"
                        ElseIf i = 26 Then
                            _String = "AB"
                        End If
                        _String = Chr(a - 26)

                        a = a + 1
                    Else
                        If i = 26 Then
                            _String = "AA"
                        ElseIf i = 27 Then
                            _String = "AB"
                        ElseIf i = 28 Then
                            _String = "AC"
                        ElseIf i = 29 Then
                            _String = "AD"
                        ElseIf i = 30 Then
                            _String = "AE"
                        ElseIf i = 31 Then

                            _String = "AF"
                        ElseIf i = 32 Then
                            _String = "AG"
                        ElseIf i = 33 Then
                            _String = "AH"
                        ElseIf i = 34 Then
                            _String = "AI"
                        ElseIf i = 35 Then
                            _String = "AJ"
                        ElseIf i = 36 Then
                            _String = "AK"
                        ElseIf i = 37 Then
                            _String = "AL"
                        ElseIf i = 38 Then
                            _String = "AM"
                        ElseIf i = 39 Then
                            _String = "AN"
                        ElseIf i = 40 Then
                            _String = "AO"
                        ElseIf i = 41 Then
                            _String = "AP"
                        ElseIf i = 42 Then
                            _String = "AQ"
                        ElseIf i = 43 Then
                            _String = "AR"
                        ElseIf i = 44 Then
                            _String = "AS"
                        ElseIf i = 45 Then
                            _String = "AT"
                        ElseIf i = 46 Then
                            _String = "AU"
                        ElseIf i = 47 Then
                            _String = "AV"
                        ElseIf i = 48 Then
                            _String = "AW"
                        ElseIf i = 49 Then
                            _String = "AX"
                        ElseIf i = 50 Then
                            _String = "AY"
                        ElseIf i = 51 Then
                            _String = "AZ"
                        ElseIf i = 52 Then
                            _String = "BA"
                        ElseIf i = 53 Then
                            _String = "BB"
                        ElseIf i = 54 Then
                            _String = "BC"



                        End If
                        '_String = "B" & Chr(a - 52)
                        a = a + 1
                    End If
                Else
                   
                    _String = Chr(a)

                    a = a + 1
                End If

            Next

            chartRange = worksheet11.Range("B4", _String & "4")
            chartRange1 = worksheet11.Range("b3", _String & "3")
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day  without any delay "
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            chartRange = worksheet11.Range("b5", _String & "5")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non Bio -polish batches per day per machine "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            chartRange = worksheet11.Range("b6", _String & "6")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine


            chartRange = worksheet11.Range("b7", _String & "7")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day( Bio-polish + Non bio-polish)  "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 0, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If
    End Function

    Function Batch_perMonthWJ()

        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer
        Dim _cOUNT As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)

        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches per day -Monthly  (WJ)"

        worksheet11.Columns("A").ColumnWidth = 45
        'worksheet11.Columns("B").ColumnWidth = 10
        'worksheet11.Columns("C").ColumnWidth = 10
        'worksheet11.Columns("D").ColumnWidth = 10
        'worksheet11.Columns("E").ColumnWidth = 10
        'worksheet11.Columns("F").ColumnWidth = 10
        'worksheet11.Columns("G").ColumnWidth = 10
        'worksheet11.Columns("H").ColumnWidth = 10
        'worksheet11.Columns("I").ColumnWidth = 20
        ''worksheet11.Columns("J").ColumnWidth = 13

        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"


        Dim X As Integer
        Dim L_DateofMonth As Integer

        X = 2
        i = 0
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)
            ' N_TOTALHR = 24 * 27 * 60 * L_DateofMonth
            worksheet11.Cells(3, X) = MonthName(T01.Tables(0).Rows(i)("T01month"), True) & "-" & T01.Tables(0).Rows(i)("EYear")

            ' worksheet11.Cells(3, X) = T01.Tables(0).Rows(i)("ddate")
            'worksheet11.Cells(3, X).EntireColumn.NumberFormat = "dd-MMM"
            worksheet11.Cells(3, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'worksheet11.Range(3, X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            X = X + 1
            i = i + 1
        Next
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range("A3:A3").Interior.Color = RGB(165, 165, 165)
        Dim _String As String

        _String = "B3:B3"
        Dim a As String
        a = 66

        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "3" & ":A" & Chr(a - 26) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "3" & ":B" & Chr(a - 52) & "3"
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "3" & ":" & Chr(a) & "3"
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(165, 165, 165)
                a = a + 1
            End If




        Next
        worksheet11.Cells(4, 1) = "No of batches per day  without any delay                                           (Non bio-polish batches)"
        worksheet11.Cells(4, 1).WrapText = True
        '  worksheet11.Rows(4).rowheight = 20.25


        'NO OF BATCHES
        Dim _STD As Double
        Dim x_DATE As Date
        Dim X_DATE1 As Date

        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        Dim y2 As Integer

        X = 4
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime) , Month(m04Etime) order by year(m04Etime) , Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            WeekEnddate = CDate(WeekStartdate1).AddDays(+L_DateofMonth)
            ' WeekStartdate = WeekStartdate & " " & "7:30AM"
            ' WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            For y2 = 1 To L_DateofMonth

                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    ' _STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                x_DATE = X_DATE1

            Next
            ' _STD = _STD / 60
            _STD = _STD / _cOUNT
            _STD = _STD / 60
            If _STD > 0 Then
                worksheet11.Cells(X, Y) = _STD
                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                worksheet11.Cells(X, Y) = 24 / _STD
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If

            Y = Y + 1
            i = i + 1
        Next
        '--------------------------------------------------------------------------------------
        _String = "A4:A4"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "4" & ":A" & Chr(a - 26) & "4"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "4" & ":B" & Chr(a - 52) & "4"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "4" & ":" & Chr(a) & "4"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(242, 242, 242)
                a = a + 1
            End If




        Next

        '------------------------------------------------------------------------------------------
        worksheet11.Cells(5, 1) = "Non Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(5).rowheight = 30.25
        'NON BIO POLISH


        Dim N_TOTALHR As Integer


        Dim n_Taken As Double
        Dim n_Count As Integer
        Dim M1 As Integer

        Y = 2
        _STD = 0
        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 5
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            End If

            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If

                M1 = 0
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)


                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                'n_Taken = n_Taken / 60
                'n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                'n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                'N_TOTALHR = 9 * 24 * 60
                'n_per = n_per / N_TOTALHR
                'n_per = n_per * 216
                'n_per = n_per / 9
                ''-----------------------------------------------------
                ''Fabric
                'n_Taken = n_Taken + n_per
                'n_Taken = 24 - n_Taken

                '_STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                ' Y = Y + 1
                x_DATE = X_DATE1
            Next

            If _STD > 0 Then
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 18

                N_TOTALHR = 18 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 18
                n_per = n_per / L_DateofMonth
                n_Taken = n_Taken / L_DateofMonth
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken


                _STD = _STD / 60
                _STD = _STD / _cOUNT

                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 0, 255)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            Y = Y + 1
            i = i + 1

        Next



        _String = "A5:A5"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "5" & ":A" & Chr(a - 26) & "5"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "5" & ":B" & Chr(a - 52) & "5"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "5" & ":" & Chr(a) & "5"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(220, 220, 220)
                a = a + 1
            End If




        Next

        '-------------------------------------------------------------------------------------
        worksheet11.Cells(6, 1) = "Bio -polish batches per day per machine"
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(6).rowheight = 30.25
        'NON BIO POLISH


        i = 0
        Y = 2
        '  Dim y1 As Integer
        ' Dim y2 As Integer

        X = 6
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount  FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            WeekEnddate = CDate(WeekStartdate1).AddDays(+L_DateofMonth)
            'WeekStartdate1 = WeekStartdate & " " & "7:30AM"
            ' WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            M1 = 0

            x_DATE = WeekStartdate1
            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('01') and M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                '  n_Count = 0
                ' n_Taken = 0
                M1 = 0
                For Each DTRow1 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next

                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                '  n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow2 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1

                '  _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('01') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = _STD + T03.Tables(0).Rows(0)("STD")
                    '_STD = _STD / 60
                    _cOUNT = _cOUNT + T03.Tables(0).Rows(0)("CCount")

                End If

                'Y = Y + 1
                x_DATE = X_DATE1
            Next

            If n_Taken > 0 Then
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 18

                N_TOTALHR = 18 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 18
                n_Taken = n_Taken / L_DateofMonth
                n_per = n_per / L_DateofMonth
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = _STD / 60
                _STD = _STD / _cOUNT

                worksheet11.Cells(X, Y) = n_Taken / _STD
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(255, 0, 0)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            i = i + 1
            Y = Y + 1
        Next

        _String = "A6:A6"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "6" & ":A" & Chr(a - 26) & "6"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "6" & ":B" & Chr(a - 52) & "6"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "6" & ":" & Chr(a) & "6"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(201, 201, 201)
                a = a + 1
            End If

        Next
        '--------------------------------------------------------------------------
        'No of batches per day( Bio-polish + Non bio-polish)  
        i = 0
        Y = 2
        worksheet11.Cells(7, 1) = "No of batches per day( Bio-polish + Non bio-polish)  "
        '  worksheet11.Cells(5, 1).WrapText = True
        worksheet11.Rows(7).rowheight = 30.25
        '  Dim y1 As Integer
        ' Dim y2 As Integer
        Dim M_Total As Double
        Dim MC_Count As Integer
        Dim H1 As Integer
        Dim Y3 As Integer
        Y3 = 2
        X = 7
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month,count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime) "
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        For Each DTRow4 As DataRow In T01.Tables(0).Rows
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate1 As Date
            Dim WeekEnddate As Date

            Dim aDate As DateTime
            aDate = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("EYear")
            Dim EndDate As DateTime = aDate.AddDays(DateTime.DaysInMonth(aDate.Year, aDate.Month) - 1)
            '  MsgBox(MonthName(T01.Tables(0).Rows(i)("T01month"), True))
            L_DateofMonth = Microsoft.VisualBasic.Day(EndDate)

            StartdateofYear = T01.Tables(0).Rows(i)("T01month") & "/1/" & T01.Tables(0).Rows(i)("Eyear")
            WeekStartdate1 = StartdateofYear
            WeekEnddate = CDate(WeekStartdate1).AddDays(+L_DateofMonth)
            'WeekStartdate = WeekStartdate & " " & "7:30AM"
            'WeekEnddate = WeekEnddate & " " & "7:30AM"
            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate1)
                L_DateofMonth = diff1.Days
                If L_DateofMonth = 1 Then
                Else
                    L_DateofMonth = L_DateofMonth - 1
                End If
            End If
            x_DATE = WeekStartdate1
            _STD = 0
            _cOUNT = 0
            n_Count = 0
            n_per = 0
            n_Taken = 0
            MC_Count = 0
            M1 = 0
            M_Total = 0
            x_DATE = WeekStartdate1
            
            For y2 = 1 To L_DateofMonth
                X_DATE1 = CDate(x_DATE).AddDays(+1)
                If y2 = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_DATE = x_DATE & " " & "7:30AM"
                    X_DATE1 = X_DATE1 & " " & "7:30AM"
                End If
                M1 = 0
                '         SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                '         "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE T03TYPE IN ('01') and " & _
                ' " M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 " & _
                '"group by T03code"
                '         T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                '         For Each DTRow1 As DataRow In T04.Tables(0).Rows

                '             M_Total = M_Total + T04.Tables(0).Rows(M1)("T03Name")
                '             M1 = M1 + 1
                '         Next

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
     "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('01') and " & _
" M04ETime between '" & x_DATE & "' and '" & X_DATE1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
"group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    M_Total = M_Total + T04.Tables(0).Rows(H1)("T03Name")
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow1 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next

                '------------------------------------------------------------------------
                'M1 = 0
                'SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('No Work','PM','MainM') and T03Type ='01' AND T01DATE BETWEEN '" & x_DATE & "' AND '" & X_DATE1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                'T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                'For Each DTRow1 As DataRow In T03.Tables(0).Rows
                '    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                '    M1 = M1 + 1
                'Next
                x_DATE = X_DATE1

            Next

            If MC_Count > 0 Then
                N_TOTALHR = MC_Count * 24 * 60 '* L_DateofMonth
                n_per = n_per / N_TOTALHR

                Dim B1 As Double
                Dim B2 As Double
                B2 = 0
                B1 = 1 - n_per
                B1 = MC_Count * B1
                ' M_Total = M_Total / L_DateofMonth
                B2 = M_Total / B1

                worksheet11.Cells(X, Y3) = B2
                ' worksheet11.Cells(X, 1).WrapText = True


                range1 = worksheet11.Cells(X, Y3)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 176, 80)
                worksheet11.Cells(X, Y3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If
            i = i + 1
            Y3 = Y3 + 1
        Next

        _String = "A7:A7"
        ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
        worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
        a = 66
        For i = 1 To T01.Tables(0).Rows.Count

            If a > 90 Then

                If (a - 25) > 90 Then
                    _String = "A" & Chr(a - 26) & "7" & ":A" & Chr(a - 26) & "7"
                    ' worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                Else
                    _String = "B" & Chr(a - 52) & "7" & ":B" & Chr(a - 52) & "7"
                    '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                    a = a + 1
                End If
            Else
                _String = Chr(a) & "7" & ":" & Chr(a) & "7"
                '  worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range(_String).Interior.Color = RGB(190, 190, 190)
                a = a + 1
            End If

        Next
        '-------------------------------------------------------------------------------------------------
        Dim chartPage As Microsoft.Office.Interop.Excel.Chart
        Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
        Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
        Dim chartRange As Microsoft.Office.Interop.Excel.Range
        Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
        Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


        Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
        Dim t_Series As Microsoft.Office.Interop.Excel.Series
        Dim z1 As Integer
        Dim sh As Worksheet
        xlCharts = worksheet11.ChartObjects

        Dim _Chartlocation As Integer

        _Chartlocation = (X + 10) * 10

        myChart = xlCharts.Add(10, _Chartlocation, 905, 300)
        chartPage = myChart.Chart
        Dim _CH As Integer
        '_CH = 7
        'For _CH = 7 To x - 1

        i = 0
        Dim Y_Date As Date

        n_Date = CDate(txtFromDate.Text).AddDays(-365)
        n_Date = n_Date & " " & "7:30AM"
        N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = N_Date1 & " " & "7:30AM"
        SQL = "SELECT year(m04Etime) as Eyear, Month(m04Etime) as T01month FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & n_Date & "' and '" & N_Date1 & "' and M04ProgrameType in ('N','R','S') GROUP BY year(m04Etime),Month(m04Etime) order by year(m04Etime),Month(m04Etime)"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        a = 66
        If isValidDataset(T01) Then
            For i = 1 To T01.Tables(0).Rows.Count

                If a > 90 Then

                    If (a - 25) > 90 Then
                        _String = Chr(a - 26)

                        a = a + 1
                    Else
                        _String = "B" & Chr(a - 52)
                        a = a + 1
                    End If
                Else
                    _String = Chr(a)

                    a = a + 1
                End If

            Next

            chartRange = worksheet11.Range("B4", _String & "4")
            chartRange1 = worksheet11.Range("b3", _String & "3")
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day  without any delay "
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 0, 255)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(0, 0, 255)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            chartRange = worksheet11.Range("b5", _String & "5")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non Bio -polish batches per day per machine "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            chartRange = worksheet11.Range("b6", _String & "6")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine


            chartRange = worksheet11.Range("b7", _String & "7")
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of batches per day( Bio-polish + Non bio-polish)  "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 0, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If


    End Function

    Private Sub cmdReset_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdReset.Click
        txtFromDate.Value = Today
        txtTodate.Value = Today
    End Sub

    Function Batch_perDayAFNw()
        Dim U_Count As Integer
        Dim MC_Count As Integer
        Dim SQL As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim T01 As DataSet
        Dim T03 As DataSet
        Dim dsUser As DataSet
        Dim n_Date As Date
        Dim N_Date1 As Date
        Dim FileName As String
        exc.Visible = True
        Dim i As Integer
        Dim _GrandTotal As Integer
        Dim _STGrand As String
        Dim range1 As Range
        Dim _NETTOTAL As Integer
        Dim T04 As DataSet
        Dim n_per As Double
        Dim Y As Integer

        '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
        workbooks.Application.Sheets.Add()
        Dim sheets1 As Sheets = workbook.Worksheets
        Dim worksheet11 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
        worksheet11.Name = "Batches Per Day - Daily (AF)"

        'worksheet11.Columns("A").ColumnWidth = 24
        'worksheet11.Columns("B").ColumnWidth = 10
        'worksheet11.Columns("C").ColumnWidth = 10
        'worksheet11.Columns("D").ColumnWidth = 10
        'worksheet11.Columns("E").ColumnWidth = 10
        'worksheet11.Columns("F").ColumnWidth = 10
        'worksheet11.Columns("G").ColumnWidth = 10
        'worksheet11.Columns("H").ColumnWidth = 10
        'worksheet11.Columns("I").ColumnWidth = 20
        ''worksheet11.Columns("J").ColumnWidth = 13

        n_Date = txtFromDate.Value
        n_Date = CDate(n_Date).AddDays(+1)
        n_Date = n_Date & " " & "7:30AM"
        ' N_Date1 = CDate(txtTodate.Text).AddDays(+1)
        N_Date1 = txtTodate.Text & " " & "7:30AM"

        SQL = "SELECT M04Week ,max(M04WeekNo) as [Ddate],count(T03TYPE) as nCount,m04year as Eyear FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE  T03TYPE IN ('01','02') and M04ETime between '" & N_Date1 & "' and '" & n_Date & "' and M04ProgrameType in ('N','R','S') GROUP BY m04year,M04Week order by m04year,M04Week"
        T01 = DBEngin.ExecuteDataset(con, Nothing, SQL)
        If isValidDataset(T01) Then
            Dim StartdateofYear As Date
            Dim Dateofweek As Integer
            Dim WeekStartdate As Date
            Dim WeekEnddate As Date

            StartdateofYear = "1/1/" & T01.Tables(0).Rows(i)("Eyear")

            Dateofweek = (7 * T01.Tables(0).Rows(i)("M04Week")) - 7
            WeekStartdate = CDate(StartdateofYear).AddDays(+Dateofweek)
            Dim thisCulture = Globalization.CultureInfo.CurrentCulture
            Dim dayOfWeek As DayOfWeek = thisCulture.Calendar.GetDayOfWeek(WeekStartdate)
            Dim dayName As String = thisCulture.DateTimeFormat.GetDayName(dayOfWeek)

            If dayName = "Sunday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(+1)
            ElseIf dayName = "Tuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-1)
            ElseIf dayName = "Wednesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-2)
            ElseIf dayName = "Thuesday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-3)
            ElseIf dayName = "Friday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-4)
            ElseIf dayName = "Saturday" Then
                WeekStartdate = CDate(WeekStartdate).AddDays(-5)
            End If
            WeekEnddate = CDate(WeekStartdate).AddDays(+7)
            If WeekEnddate > txtTodate.Value Then
                WeekEnddate = CDate(txtTodate.Value).AddDays(+1)
            End If


            worksheet11.Cells(2, 1) = "Week   " & T01.Tables(0).Rows(0)("M04Week") & "   Air Flow  batches per machine per day (colours)  "
            worksheet11.Rows(2).Font.Bold = True
            worksheet11.Rows(2).Font.size = 14

            worksheet11.Range(worksheet11.Cells(2, 1), worksheet11.Cells(1, 9)).Merge()
            worksheet11.Cells(1, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'worksheet11.Rows(2).Select()
            'worksheet11.Application.ActiveWindow.FreezePanes = True

            worksheet11.Cells(3, 1) = "COLOUR"
            worksheet11.Rows(3).Font.Bold = True
            range1 = worksheet11.Cells(3, 1)
            range1.Font.Color = RGB(255, 0, 0)

            worksheet11.Cells(4, 1) = ""
            worksheet11.Rows(4).Font.Bold = True
            worksheet11.Rows(4).Font.size = 12
            worksheet11.Cells(4, 1).HorizontalAlignment = XlHAlign.xlHAlignCenter

            Dim X As Integer
            Dim x_Date As Date



            Dim diff1 As System.TimeSpan
            Dim date2 As System.DateTime
            date2 = txtFromDate.Text
            Dim L_DateofMonth As Integer
            diff1 = date2.Subtract(WeekStartdate)
            If diff1.Days <= 7 Then
                '  If Month(WeekStartdate1) = Month(txtFromDate.Text) And Year(WeekStartdate1) = Year(txtFromDate.Text) Then

                diff1 = date2.Subtract(WeekStartdate)
                L_DateofMonth = diff1.Days
                ' If L_DateofMonth = 1 Then
                'Else
                L_DateofMonth = L_DateofMonth + 1
                'End If
            Else
                L_DateofMonth = 7
                'End If
            End If
            ' worksheet11.Rows(2).Select()
            If L_DateofMonth = 7 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 10
                worksheet11.Columns("G").ColumnWidth = 10
                worksheet11.Columns("H").ColumnWidth = 10
                worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 10
                worksheet11.Columns("G").ColumnWidth = 10
                worksheet11.Columns("H").ColumnWidth = 20
                '  worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 10
                worksheet11.Columns("G").ColumnWidth = 20
                '  worksheet11.Columns("H").ColumnWidth = 10
                ' worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 10
                worksheet11.Columns("F").ColumnWidth = 20
                '  worksheet11.Columns("G").ColumnWidth = 10
                ' worksheet11.Columns("H").ColumnWidth = 10
                'worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 10
                worksheet11.Columns("E").ColumnWidth = 20
                'worksheet11.Columns("F").ColumnWidth = 10
                'worksheet11.Columns("G").ColumnWidth = 10
                'worksheet11.Columns("H").ColumnWidth = 10
                'worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 10
                worksheet11.Columns("D").ColumnWidth = 20
                'worksheet11.Columns("E").ColumnWidth = 10
                'worksheet11.Columns("F").ColumnWidth = 10
                'worksheet11.Columns("G").ColumnWidth = 10
                'worksheet11.Columns("H").ColumnWidth = 10
                'worksheet11.Columns("I").ColumnWidth = 20
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Columns("A").ColumnWidth = 24
                worksheet11.Columns("B").ColumnWidth = 10
                worksheet11.Columns("C").ColumnWidth = 20

            End If

            ' worksheet11.Rows(2).Font.size = 14
            Dim X_Date1 As Date
            ' worksheet11.Rows(2).Font.size = 14
            X = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                worksheet11.Cells(4, X) = x_Date
                worksheet11.Cells(4, X).EntireColumn.NumberFormat = "dd-MMM"
                worksheet11.Cells(4, X).HorizontalAlignment = XlHAlign.xlHAlignCenter
                x_Date = CDate(x_Date).AddDays(+1)
                X = X + 1
            Next

            worksheet11.Cells(4, X) = "No. of batches/daily"


            '------------------------------------------------------------------------------------------
            'worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous

            If L_DateofMonth = 7 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                ' worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("A4:A4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b4:b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c4:c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                ' worksheet11.Range("d4:d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e4:e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f4:f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g4:g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h4:h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i4:i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            End If
            '---------------------------------------------------------------------------------------------------------
            'worksheet11.Range("A3, A3").Interior.Color = RGB(215, 228, 188)
            'worksheet11.Range("b3, b3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("c3, c3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("d3, d3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("e3, e3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("f3, f3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("g3, g3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("h3, h3").Interior.Color = RGB(197, 190, 151)
            'worksheet11.Range("i3, i3").Interior.Color = RGB(219, 238, 243)

            X = 5

            Dim Y1 As Integer
            Dim Z As Integer

            i = 0
            SQL = "SELECT T03Code,T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
           " M04ETime between '" & WeekStartdate & "' and '" & WeekEnddate & "' and M04ProgrameType in ('N','R','S')  and m08CL='Colour'" & _
          "group by T03Name,T03code"
            dsUser = DBEngin.ExecuteDataset(con, Nothing, SQL)
            For Each DTRow4 As DataRow In dsUser.Tables(0).Rows
                worksheet11.Cells(X, 1) = dsUser.Tables(0).Rows(i)("T03Name")
                x_Date = WeekStartdate
                Y1 = 2
                Y = 2
                For Y1 = 1 To L_DateofMonth
                    X_Date1 = CDate(x_Date).AddDays(+1)
                    If Y1 = 1 Then
                        ' x_Date = x_Date & " " & "7:30 AM"
                        x_Date = x_Date & " " & "7:30AM"
                        X_Date1 = X_Date1 & " " & "7:30AM"
                    End If
                    SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
                   "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
           " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S') and  T03code='" & dsUser.Tables(0).Rows(i)("T03code") & "'  and M04Batchwt>0 and m08CL='Colour' " & _
          "group by T03code"
                    T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    If isValidDataset(T04) Then
                        range1 = worksheet11.Cells(X, Y)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X, Y) = T04.Tables(0).Rows(0)("T03Name")
                    End If
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0"
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    x_Date = X_Date1
                    Y = Y + 1

                Next

                'worksheet11.Range("I" & (X)).Formula = "=SUM(b" & X & ":H" & X & ")"
                'worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                If L_DateofMonth = 7 Then
                    worksheet11.Range("I" & (X)).Formula = "=SUM(b" & X & ":H" & X & ")"
                ElseIf L_DateofMonth = 6 Then
                    worksheet11.Range("H" & (X)).Formula = "=SUM(b" & X & ":G" & X & ")"
                ElseIf L_DateofMonth = 5 Then
                    worksheet11.Range("G" & (X)).Formula = "=SUM(b" & X & ":F" & X & ")"
                ElseIf L_DateofMonth = 4 Then
                    worksheet11.Range("F" & (X)).Formula = "=SUM(b" & X & ":E" & X & ")"
                ElseIf L_DateofMonth = 3 Then
                    worksheet11.Range("E" & (X)).Formula = "=SUM(b" & X & ":D" & X & ")"
                ElseIf L_DateofMonth = 2 Then
                    worksheet11.Range("D" & (X)).Formula = "=SUM(b" & X & ":C" & X & ")"
                ElseIf L_DateofMonth = 1 Then
                    worksheet11.Range("C" & (X)).Formula = "=SUM(b" & X & ":b" & X & ")"
                End If
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                If L_DateofMonth = 7 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 6 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 5 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                ElseIf L_DateofMonth = 4 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 3 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                ElseIf L_DateofMonth = 2 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                ElseIf L_DateofMonth = 1 Then
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



                End If
                X = X + 1
                i = i + 1
            Next
            worksheet11.Cells(X, 1) = "Total"
            worksheet11.Rows(X).Font.Bold = True
            Y = 2
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0"

            'worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
            'worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X, 3)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
            'worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X, 4)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
            'worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X, 5)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
            'worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X, 6)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
            'worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X, 7)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 7) = "=SUM(g5:g" & (X - 1) & ")"
            'worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X, 8)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 8) = "=SUM(h5:h" & (X - 1) & ")"
            'worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g5:g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(h5:h" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(g5:g" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(f5:f" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(e5:e" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(d5:d" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(c5:c" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 2) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b5:b" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If

            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            End If
            '--------------------------------------------------------------------------------------------------------------------------
            X = X + 1
            worksheet11.Cells(X, 1) = "No. of batches (with out no work)"
            worksheet11.Cells(X, 1).WrapText = True
            U_Count = X
            range1 = worksheet11.Cells(X, 2)
            range1.NumberFormat = "0.0"
            '----------------------------------------------------------------------------------------
            worksheet11.Cells(X + 1, 1) = "No work  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            ' range1 = worksheet11.Cells(X, 2)
            'range1.NumberFormat = "0%"

            i = 0
            Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                ' Dim MC_Count As Integer
                Dim H1 As Integer

                MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type, M05Name" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                x_Date = X_Date1
                If n_per > 0 Then
                    N_TOTALHR = 9 * 24 * 60
                    n_per = n_per / N_TOTALHR

                    Dim B1 As Double
                    Dim B2 As Double
                    B2 = 0
                    B1 = 1 - n_per
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 1 & ":B" & X - 1 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                        worksheet11.Cells(X + 1, 2) = n_per

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 1 & ":c" & X - 1 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, 3) = n_per

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 1 & ":D" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 1 & ":E" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 1 & ":F" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 1 & ":G" & X - 1 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 1 & ":H" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                    B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                    ' B1 = 1 - B1
                    B1 = 9 * B1
                    B2 = B2 / B1
                    'B2 = worksheet11.Cells(X, 2)
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1) = B2
                Else
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 1 & ":B" & X - 1 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter

                        worksheet11.Cells(X + 1, 2) = "0"
                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 1 & ":c" & X - 1 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, 3) = "0"

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 1 & ":D" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 1 & ":E" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 1 & ":F" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 1 & ":G" & X - 1 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 1 & ":H" & X - 1 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                End If
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            'range1 = worksheet11.Cells(X, 9)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 9) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X + 1, 9)
            'range1.NumberFormat = "0%"
            'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
            'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 1) & ":h" & (X - 1) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 9)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 1) & ":G" & (X - 1) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 8)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 8) = "=AVERAGE(b" & (X + 1) & ":g" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 1) & ":f" & (X - 1) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 7)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 7) = "=AVERAGE(b" & (X + 1) & ":f" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 1) & ":e" & (X - 1) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 6)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 6) = "=AVERAGE(b" & (X + 1) & ":e" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 1) & ":d" & (X - 1) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 5)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 5) = "=AVERAGE(b" & (X + 1) & ":d" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 1) & ":c" & (X - 1) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 4)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 4) = "=AVERAGE(b" & (X + 1) & ":c" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 1) & ":b" & (X - 1) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 3)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 3) = "=AVERAGE(b" & (X + 1) & ":b" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            End If


            Dim _Count As Double
            Dim _nCount As Integer
            _Count = 0
            '  _Count = (worksheet11.Cells(X, 9).Value.ToString)

            If L_DateofMonth = 7 Then
                _Count = (worksheet11.Cells(X, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                _Count = (worksheet11.Cells(X, 8).Value.ToString)


            ElseIf L_DateofMonth = 5 Then
                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If
            _nCount = 0
            Y = 2
            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0

            'worksheet11.Cells(X, 9) = _Count
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '_Count = (worksheet11.Cells(X, 9).Value.ToString)
            'n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
            '_Count = _Count / (MC_Count * (1 - n_per))

            'worksheet11.Cells(X, 9) = _Count
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            'range1 = worksheet11.Cells(X, 9)
            'range1.NumberFormat = "0.0"


            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 4).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 4).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 3).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 3).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0.0"
            End If

            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            End If
            X = X + 1

            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous




            End If
            X = X + 1
            '---------------------------------------------------------------------------------------
            worksheet11.Cells(X, 1) = "No. of batches(with out No work + M/main)"
            worksheet11.Cells(X, 1).WrapText = True

            worksheet11.Cells(X + 1, 1) = " No work + M/main  %"
            worksheet11.Cells(X + 1, 1).WrapText = True

            i = 0
            ' Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2


            i = 0
            '  Dim N_TOTALHR As Integer
            Y = 2
            x_Date = WeekStartdate
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = T04.Tables(0).Rows.Count
                H1 = 0
                For Each DTRow3 As DataRow In T04.Tables(0).Rows
                    Y = 0
                    ' SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine ='" & T04.Tables(0).Rows(H1)("T03Code") & "' and M05Name='No Work' and T03Type ='01' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine = '" & T04.Tables(0).Rows(H1)("T03Code") & "'  and M05Name in ('No Work','PM','MainM') and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type, M05Name" 'CONVERT(VARCHAR(10), T01Date, 120)"
                    T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                    For Each DTRow4 As DataRow In T03.Tables(0).Rows
                        n_per = n_per + T03.Tables(0).Rows(Y)("T01Taken")
                        Y = Y + 1
                    Next
                    H1 = H1 + 1
                Next
                Y = 0

                x_Date = X_Date1
                If n_per > 0 Then
                    N_TOTALHR = MC_Count * 24 * 60
                    n_per = n_per / N_TOTALHR

                    Dim B1 As Double
                    Dim B2 As Double
                    B2 = 0
                    B1 = 1 - n_per
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 3 & ":B" & X - 3 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 2)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X + 1, 2) = n_per

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 3 & ":c" & X - 3 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0"

                        worksheet11.Cells(X + 1, 3) = n_per

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 3 & ":D" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 3 & ":E" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 3 & ":F" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 3 & ":G" & X - 3 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 3 & ":H" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = n_per

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                    B2 = (worksheet11.Cells(X, Y1).Value.ToString)
                    ' B1 = 1 - B1
                    B1 = MC_Count * B1
                    B2 = B2 / B1
                    'B2 = worksheet11.Cells(X, 2)
                    range1 = worksheet11.Cells(X, Y1)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y1) = B2

                Else
                    If i = 1 Then
                        worksheet11.Range("B" & (X)).Formula = "=SUM(B" & X - 3 & ":B" & X - 3 & ")"
                        worksheet11.Cells(X, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 2)
                        range1.NumberFormat = "0"
                        worksheet11.Cells(X + 1, 2) = "0"

                        range1 = worksheet11.Cells(X + 1, 2)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 2).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 2 Then
                        worksheet11.Range("c" & (X)).Formula = "=SUM(c" & X - 3 & ":c" & X - 3 & ") "
                        worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 3)
                        range1.NumberFormat = "0"

                        worksheet11.Cells(X + 1, 3) = "0"

                        range1 = worksheet11.Cells(X + 1, 3)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 3 Then
                        worksheet11.Range("D" & (X)).Formula = "=SUM(D" & X - 3 & ":D" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, 4)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 4 Then
                        worksheet11.Range("E" & (X)).Formula = "=SUM(E" & X - 3 & ":E" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 5 Then
                        worksheet11.Range("F" & (X)).Formula = "=SUM(F" & X - 3 & ":F" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 6 Then
                        worksheet11.Range("G" & (X)).Formula = "=SUM(G" & X - 3 & ":G" & X - 3 & ")"
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    ElseIf i = 7 Then
                        worksheet11.Range("H" & (X)).Formula = "=SUM(H" & X - 3 & ":H" & X - 3 & ") "
                        worksheet11.Cells(X, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                        range1 = worksheet11.Cells(X, Y1)
                        range1.NumberFormat = "0.0"

                        worksheet11.Cells(X + 1, Y1) = "0"

                        range1 = worksheet11.Cells(X + 1, Y1)
                        range1.NumberFormat = "0%"
                        worksheet11.Cells(X + 1, Y1).HorizontalAlignment = XlHAlign.xlHAlignCenter
                    End If
                End If
                Y1 = Y1 + 1
            Next

            ' X = X - 1
            'range1 = worksheet11.Cells(X, 9)
            'range1.NumberFormat = "0"
            'worksheet11.Cells(X, 9) = "=SUM(b" & (X - 3) & ":h" & (X - 3) & ")"
            'worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            'range1 = worksheet11.Cells(X + 1, 9)
            'range1.NumberFormat = "0%"
            'worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
            'worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            If L_DateofMonth = 7 Then
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 9) = "=SUM(b" & (X - 3) & ":h" & (X - 3) & ")"
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 9)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 9) = "=AVERAGE(b" & (X + 1) & ":h" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 9).Value.ToString)
            ElseIf L_DateofMonth = 6 Then
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 8) = "=SUM(b" & (X - 3) & ":g" & (X - 3) & ")"
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 8)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 8) = "=AVERAGE(b" & (X + 1) & ":g" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 8).Value.ToString)
            ElseIf L_DateofMonth = 5 Then
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 7) = "=SUM(b" & (X - 3) & ":f" & (X - 3) & ")"
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 7)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 7) = "=AVERAGE(b" & (X + 1) & ":f" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 7).Value.ToString)
            ElseIf L_DateofMonth = 4 Then
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 6) = "=SUM(b" & (X - 3) & ":e" & (X - 3) & ")"
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 6)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 6) = "=AVERAGE(b" & (X + 1) & ":e" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 6).Value.ToString)
            ElseIf L_DateofMonth = 3 Then
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 5) = "=SUM(b" & (X - 3) & ":d" & (X - 3) & ")"
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 5)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 5) = "=AVERAGE(b" & (X + 1) & ":d" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 5).Value.ToString)
            ElseIf L_DateofMonth = 2 Then
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 4) = "=SUM(b" & (X - 3) & ":c" & (X - 3) & ")"
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 4)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 4) = "=AVERAGE(b" & (X + 1) & ":c" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 4).Value.ToString)
            ElseIf L_DateofMonth = 1 Then
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0"
                worksheet11.Cells(X, 3) = "=SUM(b" & (X - 3) & ":b" & (X - 3) & ")"
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                range1 = worksheet11.Cells(X + 1, 3)
                range1.NumberFormat = "0%"
                worksheet11.Cells(X + 1, 3) = "=AVERAGE(b" & (X + 1) & ":b" & (X + 1) & ")"
                worksheet11.Cells(X + 1, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter


                _Count = 0
                _Count = (worksheet11.Cells(X, 3).Value.ToString)
            End If
            '_Count = 0
            '_Count = (worksheet11.Cells(X, 9).Value.ToString)

            'If L_DateofMonth = 7 Then
            '    worksheet11.Cells(X, 9) = _Count
            '    worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 9).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 9) = _Count
            '    worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 9)
            '    range1.NumberFormat = "0.0"
            'ElseIf L_DateofMonth = 6 Then
            '    worksheet11.Cells(X, 8) = _Count
            '    worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 8).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 8) = _Count
            '    worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 8)
            '    range1.NumberFormat = "0.0"
            'ElseIf L_DateofMonth = 5 Then
            '    worksheet11.Cells(X, 7) = _Count
            '    worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 7).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 7) = _Count
            '    worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 7)
            '    range1.NumberFormat = "0.0"
            'ElseIf L_DateofMonth = 4 Then
            '    worksheet11.Cells(X, 6) = _Count
            '    worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 6).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 6) = _Count
            '    worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 6)
            '    range1.NumberFormat = "0.0"
            'ElseIf L_DateofMonth = 3 Then
            '    worksheet11.Cells(X, 5) = _Count
            '    worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 5).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 5) = _Count
            '    worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 5)
            '    range1.NumberFormat = "0.0"
            'ElseIf L_DateofMonth = 2 Then
            '    worksheet11.Cells(X, 4) = _Count
            '    worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 4).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 4).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 4) = _Count
            '    worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 4)
            '    range1.NumberFormat = "0.0"
            'ElseIf L_DateofMonth = 1 Then
            '    worksheet11.Cells(X, 3) = _Count
            '    worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

            '    _Count = (worksheet11.Cells(X, 3).Value.ToString)
            '    n_per = (worksheet11.Cells(X + 1, 3).Value.ToString)
            '    _Count = _Count / (MC_Count * (1 - n_per))

            '    worksheet11.Cells(X, 3) = _Count
            '    worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
            '    range1 = worksheet11.Cells(X, 3)
            '    range1.NumberFormat = "0.0"
            'End If

            'If L_DateofMonth = 7 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(146, 208, 80)
            'ElseIf L_DateofMonth = 6 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(146, 208, 80)
            'ElseIf L_DateofMonth = 5 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(146, 208, 80)
            'ElseIf L_DateofMonth = 4 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            '    worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(146, 208, 80)
            'ElseIf L_DateofMonth = 3 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(146, 208, 80)
            'ElseIf L_DateofMonth = 2 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(146, 208, 80)
            'ElseIf L_DateofMonth = 1 Then
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            '    worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            '    worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(146, 208, 80)
            'End If


            x_Date = WeekStartdate
            MC_Count = 0
            '  Dim y1 As Integer
            Y1 = 2
            For i = 1 To L_DateofMonth
                Y = 0
                n_per = 0
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                Y = 0

                'Dim MC_Count As Integer
                Dim H1 As Integer
                '  MC_Count = 0

                SQL = "SELECT T03Code,count(T03Name) as T03Name FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
           "  INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code inner join M08Sub_Shade on M08Code=m04Shade_Type WHERE T03TYPE IN ('02') and " & _
   " M04ETime between '" & x_Date & "' and '" & X_Date1 & "' and M04ProgrameType in ('N','R','S')   and M04Batchwt>0 and m08CL='Colour' " & _
  "group by T03code"
                T04 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                MC_Count = MC_Count + T04.Tables(0).Rows.Count
                x_Date = X_Date1
            Next
            ' _Count = _Count / MC_Count
            Y = 0
            n_per = 0
            MC_Count = 9 * L_DateofMonth
            If L_DateofMonth = 7 Then
                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 9).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 9).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 9) = _Count
                worksheet11.Cells(X, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 9)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 8).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 8).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 8) = _Count
                worksheet11.Cells(X, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 8)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 7).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 7).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 7) = _Count
                worksheet11.Cells(X, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 7)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 6).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 6).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 6) = _Count
                worksheet11.Cells(X, 6).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 6)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 5).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 5).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 5) = _Count
                worksheet11.Cells(X, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 5)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 4).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 4).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 4) = _Count
                worksheet11.Cells(X, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 4)
                range1.NumberFormat = "0.0"
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter

                _Count = (worksheet11.Cells(X, 3).Value.ToString)
                n_per = (worksheet11.Cells(X + 1, 3).Value.ToString)
                _Count = _Count / (MC_Count * (1 - n_per))

                worksheet11.Cells(X, 3) = _Count
                worksheet11.Cells(X, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                range1 = worksheet11.Cells(X, 3)
                range1.NumberFormat = "0.0"
            End If

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(146, 208, 80)

            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(146, 208, 80)
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(146, 208, 80)
            End If
            X = X + 1

            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous



            End If
            'X = X + 3
            ''------------------------------------------------------------------------------

            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            X = X + 3
            worksheet11.Cells(X, 1) = "Non bio-polish batches per day  without delay "
            worksheet11.Cells(X, 1).WrapText = True

            Dim _STD As Double

            _STD = 0
            x_Date = WeekStartdate
            Y = 2
            For i = 1 To L_DateofMonth

                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                     " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                     "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                       " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")
                Else
                    _STD = 0
                End If
                If _STD > 0 Then
                    range1 = worksheet11.Cells(X, Y)
                    range1.NumberFormat = "0.0"
                    worksheet11.Cells(X, Y) = 24 / _STD
                    worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                End If

                x_Date = X_Date1
                Y = Y + 1
            Next
            '--------------------------------------------------------------------------------------


            ' X = X + 1
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(234, 241, 221)
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(234, 241, 221)

            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(234, 241, 221)

                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(234, 241, 221)


            End If
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDot
            'worksheet11.Range("i" & X & ":i" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            'worksheet11.Range("i" & X & ":i" & X).Interior.Color = RGB(194, 214, 154)


            X = X + 1

            worksheet11.Cells(X, 1) = "Non bio-polish Batches per day                           "
            worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(0, 0, 255)

            Dim n_Taken As Double
            Dim n_Count As Integer
            Dim M1 As Integer

            Y = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_Date & "' and '" & X_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                n_Count = 0
                n_Taken = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                N_TOTALHR = 9 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 9
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = 0
                'Non Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)<>'B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                If _STD > 0 Then
                    worksheet11.Cells(X, Y) = n_Taken / _STD
                    ' worksheet11.Cells(X, 1).WrapText = True
                End If

                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(0, 0, 255)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                Y = Y + 1
                x_Date = X_Date1
            Next



            ' worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(215, 228, 188)
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(215, 228, 188)

            ElseIf L_DateofMonth = 1 Then

                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(215, 228, 188)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(215, 228, 188)


            End If

            X = X + 1
            worksheet11.Cells(X, 1) = "Bio-polish Batches per day                        "
            worksheet11.Cells(X, 1).WrapText = True


            range1 = worksheet11.Cells(X, 1)
            range1.Font.Color = RGB(255, 0, 0)



            Y = 2
            x_Date = WeekStartdate
            For i = 1 To L_DateofMonth
                X_Date1 = CDate(x_Date).AddDays(+1)
                If i = 1 Then
                    ' x_Date = x_Date & " " & "7:30 AM"
                    x_Date = x_Date & " " & "7:30AM"
                    X_Date1 = X_Date1 & " " & "7:30AM"
                End If
                SQL = "SELECT CONVERT(VARCHAR(10) , M04Date_Out, 120)as [Ddate],SUM(M04Taken) as Taken,MAX(M01Description),count(T03TYPE) as nCount FROM M04Lot INNER JOIN T03Machine ON M04Machine_No=T03Code " & _
          "INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code WHERE M04ProgrameType='B' AND T03TYPE IN ('02') and M04ETime between '" & x_Date & "' and '" & X_Date1 & "' GROUP BY CONVERT(VARCHAR(10) , M04Date_Out, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)

                n_Count = 0
                n_Taken = 0
                M1 = 0
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_Count = n_Count + Val(T03.Tables(0).Rows(M1)("ncount"))
                    n_Taken = n_Taken + Val(T03.Tables(0).Rows(M1)("Taken"))
                    M1 = M1 + 1
                Next
                n_Taken = n_Taken / 60
                n_Taken = n_Taken / 9
                '-------------------------------------------------------------------------
                'TECHD
                M1 = 0
                n_per = 0
                SQL = "select SUM(T01Taken) AS T01Taken from T01Down_Time inner join M05DownTime on T01Down_Time=M05code inner join T03Machine on T01Machine=T03code where T01Machine NOT IN ('18','19','20') and M05Name in ('TechD','Fabric') and T03Type ='02' AND T01DATE BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' GROUP BY T03Type" 'CONVERT(VARCHAR(10), T01Date, 120)"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                For Each DTRow4 As DataRow In T03.Tables(0).Rows
                    n_per = n_per + T03.Tables(0).Rows(M1)("T01Taken")
                    M1 = M1 + 1
                Next
                ' x_Date = X_Date1
                N_TOTALHR = 9 * 24 * 60
                n_per = n_per / N_TOTALHR
                n_per = n_per * 216
                n_per = n_per / 9
                '-----------------------------------------------------
                'Fabric
                n_Taken = n_Taken + n_per
                n_Taken = 24 - n_Taken

                _STD = 0
                'Bio polish STD Time
                SQL = "select COUNT(M08CL) AS CCOUNT,sum(M04STD) as STD from m04lot INNER JOIN T03Machine ON M04Machine_No=T03Code INNER JOIN M01Dyeing_MC_Type ON T03TYPE=M01Code " & _
                    " INNER JOIN M09Quality ON LTRIM(M09Code)=LTRIM(M04Quality) inner join M08Sub_Shade on M08Code=M04Shade_Type " & _
                    "WHERE  T03TYPE IN ('02') and M04ProgrameType='N' AND M04Batchwt>0 AND M08CL='Colour' AND M08SubName IN ('Extra Dark','LIGHT','DARK','Medium') " & _
                      " AND M04eTIME BETWEEN '" & x_Date & "' AND '" & X_Date1 & "' AND M09TYPE<>'VISCOSE' AND LEFT(M09DIS,1)='B' GROUP BY M08CL"
                T03 = DBEngin.ExecuteDataset(con, Nothing, SQL)
                If isValidDataset(T03) Then
                    _STD = T03.Tables(0).Rows(0)("STD")
                    _STD = _STD / 60
                    _STD = _STD / T03.Tables(0).Rows(0)("CCount")

                End If
                If _STD > 0 Then
                    worksheet11.Cells(X, Y) = n_Taken / _STD
                    ' worksheet11.Cells(X, 1).WrapText = True
                End If

                range1 = worksheet11.Cells(X, Y)
                range1.NumberFormat = "0.0"
                range1.Font.Color = RGB(255, 0, 0)
                worksheet11.Cells(X, Y).HorizontalAlignment = XlHAlign.xlHAlignCenter
                Y = Y + 1
                x_Date = X_Date1
            Next


            If L_DateofMonth = 7 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("h" & X & ":h" & X).Interior.Color = RGB(194, 214, 154)
            ElseIf L_DateofMonth = 6 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("g" & X & ":g" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("g" & X & ":g" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 5 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("f" & X & ":f" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("f" & X & ":f" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 4 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

                '  worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("e" & X & ":e" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("e" & X & ":e" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 3 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("d" & X & ":d" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("d" & X & ":d" & X).Interior.Color = RGB(194, 214, 154)

            ElseIf L_DateofMonth = 2 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("c" & X & ":c" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("c" & X & ":c" & X).Interior.Color = RGB(194, 214, 154)
            ElseIf L_DateofMonth = 1 Then
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("A" & X & ":a" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("a" & X & ":a" & X).Interior.Color = RGB(194, 214, 154)

                ' worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet11.Range("b" & X & ":b" & X).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
                worksheet11.Range("b" & X & ":b" & X).Interior.Color = RGB(194, 214, 154)


            End If
            Dim chartPage As Microsoft.Office.Interop.Excel.Chart
            Dim xlCharts As Microsoft.Office.Interop.Excel.ChartObjects
            Dim myChart As Microsoft.Office.Interop.Excel.ChartObject
            Dim chartRange As Microsoft.Office.Interop.Excel.Range
            Dim chartRange1 As Microsoft.Office.Interop.Excel.Range
            Dim chartRange2 As Microsoft.Office.Interop.Excel.Range


            Dim t_SerCol As Microsoft.Office.Interop.Excel.SeriesCollection
            Dim t_Series As Microsoft.Office.Interop.Excel.Series
            Dim z1 As Integer
            Dim sh As Worksheet
            xlCharts = worksheet11.ChartObjects

            Dim _Chartlocation As Integer
            Dim rh As Double
            Dim r As Integer
            rh = 0

            rh = (X - 5) * 15
            rh = rh + (30 * 4)
            rh = rh + 18.75
            _Chartlocation = (X + 25) * 10

            myChart = xlCharts.Add(6, rh, 905, 300)
            chartPage = myChart.Chart
            Dim _CH As Integer
            '_CH = 7
            'For _CH = 7 To x - 1
            If L_DateofMonth = 7 Then
                chartRange = worksheet11.Range("b16", "H16")
                chartRange1 = worksheet11.Range("b3", "h3")
            ElseIf L_DateofMonth = 6 Then
                chartRange = worksheet11.Range("b16", "g16")
                chartRange1 = worksheet11.Range("b3", "g3")
            ElseIf L_DateofMonth = 5 Then
                chartRange = worksheet11.Range("b16", "f16")
                chartRange1 = worksheet11.Range("b3", "f3")
            ElseIf L_DateofMonth = 4 Then
                chartRange = worksheet11.Range("b16", "e16")
                chartRange1 = worksheet11.Range("b3", "e3")
            ElseIf L_DateofMonth = 3 Then
                chartRange = worksheet11.Range("b16", "d16")
                chartRange1 = worksheet11.Range("b3", "d3")
            ElseIf L_DateofMonth = 2 Then
                chartRange = worksheet11.Range("b16", "c16")
                chartRange1 = worksheet11.Range("b3", "c3")
            ElseIf L_DateofMonth = 1 Then
                chartRange = worksheet11.Range("b16", "b16")
                chartRange1 = worksheet11.Range("b3", "b3")
            End If
            'chartRange = worksheet1.Range("H8", "K" & (X - 1))
            'chartRange = worksheet1.Range("H8:K39", "A9:A39")
            ' chartPage.SetSourceData(Source:=chartRange)
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "No of Baches per day (All)"
                t_Series.XValues = chartRange1 '("=Friction!R11C1:R17C1") 'Reference a valid RANGE
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 0, 0)
            chartPage.Refresh()
            chartPage.SeriesCollection(1).Interior.Color = RGB(255, 0, 0)
            'chartPage.HasTitle = True
            'chartPage.ChartTitle.Text = ("White & Mal")
            'chartPage.Refresh()

            'chartPage.Refresh()
            If L_DateofMonth = 7 Then
                chartRange = worksheet11.Range("b21", "H21")
            ElseIf L_DateofMonth = 6 Then
                chartRange = worksheet11.Range("b21", "g21")
            ElseIf L_DateofMonth = 5 Then
                chartRange = worksheet11.Range("b21", "f21")
            ElseIf L_DateofMonth = 4 Then
                chartRange = worksheet11.Range("b21", "e21")
            ElseIf L_DateofMonth = 3 Then
                chartRange = worksheet11.Range("b21", "d21")
            ElseIf L_DateofMonth = 2 Then
                chartRange = worksheet11.Range("b21", "c21")
            ElseIf L_DateofMonth = 1 Then
                chartRange = worksheet11.Range("b21", "b21")
            End If
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Non bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(0, 153, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(2).Interior.Color = RGB(0, 153, 0)

            'Dark
            If L_DateofMonth = 7 Then
                chartRange = worksheet11.Range("b22", "H22")
            ElseIf L_DateofMonth = 6 Then
                chartRange = worksheet11.Range("b22", "g22")
            ElseIf L_DateofMonth = 5 Then
                chartRange = worksheet11.Range("b22", "f22")
            ElseIf L_DateofMonth = 4 Then
                chartRange = worksheet11.Range("b22", "e22")
            ElseIf L_DateofMonth = 3 Then
                chartRange = worksheet11.Range("b22", "d22")
            ElseIf L_DateofMonth = 2 Then
                chartRange = worksheet11.Range("b22", "c22")
            ElseIf L_DateofMonth = 1 Then
                chartRange = worksheet11.Range("b22", "b22")
            End If
            t_SerCol = chartPage.SeriesCollection
            t_Series = t_SerCol.NewSeries
            With t_Series
                .Name = "Bio-polish Batches per day "
                t_Series.Values = chartRange '("=Friction!R11C2:R17C2") 'Reference a valid RANGE

            End With
            t_Series.Border.Color = RGB(255, 192, 0)
            ' chartPage.Refresh()
            chartPage.SeriesCollection(3).Interior.Color = RGB(255, 192, 0)
            chartPage.ChartType = Microsoft.Office.Interop.Excel.XlChartType.xlLine
        End If




        worksheet11.Rows(4).Select()
        worksheet11.Application.ActiveWindow.FreezePanes = True

           

    End Function

   
    Private Sub cmdEdit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmdEdit.Click

    End Sub
End Class