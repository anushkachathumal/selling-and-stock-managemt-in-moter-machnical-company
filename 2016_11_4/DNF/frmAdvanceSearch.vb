Imports System.Data.SqlClient
Imports Infragistics.Win.UltraWinGrid
Imports DBLotVbnet.common
Imports System.Net
Imports DBLotVbnet.DBEngin
Imports Microsoft.Office.Interop.Excel
Imports System.Drawing
Imports Spire.XlS
Public Class frmAdvanceSearch
    Inherits System.Windows.Forms.Form
    Dim dsUser As DataSet
    Dim Clicked As String
    Dim _EralCode As Integer
    Dim _MCNo As String
    Dim c_dataCustomer1 As System.Data.DataTable
    Dim oFile As System.IO.File
    Dim oWrite As System.IO.StreamWriter
    Dim exc As New Application

    Dim workbooks As Workbooks = exc.Workbooks
    Dim workbook As _Workbook = Workbooks.Add(XlWBATemplate.xlWBATWorksheet)
    Dim sheets As Sheets = Workbook.Worksheets
    Dim worksheet1 As _Worksheet = CType(Sheets.Item(1), _Worksheet)
    Private Sub frmAdvanceSearch_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Call Load_Gride()
        Call Load_MGroup()
        Call Load_DyeProgramme()
        Call Load_Quality()
        Call Load_Shade()

    End Sub

    Private Sub cmdAdd_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdAdd.Click
        Clicked = "ADD"
        OPR0.Enabled = True
        OPR2.Enabled = True
        OPR1.Enabled = True
        OPR3.Enabled = True
        OPR4.Enabled = True
        OPR5.Enabled = True
        'OPR9.Enabled = True
        txtFromDate.Text = Today
        txtTodate.Text = Today
        chkWJ.Checked = True
        ' Call Clear_Text()
        cmdAdd.Enabled = False
        'cboBatch.ToggleDropdown()
        'Call Search_RefNo()\
        cmdEdit.Enabled = True
        Call Load_Gride()
    End Sub

    Private Sub UltraCheckEditor11_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkMedium.CheckedChanged

    End Sub

    Private Sub chkAll_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkAll.CheckedChanged
        If chkAll.Checked = True Then
            chkAF.Checked = False

            chkWJ.Checked = False

            chk10.Enabled = True
            chk12.Enabled = True
            chk13.Enabled = True
            chk14.Enabled = True
            chk15.Enabled = True
            chk16.Enabled = True
            chk17.Enabled = True
            chk18.Enabled = True
            chk19.Enabled = True
            chk20.Enabled = True
            chk21.Enabled = True
            chk22.Enabled = True
            chk23.Enabled = True
            chk31.Enabled = True
            chk32.Enabled = True
            chk33.Enabled = True
            chk34.Enabled = True
            chk35.Enabled = True
            chk36.Enabled = True
            chk37.Enabled = True
            chk38.Enabled = True
            chk39.Enabled = True

            CHK1.Enabled = True
            chk2.Checked = True
            chk3.Checked = True
            chk4.Checked = True
            chk5.Checked = True
            chk6.Checked = True
            chk7.Checked = True
            chk8.Checked = True
            chk9.Checked = True
            chk10.Checked = True


        End If
    End Sub

    Function Load_Gride()
        Dim CustomerDataClass As New DAL_InterLocation()
        c_dataCustomer1 = CustomerDataClass.MakeDataTableAdvance
        UltraGrid1.DataSource = c_dataCustomer1
        With UltraGrid1
            .DisplayLayout.Bands(0).Columns(0).Width = 90
            .DisplayLayout.Bands(0).Columns(1).AutoEdit = False
            .DisplayLayout.Bands(0).Columns(1).Width = 90
            .DisplayLayout.Bands(0).Columns(1).AutoEdit = False
            .DisplayLayout.Bands(0).Columns(2).Width = 110
            .DisplayLayout.Bands(0).Columns(3).Width = 90
            .DisplayLayout.Bands(0).Columns(4).Width = 90
            .DisplayLayout.Bands(0).Columns(5).Width = 90
            .DisplayLayout.Bands(0).Columns(6).Width = 110
            .DisplayLayout.Bands(0).Columns(7).Width = 80

            ' .DisplayLayout.Bands(0).Columns(3).Width = 300
            '.DisplayLayout.Bands(0).Columns(4).Width = 300
        End With
    End Function

    Private Sub cboLot_InitializeLayout(ByVal sender As System.Object, ByVal e As Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs) Handles cboMgroup.InitializeLayout

    End Sub

    Function Load_MGroup()
        Dim Sql As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim M01 As DataSet
        Try
            Sql = "select M02Name as [Machine Group] from M02Group "
            M01 = DBEngin.ExecuteDataset(con, Nothing, Sql)
            If isValidDataset(M01) Then
                With cboMgroup
                    .DataSource = M01
                    .Rows.Band.Columns(0).Width = 145
                End With
            End If

        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try
    End Function

    Function Load_DyeProgramme()
        Dim Sql As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim M01 As DataSet
        Try
            Sql = "select M04Program  as [Dye Programme] from M04Lot where M04Program<>'0' group by M04Program "
            M01 = DBEngin.ExecuteDataset(con, Nothing, Sql)
            If isValidDataset(M01) Then
                With cboDye
                    .DataSource = M01
                    .Rows.Band.Columns(0).Width = 145
                End With
            End If

        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try
    End Function

    Function Load_Quality()
        Dim Sql As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim M01 As DataSet
        Try
            Sql = "select M04Quality  as [Quality] from M04Lot where (M04Quality)<>'' group by M04Quality"
            M01 = DBEngin.ExecuteDataset(con, Nothing, Sql)
            If isValidDataset(M01) Then
                With cboQuality
                    .DataSource = M01
                    .Rows.Band.Columns(0).Width = 175
                End With
            End If

        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try
    End Function

    Function Load_Shade()
        Dim Sql As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim M01 As DataSet
        Try
            Sql = "select M04Shade_code  from M04Lot where (M04Shade_code)<>''  group by M04Shade_code"
            M01 = DBEngin.ExecuteDataset(con, Nothing, Sql)
            If isValidDataset(M01) Then
                With cboShade
                    .DataSource = M01
                    .Rows.Band.Columns(0).Width = 195
                End With
            End If

        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try
    End Function

    Private Sub cboMgroup_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles cboMgroup.KeyUp
        If e.KeyCode = 13 Then
            cboDye.ToggleDropdown()
        End If
    End Sub

    Private Sub cboDye_InitializeLayout(ByVal sender As System.Object, ByVal e As Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs) Handles cboDye.InitializeLayout

    End Sub

    Private Sub cboDye_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles cboDye.KeyUp
        If e.KeyCode = 13 Then
            cboQuality.ToggleDropdown()

        End If
    End Sub

    Private Sub cboQuality_InitializeLayout(ByVal sender As System.Object, ByVal e As Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs) Handles cboQuality.InitializeLayout

    End Sub

    Private Sub cboQuality_KeyUp(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles cboQuality.KeyUp
        If e.KeyCode = 13 Then
            cboShade.ToggleDropdown()

        End If
    End Sub

    Private Sub chkWJ_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkWJ.CheckedChanged
        If chkWJ.Checked = True Then
            chkAF.Checked = False

            chkAll.Checked = False

            chk10.Enabled = True
            chk12.Enabled = True
            chk13.Enabled = True
            chk14.Enabled = True
            chk15.Enabled = True
            chk16.Enabled = True
            chk17.Enabled = True
            chk18.Enabled = True
            chk19.Enabled = True
            chk20.Enabled = True
            chk21.Enabled = True
            chk22.Enabled = True
            chk23.Enabled = True
            chk31.Enabled = True
            chk32.Enabled = True
            chk33.Enabled = True
            chk34.Enabled = True
            chk35.Enabled = True
            chk36.Enabled = True
            chk37.Enabled = True
            chk38.Enabled = True
            chk39.Enabled = True
        End If
    End Sub

    Private Sub chkAF_CheckedChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles chkAF.CheckedChanged
        If chkAF.Checked = True Then
            chkWJ.Checked = False

            chkAll.Checked = False

            'chk12.Enabled = False
            'chk13.Enabled = False
            'chk14.Enabled = False
            'chk15.Enabled = False
            'chk16.Enabled = False
            'chk17.Enabled = False
            'chk18.Enabled = False
            'chk19.Enabled = False
            'chk20.Enabled = False
            'chk21.Enabled = False
            'chk22.Enabled = False
            'chk23.Enabled = False
            'CHK1.Enabled = False
            'chk2.Enabled = False
            'chk3.Enabled = False
            'chk4.Enabled = False
            'chk5.Enabled = False
            'chk6.Enabled = False
            'chk7.Enabled = False
            'chk8.Enabled = False
            'chk9.Enabled = False
            'chk10.Enabled = False
        End If
    End Sub

    Private Sub cmdEdit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdEdit.Click
        Dim _ShadeCategory As String
        Dim _Light As String
        Dim _Dark As String
        Dim _Exdark As String
        Dim _White As String
        Dim _Mal As String
        Dim _Yarn As String
        Dim _Medium As String
        Dim _Programm_Type As String
        Dim _Quality As String
        Dim _MC As String

        Dim Sql As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim M01 As DataSet

        Dim I As Integer
        Load_Gride()

        Try
            'SHADE CATEGORY

            If chkLight.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Light'"
                Else
                    _ShadeCategory = "'Light'"

                End If
            End If

            If chkDark.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Dark'"
                Else
                    _ShadeCategory = "'Dark'"

                End If
            End If

            If chkEDark.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Extra Dark'"
                Else
                    _ShadeCategory = "'Extra Dark'"

                End If
            End If

            If chkMedium.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Medium'"
                Else
                    _ShadeCategory = "'Medium'"

                End If
            End If

            If chkWhite.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'White'"
                Else
                    _ShadeCategory = "'White'"

                End If
            End If

            If chkMal.Checked = True Or chkYarn.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'MARL & Yarn dye'"
                Else
                    _ShadeCategory = "'MARL & Yarn dye'"

                End If
            End If

            '--------------------------------------------------------------------------------------------
            'PROGRAMME TYPE
            If chkNomal.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'N'"
                Else
                    _Programm_Type = "'N'"

                End If
            End If

            If chkRedye.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'R'"
                Else
                    _Programm_Type = "'R'"

                End If
            End If

            If chkStrip.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'S'"
                Else
                    _Programm_Type = "'S'"

                End If
            End If

            If chkWash.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'W'"
                Else
                    _Programm_Type = "'W'"

                End If
            End If

            If chkOther.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'O'"
                Else
                    _Programm_Type = "'O'"

                End If
            End If

            '-----------------------------------------------------------------------------------
            'QUALITY
            If chkViscose.Checked = True Then
                If _Quality <> "" Then
                    _Quality = _Quality & ",'VISCOSE'"
                Else
                    _Quality = "'VISCOSE'"

                End If
            End If

            If chkBiopolish.Checked = True Or chkNonBio.Checked = True Then
                If _Quality <> "" Then
                    _Quality = _Quality & ",'COTTON'"
                Else
                    _Quality = "'COTTON'"

                End If
            End If

            If chkPoly.Checked = True Or chkPoly.Checked = True Then
                If _Quality <> "" Then
                    _Quality = _Quality & ",'POLY'"
                Else
                    _Quality = "'POLY'"

                End If
            End If
            '----------------------------------------------------------------------------------------
            'MACHINE
            If chkWJ.Checked = True Then
                If chk2.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'2'"
                    Else
                        _MC = "'2'"

                    End If
                End If

                If chk4.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'4'"
                    Else
                        _MC = "'4'"

                    End If
                End If

                If chk6.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'6'"
                    Else
                        _MC = "'6'"

                    End If
                End If

                If chk7.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'7'"
                    Else
                        _MC = "'7'"

                    End If
                End If

                If chk8.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'8'"
                    Else
                        _MC = "'8'"

                    End If
                End If

                If chk9.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'9'"
                    Else
                        _MC = "'9'"

                    End If
                End If

                If chk10.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'10'"
                    Else
                        _MC = "'10'"

                    End If
                End If

                If chk12.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'12'"
                    Else
                        _MC = "'12'"

                    End If
                End If

                If chk13.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'13'"
                    Else
                        _MC = "'13'"

                    End If
                End If

                If chk14.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'14'"
                    Else
                        _MC = "'14'"

                    End If
                End If

                If chk15.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'15'"
                    Else
                        _MC = "'15'"

                    End If
                End If

                If chk16.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'16'"
                    Else
                        _MC = "'16'"

                    End If
                End If

                If chk17.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'17'"
                    Else
                        _MC = "'17'"

                    End If
                End If

                If chk18.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'18'"
                    Else
                        _MC = "'18'"

                    End If
                End If

                If chk19.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'19'"
                    Else
                        _MC = "'19'"

                    End If
                End If

                If chk20.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'20'"
                    Else
                        _MC = "'20'"

                    End If
                End If

                If chk21.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'21'"
                    Else
                        _MC = "'21'"

                    End If
                End If

                If chk22.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'22'"
                    Else
                        _MC = "'22'"

                    End If
                End If

                If chk23.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'23'"
                    Else
                        _MC = "'23'"

                    End If
                End If

                If chk31.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'31'"
                    Else
                        _MC = "'31'"

                    End If
                End If

                If chk32.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'32'"
                    Else
                        _MC = "'32'"

                    End If
                End If

                If chk33.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'33'"
                    Else
                        _MC = "'33'"

                    End If
                End If

                If chk34.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'34'"
                    Else
                        _MC = "'34'"

                    End If
                End If

                If chk35.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'35'"
                    Else
                        _MC = "'35'"

                    End If
                End If

                If chk36.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'36'"
                    Else
                        _MC = "'36'"

                    End If
                End If

                If chk37.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'37'"
                    Else
                        _MC = "'37'"

                    End If
                End If

                If chk38.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'38'"
                    Else
                        _MC = "'38'"

                    End If
                End If

                If chk39.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'39'"
                    Else
                        _MC = "'39'"

                    End If
                End If
            ElseIf chkAF.Checked = True Then
                If chk31.Checked = True Then
                    _MC = "'31'"
                End If

                If chk32.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'32'"
                    Else
                        _MC = "'32'"

                    End If
                End If

                If chk33.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'33'"
                    Else
                        _MC = "'33'"

                    End If
                End If
                If chk34.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'34'"
                    Else
                        _MC = "'34'"

                    End If


                End If

                If chk35.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'35'"
                    Else
                        _MC = "'35'"

                    End If
                End If

                If chk36.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'36'"
                    Else
                        _MC = "'36'"

                    End If
                End If

                If chk38.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'38'"
                    Else
                        _MC = "'38'"

                    End If
                End If

                If chk37.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'37'"
                    Else
                        _MC = "'37'"

                    End If
                End If

                If chk39.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'39'"
                    Else
                        _MC = "'39'"

                    End If
                End If
                ElseIf chkAll.Checked = True Then
                If CHK1.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'1'"
                    Else
                        _MC = "'1'"

                    End If
                End If

                If chk2.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'2'"
                    Else
                        _MC = "'2'"

                    End If
                End If

                    If chk3.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'3'"
                        Else
                        _MC = "'3'"

                        End If
                    End If

                    If chk4.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'4'"
                        Else
                        _MC = "'4'"

                        End If
                    End If

                    If chk5.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'5'"
                        Else
                        _MC = "'5'"

                        End If
                    End If

                    If chk6.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'6'"
                        Else
                        _MC = "'6'"

                        End If

                    End If

                    If chk7.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'7'"
                        Else
                        _MC = "'7'"

                        End If
                    End If

                    If chk8.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'8'"
                        Else
                        _MC = "'8'"

                        End If
                    End If

                    If chk9.Checked = True Then
                        If _MC <> "" Then
                        _MC = _MC & ",'9'"
                        Else
                        _MC = "'9'"

                        End If
                    End If

                If chk10.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'10'"
                    Else
                        _MC = "'10'"

                    End If
                End If

                If chk12.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'12'"
                    Else
                        _MC = "'12'"

                    End If
                End If

                If chk13.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'13'"
                    Else
                        _MC = "'13'"

                    End If
                End If

                If chk14.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'14'"
                    Else
                        _MC = "'14'"

                    End If
                End If

                If chk15.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'15'"
                    Else
                        _MC = "'15'"

                    End If
                End If

                If chk16.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'16'"
                    Else
                        _MC = "'16'"

                    End If
                End If

                If chk17.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'17'"
                    Else
                        _MC = "'17'"

                    End If
                End If

                If chk18.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'18'"
                    Else
                        _MC = "'18'"

                    End If
                End If

                If chk19.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'19'"
                    Else
                        _MC = "'19'"

                    End If
                End If

                If chk20.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'20'"
                    Else
                        _MC = "'20'"

                    End If
                End If

                If chk21.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'21'"
                    Else
                        _MC = "'21'"

                    End If
                End If

                If chk22.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'22'"
                    Else
                        _MC = "'22'"

                    End If
                End If

                If chk23.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'23'"
                    Else
                        _MC = "'23'"

                    End If
                End If

                If chk31.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'31'"
                    Else
                        _MC = "'31'"

                    End If
                End If

                If chk32.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'32'"
                    Else
                        _MC = "'32'"

                    End If
                End If

                If chk33.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'33'"
                    Else
                        _MC = "'33'"

                    End If
                End If

                If chk34.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'34'"
                    Else
                        _MC = "'34'"

                    End If
                End If

                If chk35.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'35'"
                    Else
                        _MC = "'35'"

                    End If
                End If

                If chk36.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'36'"
                    Else
                        _MC = "'36'"

                    End If
                End If

                If chk37.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'37'"
                    Else
                        _MC = "'37'"

                    End If
                End If

                If chk38.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'38'"
                    Else
                        _MC = "'38'"

                    End If
                End If

                If chk39.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'39'"
                    Else
                        _MC = "'39'"

                    End If
                End If


                End If
                '----------------------------------------------------------------------------------------
                Dim _FromTime As Date
                Dim _ToTime As Date

                _FromTime = txtFromDate.Text & " " & "7:30AM"
                _ToTime = txtTodate.Text & " " & "7:30AM"

                If _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------
                    'WITH OUT SHADE AND WITH MACHINE
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in ('" & _MC & "')"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in ('" & _MC & "')"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in ('" & _MC & "')"

                    End If

                    '-----------------------------------------------------------------------------------------------------------------
                    'WITH OUT SHADE AND WITHOUT MACHINE

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'  "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' )"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                    End If
                    '------------------------------------------------------------------------------------------------------------------------------------------------------------

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And cboDye.Text <> "" And _ShadeCategory <> "" And cboMgroup.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M08SubName in (" & _ShadeCategory & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Program='" & cboDye.Text & "' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ") and T03Group='" & cboMgroup.Text & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M08SubName in (" & _ShadeCategory & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Program='" & cboDye.Text & "' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ") and T03Group='" & cboMgroup.Text & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and  M04Quality='" & Trim(cboQuality.Text) & "' and M04Program='" & cboDye.Text & "' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ") and M08SubName in (" & _ShadeCategory & ") and T03Group='" & cboMgroup.Text & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboQuality.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and  M04Quality='" & Trim(cboQuality.Text) & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboShade.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and  M04Shade_Code='" & Trim(cboShade.Text) & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboDye.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M04Program ='" & cboDye.Text & "' and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M04Program = '" & cboDye.Text & "' and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and M04Program='" & cboDye.Text & "'"

                End If
                ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And cboQuality.Text <> "" And cboMgroup.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Quality='" & Trim(cboQuality.Text) & "'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And chkWJ.Checked = True And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And Trim(cboShade.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "
                    End If
                End If
            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "

                End If
                ElseIf _Programm_Type <> "" And chkWJ.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01'"

                    End If
                    '==================================================================
                    '===========================================================================
                    '===============================================================================
                    '===========================================================================
                    '===================================================================
                    'AIR FLOW
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------
                    'WITH OUT SHADE AND WITH MACHINE
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in ('" & _MC & "')"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in ('" & _MC & "')"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in ('" & _MC & "')"

                    End If

                    '-----------------------------------------------------------------------------------------------------------------
                    'WITH OUT SHADE AND WITHOUT MACHINE

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'  "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' )"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If


                ElseIf _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                    End If
                    '------------------------------------------------------------------------------------------------------------------------------------------------------------

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If


            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _ShadeCategory <> "" And Trim(cboMgroup.Text) <> "" And cboShade.Text <> "" And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03Code in (" & _MC & ") and M04Shade_Code='" & cboShade.Text & "' and M08SubName in (" & _ShadeCategory & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03Code in (" & _MC & ") and M04Shade_Code='" & cboShade.Text & "' and M08SubName in (" & _ShadeCategory & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and T03Code in (" & _MC & ") and M04Shade_Code='" & cboShade.Text & "' and M08SubName in (" & _ShadeCategory & ")"

                End If

                ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' "

                    End If
                ElseIf _Programm_Type <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and M04Shade_Code='" & Trim(cboShade.Text) & "'"

                    End If

                ElseIf _Programm_Type <> "" And chkAF.Checked = True And cboMgroup.Text <> "" And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and M04Machine_No in (" & _MC & ") order by M04Machine_No"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and M04Machine_No in (" & _MC & ") order by M04Machine_No"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and M04Machine_No in (" & _MC & ") order by M04Machine_No"

                    End If
            ElseIf _Programm_Type <> "" And chkAF.Checked = True And _ShadeCategory <> "" And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkAF.Checked = True And _ShadeCategory <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' "
                    End If
                End If
            ElseIf _Programm_Type <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02'"

                End If
                '================================================================
                '================================================================
                '================================================================
                'All Machine
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02',01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type  in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type  in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                    '----------------------------------------------------------------------------------------------------------------------------------
                    'WITH OUT SHADE AND WITH MACHINE
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in ('" & _MC & "')"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in ('" & _MC & "')"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in ('" & _MC & "')"

                    End If

                    '-----------------------------------------------------------------------------------------------------------------
                    'WITH OUT SHADE AND WITHOUT MACHINE

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type  in ('02','01') and left(Ltrim(m09Dis),1)='B'  "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' )"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If

                ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                ElseIf _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                    End If
                    '------------------------------------------------------------------------------------------------------------------------------------------------------------

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01')"

                    End If

                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01')"

                    End If
                ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)='B'"
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01')"

                    End If
                ElseIf _Programm_Type <> "" And chkAll.Checked = True And cboMgroup.Text <> "" And _MC <> "" Then
                    If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "' "
                    ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "'"

                End If

            ElseIf _Programm_Type <> "" And chkAll.Checked = True And _ShadeCategory <> "" And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkAll.Checked = True And _ShadeCategory <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') "
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkAll.Checked = True And cboMgroup.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and  T03Group='" & Trim(cboMgroup.Text) & "'"

                End If
            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And cboShade.Text <> "" And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type  in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type  in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B' and T03code in ( " & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B' and T03code in ( " & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and T03code in ( " & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02')"

                End If

                '-------------------------------------------------------------------------------------------------------------
                'MACHINE GROUP AND 
                End If

                M01 = DBEngin.ExecuteDataset(con, Nothing, Sql)
                I = 0
                For Each DTRow5 As DataRow In M01.Tables(0).Rows
                    Dim newRow As DataRow = c_dataCustomer1.NewRow

                    'For Each DTRow1 As DataRow In M01.Tables(0).Rows
                    newRow("Dyed Date") = M01.Tables(0).Rows(I)("M04ETime")
                    newRow("Machine") = M01.Tables(0).Rows(I)("T03Name")
                    newRow("Batch no") = M01.Tables(0).Rows(I)("M04Lotno")
                    newRow("Quality") = M01.Tables(0).Rows(I)("M04Quality")
                    newRow("Type") = M01.Tables(0).Rows(I)("M04ProgrameType")
                    newRow("Programme Name") = M01.Tables(0).Rows(I)("m04type")
                    newRow("Shade code") = M01.Tables(0).Rows(I)("M04Shade_Code")
                    newRow("Shade") = M01.Tables(0).Rows(I)("M04Shade")
                    newRow("Qty (Kg)") = Microsoft.VisualBasic.Format(M01.Tables(0).Rows(I)("M04Batchwt"), "#.00")
                    newRow("Shade Type") = M01.Tables(0).Rows(I)("M04Shade_Type")

                    c_dataCustomer1.Rows.Add(newRow)
                    I = I + 1
                Next

        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try
    End Sub

    Private Sub cmdExit_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdExit.Click
        Me.Close()

    End Sub

    Private Sub cmdReset_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles cmdReset.Click
        common.ClearAll(OPR0, OPR1, OPR2)
        Clicked = ""
        Call Load_Gride()
        cmdAdd.Enabled = True
        chk10.Checked = False
        chk12.Checked = False
        chk13.Checked = False
        chk14.Checked = False
        chk15.Checked = False
        chk16.Checked = False
        chk17.Checked = False
        chk18.Checked = False
        chk19.Checked = False
        chk2.Checked = False
        chk20.Checked = False
        chk21.Checked = False
        chk22.Checked = False
        chk23.Checked = False
        chk31.Checked = False
        chk32.Checked = False
        chk33.Checked = False
        chk34.Checked = False
        chk35.Checked = False
        chk36.Checked = False
        chk37.Checked = False
        chk38.Checked = False
        chk39.Checked = False
        chk4.Checked = False
        chk6.Checked = False
        chk8.Checked = False
        chkAF.Checked = False
        chkWJ.Checked = False
        chkWhite.Checked = False
        chkWash.Checked = False
        chkAll.Checked = False
        chkAF.Checked = False
        chkBiopolish.Checked = False
        chkDark.Checked = False
        chkEDark.Checked = False
        chkLight.Checked = False
        chkMal.Checked = False
        chkMedium.Checked = False
        chkNomal.Checked = False
        chkNonBio.Checked = False
        chkOther.Checked = False
        chkPoly.Checked = False
        chkRedye.Checked = False
        chkStrip.Checked = False
        chkViscose.Checked = False
        chkYarn.Checked = False

        cmdAdd.Focus()
    End Sub

    Function Download_Excell()

        Dim _ShadeCategory As String
        Dim _Light As String
        Dim _Dark As String
        Dim _Exdark As String
        Dim _White As String
        Dim _Mal As String
        Dim _Yarn As String
        Dim _Medium As String
        Dim _Programm_Type As String
        Dim _Quality As String
        Dim _MC As String

        Dim Sql As String
        Dim con = New SqlConnection()
        con = DBEngin.GetConnection()
        Dim M01 As DataSet

        Dim I As Integer
        Load_Gride()

        Try
            'SHADE CATEGORY

            If chkLight.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Light'"
                Else
                    _ShadeCategory = "'Light'"

                End If
            End If

            If chkDark.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Dark'"
                Else
                    _ShadeCategory = "'Dark'"

                End If
            End If

            If chkEDark.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Extra Dark'"
                Else
                    _ShadeCategory = "'Extra Dark'"

                End If
            End If

            If chkMedium.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'Medium'"
                Else
                    _ShadeCategory = "'Medium'"

                End If
            End If

            If chkWhite.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'White'"
                Else
                    _ShadeCategory = "'White'"

                End If
            End If

            If chkMal.Checked = True Or chkYarn.Checked = True Then
                If _ShadeCategory <> "" Then
                    _ShadeCategory = _ShadeCategory & ",'MARL & Yarn dye'"
                Else
                    _ShadeCategory = "'MARL & Yarn dye'"

                End If
            End If

            '--------------------------------------------------------------------------------------------
            'PROGRAMME TYPE
            If chkNomal.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'N'"
                Else
                    _Programm_Type = "'N'"

                End If
            End If

            If chkRedye.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'R'"
                Else
                    _Programm_Type = "'R'"

                End If
            End If

            If chkStrip.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'S'"
                Else
                    _Programm_Type = "'S'"

                End If
            End If

            If chkWash.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'W'"
                Else
                    _Programm_Type = "'W'"

                End If
            End If

            If chkOther.Checked = True Then
                If _Programm_Type <> "" Then
                    _Programm_Type = _Programm_Type & ",'O'"
                Else
                    _Programm_Type = "'O'"

                End If
            End If

            '-----------------------------------------------------------------------------------
            'QUALITY
            If chkViscose.Checked = True Then
                If _Quality <> "" Then
                    _Quality = _Quality & ",'VISCOSE'"
                Else
                    _Quality = "'VISCOSE'"

                End If
            End If

            If chkBiopolish.Checked = True Or chkNonBio.Checked = True Then
                If _Quality <> "" Then
                    _Quality = _Quality & ",'COTTON'"
                Else
                    _Quality = "'COTTON'"

                End If
            End If

            If chkPoly.Checked = True Or chkPoly.Checked = True Then
                If _Quality <> "" Then
                    _Quality = _Quality & ",'POLY'"
                Else
                    _Quality = "'POLY'"

                End If
            End If
            '----------------------------------------------------------------------------------------
            'MACHINE
            If chkWJ.Checked = True Then
                If chk2.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'2'"
                    Else
                        _MC = "'2'"

                    End If
                End If

                If chk4.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'4'"
                    Else
                        _MC = "'4'"

                    End If
                End If

                If chk6.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'6'"
                    Else
                        _MC = "'6'"

                    End If
                End If

                If chk7.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'7'"
                    Else
                        _MC = "'7'"

                    End If
                End If

                If chk8.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'8'"
                    Else
                        _MC = "'8'"

                    End If
                End If

                If chk9.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'9'"
                    Else
                        _MC = "'9'"

                    End If
                End If

                If chk10.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'10'"
                    Else
                        _MC = "'10'"

                    End If
                End If

                If chk12.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'12'"
                    Else
                        _MC = "'12'"

                    End If
                End If

                If chk13.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'13'"
                    Else
                        _MC = "'13'"

                    End If
                End If

                If chk14.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'14'"
                    Else
                        _MC = "'14'"

                    End If
                End If

                If chk15.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'15'"
                    Else
                        _MC = "'15'"

                    End If
                End If

                If chk16.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'16'"
                    Else
                        _MC = "'16'"

                    End If
                End If

                If chk17.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'17'"
                    Else
                        _MC = "'17'"

                    End If
                End If

                If chk18.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'18'"
                    Else
                        _MC = "'18'"

                    End If
                End If

                If chk19.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'19'"
                    Else
                        _MC = "'19'"

                    End If
                End If

                If chk20.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'20'"
                    Else
                        _MC = "'20'"

                    End If
                End If

                If chk21.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'21'"
                    Else
                        _MC = "'21'"

                    End If
                End If

                If chk22.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'22'"
                    Else
                        _MC = "'22'"

                    End If
                End If

                If chk23.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'23'"
                    Else
                        _MC = "'23'"

                    End If
                End If

                If chk31.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'31'"
                    Else
                        _MC = "'31'"

                    End If
                End If

                If chk32.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'32'"
                    Else
                        _MC = "'32'"

                    End If
                End If

                If chk33.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'33'"
                    Else
                        _MC = "'33'"

                    End If
                End If

                If chk34.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'34'"
                    Else
                        _MC = "'34'"

                    End If
                End If

                If chk35.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'35'"
                    Else
                        _MC = "'35'"

                    End If
                End If

                If chk36.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'36'"
                    Else
                        _MC = "'36'"

                    End If
                End If

                If chk37.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'37'"
                    Else
                        _MC = "'37'"

                    End If
                End If

                If chk38.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'38'"
                    Else
                        _MC = "'38'"

                    End If
                End If

                If chk39.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'39'"
                    Else
                        _MC = "'39'"

                    End If
                End If
            ElseIf chkAF.Checked = True Then
                If chk31.Checked = True Then
                    _MC = "'31'"
                End If

                If chk32.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'32'"
                    Else
                        _MC = "'32'"

                    End If
                End If

                If chk33.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'33'"
                    Else
                        _MC = "'33'"

                    End If
                End If
                If chk34.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'34'"
                    Else
                        _MC = "'34'"

                    End If


                End If

                If chk35.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'35'"
                    Else
                        _MC = "'35'"

                    End If
                End If

                If chk36.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'36'"
                    Else
                        _MC = "'36'"

                    End If
                End If

                If chk38.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'38'"
                    Else
                        _MC = "'38'"

                    End If
                End If

                If chk37.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'37'"
                    Else
                        _MC = "'37'"

                    End If
                End If

                If chk39.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'39'"
                    Else
                        _MC = "'39'"

                    End If
                End If
            ElseIf chkAll.Checked = True Then
                If CHK1.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'1'"
                    Else
                        _MC = "'1'"

                    End If
                End If

                If chk2.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'2'"
                    Else
                        _MC = "'2'"

                    End If
                End If

                If chk3.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'3'"
                    Else
                        _MC = "'3'"

                    End If
                End If

                If chk4.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'4'"
                    Else
                        _MC = "'4'"

                    End If
                End If

                If chk5.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'5'"
                    Else
                        _MC = "'5'"

                    End If
                End If

                If chk6.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'6'"
                    Else
                        _MC = "'6'"

                    End If

                End If

                If chk7.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'7'"
                    Else
                        _MC = "'7'"

                    End If
                End If

                If chk8.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'8'"
                    Else
                        _MC = "'8'"

                    End If
                End If

                If chk9.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'9'"
                    Else
                        _MC = "'9'"

                    End If
                End If

                If chk10.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'10'"
                    Else
                        _MC = "'10'"

                    End If
                End If

                If chk12.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'12'"
                    Else
                        _MC = "'12'"

                    End If
                End If

                If chk13.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'13'"
                    Else
                        _MC = "'13'"

                    End If
                End If

                If chk14.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'14'"
                    Else
                        _MC = "'14'"

                    End If
                End If

                If chk15.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'15'"
                    Else
                        _MC = "'15'"

                    End If
                End If

                If chk16.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'16'"
                    Else
                        _MC = "'16'"

                    End If
                End If

                If chk17.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'17'"
                    Else
                        _MC = "'17'"

                    End If
                End If

                If chk18.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'18'"
                    Else
                        _MC = "'18'"

                    End If
                End If

                If chk19.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'19'"
                    Else
                        _MC = "'19'"

                    End If
                End If

                If chk20.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'20'"
                    Else
                        _MC = "'20'"

                    End If
                End If

                If chk21.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'21'"
                    Else
                        _MC = "'21'"

                    End If
                End If

                If chk22.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'22'"
                    Else
                        _MC = "'22'"

                    End If
                End If

                If chk23.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'23'"
                    Else
                        _MC = "'23'"

                    End If
                End If

                If chk31.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'31'"
                    Else
                        _MC = "'31'"

                    End If
                End If

                If chk32.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'32'"
                    Else
                        _MC = "'32'"

                    End If
                End If

                If chk33.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'33'"
                    Else
                        _MC = "'33'"

                    End If
                End If

                If chk34.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'34'"
                    Else
                        _MC = "'34'"

                    End If
                End If

                If chk35.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'35'"
                    Else
                        _MC = "'35'"

                    End If
                End If

                If chk36.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'36'"
                    Else
                        _MC = "'36'"

                    End If
                End If

                If chk37.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'37'"
                    Else
                        _MC = "'37'"

                    End If
                End If

                If chk38.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'38'"
                    Else
                        _MC = "'38'"

                    End If
                End If

                If chk39.Checked = True Then
                    If _MC <> "" Then
                        _MC = _MC & ",'39'"
                    Else
                        _MC = "'39'"

                    End If
                End If


            End If
            '----------------------------------------------------------------------------------------
            Dim _FromTime As Date
            Dim _ToTime As Date

            _FromTime = txtFromDate.Text & " " & "7:30AM"
            _ToTime = txtTodate.Text & " " & "7:30AM"

            If _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
                '----------------------------------------------------------------------------------------------------------------------------------
                'WITH OUT SHADE AND WITH MACHINE
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03code in ('" & _MC & "')"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03code in ('" & _MC & "')"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and T03code in ('" & _MC & "')"

                End If

                '-----------------------------------------------------------------------------------------------------------------
                'WITH OUT SHADE AND WITHOUT MACHINE

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'  "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' )"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' "

                End If
                '------------------------------------------------------------------------------------------------------------------------------------------------------------

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And cboDye.Text <> "" And _ShadeCategory <> "" And cboMgroup.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M08SubName in (" & _ShadeCategory & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Program='" & cboDye.Text & "' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ") and T03Group='" & cboMgroup.Text & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M08SubName in (" & _ShadeCategory & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Program='" & cboDye.Text & "' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ") and T03Group='" & cboMgroup.Text & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and  M04Quality='" & Trim(cboQuality.Text) & "' and M04Program='" & cboDye.Text & "' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ") and M08SubName in (" & _ShadeCategory & ") and T03Group='" & cboMgroup.Text & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboQuality.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and  M04Quality='" & Trim(cboQuality.Text) & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboShade.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and  M04Shade_Code='" & Trim(cboShade.Text) & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" And cboDye.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M04Program ='" & cboDye.Text & "' and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M04Program = '" & cboDye.Text & "' and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ") and M04Program='" & cboDye.Text & "'"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and M04Machine_No in (" & _MC & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Machine_No in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And cboQuality.Text <> "" And cboMgroup.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and M04Quality='" & Trim(cboQuality.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and M04Quality='" & Trim(cboQuality.Text) & "'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And chkWJ.Checked = True And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True And Trim(cboShade.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "
                    End If
                End If
            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01' "

                End If
            ElseIf _Programm_Type <> "" And chkWJ.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='01' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='01'"

                End If
                '==================================================================
                '===========================================================================
                '===============================================================================
                '===========================================================================
                '===================================================================
                'AIR FLOW
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
                '----------------------------------------------------------------------------------------------------------------------------------
                'WITH OUT SHADE AND WITH MACHINE
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03code in ('" & _MC & "')"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03code in ('" & _MC & "')"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and T03code in ('" & _MC & "')"

                End If

                '-----------------------------------------------------------------------------------------------------------------
                'WITH OUT SHADE AND WITHOUT MACHINE

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'  "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' )"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If


            ElseIf _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' "

                End If
                '------------------------------------------------------------------------------------------------------------------------------------------------------------

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02'"

                End If


            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True And _ShadeCategory <> "" And Trim(cboMgroup.Text) <> "" And cboShade.Text <> "" And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03Code in (" & _MC & ") and M04Shade_Code='" & cboShade.Text & "' and M08SubName in (" & _ShadeCategory & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03Code in (" & _MC & ") and M04Shade_Code='" & cboShade.Text & "' and M08SubName in (" & _ShadeCategory & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and T03Code in (" & _MC & ") and M04Shade_Code='" & cboShade.Text & "' and M08SubName in (" & _ShadeCategory & ")"

                End If

            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' "

                End If
            ElseIf _Programm_Type <> "" And Trim(cboShade.Text) <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and M04Shade_Code='" & Trim(cboShade.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and M04Shade_Code='" & Trim(cboShade.Text) & "'"

                End If

            ElseIf _Programm_Type <> "" And chkAF.Checked = True And cboMgroup.Text <> "" And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B' and M04Machine_No in (" & _MC & ") order by M04Machine_No"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and M04Machine_No in (" & _MC & ") order by M04Machine_No"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and M04Machine_No in (" & _MC & ") order by M04Machine_No"

                End If
            ElseIf _Programm_Type <> "" And chkAF.Checked = True And _ShadeCategory <> "" And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkAF.Checked = True And _ShadeCategory <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)='B' "
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(Ltrim(m09Dis),1)<>'B' "
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02' "
                    End If
                End If
            ElseIf _Programm_Type <> "" And chkAF.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type='02' and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type='02'"

                End If
                '================================================================
                '================================================================
                '================================================================
                'All Machine
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02',01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type  in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type  in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
                '----------------------------------------------------------------------------------------------------------------------------------
                'WITH OUT SHADE AND WITH MACHINE
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'  and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in (" & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03code in ('" & _MC & "')"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03code in ('" & _MC & "')"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and T03code in ('" & _MC & "')"

                End If

                '-----------------------------------------------------------------------------------------------------------------
                'WITH OUT SHADE AND WITHOUT MACHINE

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type  in ('02','01') and left(Ltrim(m09Dis),1)='B'  "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' )"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and   M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If

            ElseIf _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'    and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') "

                End If
                '------------------------------------------------------------------------------------------------------------------------------------------------------------

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True And _MC <> "" Then

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboQuality.Text <> "" And cboShade.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M04Program='" & Trim(cboDye.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And cboQuality.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And cboDye.Text <> "" And cboMgroup.Text <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Program='" & Trim(cboDye.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboMgroup.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and T03Group='" & Trim(cboMgroup.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and T03Group='" & Trim(cboMgroup.Text) & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Quality ='" & Trim(cboQuality.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboDye.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Program='" & Trim(cboDye.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "' and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01')"

                End If

            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And Trim(cboShade.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Shade_Code='" & Trim(cboShade.Text) & "' and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04Shade_Code ='" & Trim(cboShade.Text) & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01')"

                End If
            ElseIf _ShadeCategory <> "" And _Programm_Type <> "" And _Quality <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type IN ('02','01')"

                End If
            ElseIf _Programm_Type <> "" And chkAll.Checked = True And cboMgroup.Text <> "" And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "'"

                End If

            ElseIf _Programm_Type <> "" And chkAll.Checked = True And _ShadeCategory <> "" And Trim(cboMgroup.Text) <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)='Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)<>'Y' and T03Group='" & Trim(cboMgroup.Text) & "'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and T03Group='" & Trim(cboMgroup.Text) & "'"
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkAll.Checked = True And _ShadeCategory <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                    End If
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and  M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                    End If
                Else
                    If chkYarn.Checked = True And chkMal.Checked = False And chkLight.Checked = False And chkWhite.Checked = False And chkMedium.Checked = False And chkDark.Checked = False And chkEDark.Checked = False Then
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)='Y'"
                    ElseIf chkMal.Checked = True And chkYarn.Checked = False Then

                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and left(M04Quality,1)<>'Y'"
                    Else
                        Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and   M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') "
                    End If
                End If

            ElseIf _Programm_Type <> "" And chkAll.Checked = True And cboMgroup.Text <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B' and M04Machine_No in (" & _MC & ") and T03Group='" & Trim(cboMgroup.Text) & "'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and  T03Group='" & Trim(cboMgroup.Text) & "'"

                End If
            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True And cboShade.Text <> "" And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type  in ('02','01') and left(Ltrim(m09Dis),1)<>'B' and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') and M04Shade_Code='" & cboShade.Text & "' and T03Code in (" & _MC & ")"

                End If

            ElseIf _Programm_Type <> "" And Trim(cboQuality.Text) <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "' and M04Quality='" & Trim(cboQuality.Text) & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type in ('02','01') and left(Ltrim(m09Dis),1)='B' "
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type  in ('02','01') and left(Ltrim(m09Dis),1)<>'B' "
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04Quality='" & Trim(cboQuality.Text) & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('02','01') "

                End If
            ElseIf _Programm_Type <> "" And chkAll.Checked = True And _MC <> "" Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B' and T03code in ( " & _MC & ")"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B' and T03code in ( " & _MC & ")"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02') and T03code in ( " & _MC & ")"

                End If
            ElseIf _Programm_Type <> "" And chkAll.Checked = True Then
                If chkBiopolish.Checked = True And chkNonBio.Checked = False Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'  and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)='B'"
                ElseIf chkBiopolish.Checked = False And chkNonBio.Checked = True Then
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M08SubName in(" & _ShadeCategory & ") and M04ProgrameType in (" & _Programm_Type & ") and M09Type in (" & _Quality & ") and T03Type in ('01','02') and left(Ltrim(m09Dis),1)<>'B'"
                Else
                    Sql = "select M04ProgrameType,M04type,M04ETime,T03Name,M04Lotno,M04Batchwt,M04Quality,M09Type,M04Shade_Code,M04Shade,M04Shade_Type  from M04Lot inner join T03Machine on M04Machine_No=T03Code inner join M09Quality on M04Quality=M09Code inner join M08Sub_Shade on M04Shade_Type=M08Code where M04ETime between '" & _FromTime & "' and '" & _ToTime & "'   and M04ProgrameType in (" & _Programm_Type & ") and  T03Type in ('01','02')"

                End If

                '-------------------------------------------------------------------------------------------------------------
                'MACHINE GROUP AND 
            End If

            M01 = DBEngin.ExecuteDataset(con, Nothing, Sql)
            I = 0

            Dim FileName As String
            exc.Visible = True
            Dim _GrandTotal As Integer
            Dim _STGrand As String
            Dim range1 As Range
            Dim _NETTOTAL As Integer
            Dim T04 As DataSet
            Dim n_per As Double
            Dim Y As Integer

            '  Dim worksheet11 As _worksheet1 = CType(sheets.Item(2), _worksheet1)
            workbooks.Application.Sheets.Add()
            Dim sheets1 As Sheets = workbook.Worksheets
            Dim worksheet1 As _Worksheet = CType(sheets1.Item(1), _Worksheet)
            worksheet1.Name = "Dying Technical"


            worksheet1.Cells(2, 1) = "Dyeing Techincal & Capacity Guideline"
            worksheet1.Rows(2).Font.Bold = True
            worksheet1.Rows(2).Font.size = 12
            worksheet1.Rows(2).Font.Name = "Times New Roman"

            worksheet1.Rows(2).rowheight = 20.25


            worksheet1.Rows(2).Font.Bold = True
            worksheet1.Rows(2).Font.size = 11
            worksheet1.Cells(2, 1).HorizontalAlignment = XlHAlign.xlHAlignLeft
            'range1 = worksheet1.Cells("B2:G2")

            worksheet1.Columns("A").ColumnWidth = 12
            worksheet1.Columns("B").ColumnWidth = 10
            worksheet1.Columns("C").ColumnWidth = 10
            worksheet1.Columns("D").ColumnWidth = 10
            worksheet1.Columns("E").ColumnWidth = 10
            worksheet1.Columns("F").ColumnWidth = 15
            worksheet1.Columns("G").ColumnWidth = 15
            worksheet1.Columns("H").ColumnWidth = 10
            worksheet1.Columns("I").ColumnWidth = 10
            worksheet1.Columns("J").ColumnWidth = 35

            worksheet1.Rows(3).Font.size = 10
            worksheet1.Cells(4, 1) = "Dyed Date"
            worksheet1.Cells(4, 2) = "Machine"
            worksheet1.Cells(4, 3) = "Batch No"
            worksheet1.Cells(4, 4) = "Quality"
            worksheet1.Cells(4, 5) = "Type"
            worksheet1.Cells(4, 6) = "Shade code"
            worksheet1.Cells(4, 7) = "Shade"
            worksheet1.Cells(4, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet1.Cells(4, 8) = "Quantity"
            worksheet1.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet1.Cells(4, 9) = "Shade Type"
            worksheet1.Cells(4, 8).HorizontalAlignment = XlHAlign.xlHAlignCenter
            worksheet1.Cells(4, 10) = "Programe Name"

            worksheet1.Range("A4", "a4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("b4", "B4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("c4", "c4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("d4", "d4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("e4", "e4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("f4", "f4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("g4", "g4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("h4", "h4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("i4", "i4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("j4", "j4").Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlContinuous


            worksheet1.Range("j4", "j4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("j4", "j4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet1.Range("i4", "i4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("i4", "i4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet1.Range("h4", "h4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("h4", "h4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet1.Range("g4", "g4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("g4", "g4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet1.Range("f4", "f4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("f4", "f4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet1.Range("e4", "e4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("e4", "e4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("d4", "d4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("d4", "d4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("c4", "c4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("c4", "c4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet1.Range("b4", "b4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("b4", "b4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous


            worksheet1.Range("a4", "a4").Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlContinuous
            worksheet1.Range("a4", "a4").Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlContinuous

            worksheet1.Range("A4:A4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("b4:b4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("c4:c4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("d4:d4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("e4:e4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("f4:f4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("g4:g4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("h4:h4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("i4:i4").Interior.Color = RGB(215, 228, 188)
            worksheet1.Range("j4:j4").Interior.Color = RGB(215, 228, 188)

            Dim x As Integer
            x = 5
            I = 0
            For Each DTRow3 As DataRow In M01.Tables(0).Rows
                worksheet1.Rows(x).Font.size = 10
                worksheet1.Cells(x, 1) = M01.Tables(0).Rows(I)("M04ETime")
                worksheet1.Cells(x, 1).EntireColumn.NumberFormat = "dd-MMM"
                worksheet1.Cells(x, 1).HorizontalAlignment = XlHAlign.xlHAlignLeft
                worksheet1.Cells(x, 2) = M01.Tables(0).Rows(I)("T03Name")
                worksheet1.Cells(x, 3) = M01.Tables(0).Rows(I)("M04Lotno")
                worksheet1.Cells(x, 3).HorizontalAlignment = XlHAlign.xlHAlignCenter
                worksheet1.Cells(x, 4) = M01.Tables(0).Rows(I)("M04Quality")
                worksheet1.Cells(x, 4).HorizontalAlignment = XlHAlign.xlHAlignCenter
                worksheet1.Cells(x, 5) = M01.Tables(0).Rows(I)("M04ProgrameType")
                worksheet1.Cells(x, 5).HorizontalAlignment = XlHAlign.xlHAlignCenter
                worksheet1.Cells(x, 6) = M01.Tables(0).Rows(I)("M04Shade_Code")
                worksheet1.Cells(x, 6).HorizontalAlignment = XlHAlign.xlHAlignLeft
                worksheet1.Cells(x, 7) = M01.Tables(0).Rows(I)("M04Shade")
                worksheet1.Cells(x, 7).HorizontalAlignment = XlHAlign.xlHAlignCenter
                worksheet1.Cells(x, 8) = Microsoft.VisualBasic.Format(M01.Tables(0).Rows(I)("M04Batchwt"), "#.00")
                range1 = worksheet1.Cells(x, 8)
                range1.NumberFormat = "0"
                worksheet1.Cells(x, 9) = M01.Tables(0).Rows(I)("M04Shade_Type")
                worksheet1.Cells(x, 9).HorizontalAlignment = XlHAlign.xlHAlignCenter
                worksheet1.Cells(x, 10) = M01.Tables(0).Rows(I)("m04type")
                '  worksheet1.Cells(x, 10).HorizontalAlignment = XlHAlign.xlHAlignCenter


                worksheet1.Range("A" & x & ",a" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("b" & x & ",b" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("c" & x & ",c" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("d" & x & ",d" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("e" & x & ",e" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("f" & x & ",f" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("g" & x & ",g" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("h" & x & ",h" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("i" & x & ",i" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("j" & x & ",j" & x).Borders(XlBordersIndex.xlEdgeTop).LineStyle = XlLineStyle.xlDash

                worksheet1.Range("j" & x & ",j" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("j" & x & ",j" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash

                worksheet1.Range("i" & x & ",i" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("i" & x & ",i" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash


                worksheet1.Range("h" & x & ",h" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("h" & x & ",h" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash

                worksheet1.Range("g" & x & ",g" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("g" & x & ",g" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash

                worksheet1.Range("f" & x & ",f" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("f" & x & ",f" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash

                worksheet1.Range("e" & x & ",e" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("e" & x & ",e" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("d" & x & ",d" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("d" & x & ",d" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("c" & x & ",c" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("c" & x & ",c" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("b" & x & ",b" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("b" & x & ",b" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("a" & x & ",a" & x).Borders(XlBordersIndex.xlEdgeRight).LineStyle = XlLineStyle.xlDash
                worksheet1.Range("a" & x & ",a" & x).Borders(XlBordersIndex.xlEdgeBottom).LineStyle = XlLineStyle.xlDash

                x = x + 1
                I = I + 1
            Next
        Catch returnMessage As Exception
            If returnMessage.Message <> Nothing Then
                MessageBox.Show(returnMessage.Message)
            End If
        End Try


    End Function

    Private Sub PictureBox1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PictureBox1.Click
        ' Call Download_Excell()

    End Sub

    Private Sub LinkLabel1_LinkClicked(ByVal sender As System.Object, ByVal e As System.Windows.Forms.LinkLabelLinkClickedEventArgs) Handles LinkLabel1.LinkClicked
        Call Download_Excell()
    End Sub
End Class